2025-06-10 13:37:34.638 | INFO     | __main__:_prepare_app_env:42 - ⚙️  应用环境已确立: DEELOPMENT
2025-08-21 13:45:20.439 | INFO     | __main__:init_app_state:38 - ⚙️  应用环境已确立: PRODUCTION
2025-08-21 13:45:20.439 | INFO     | __main__:start_server:145 - 
🚀 准备启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 13:45:20.440 | INFO     | __main__:start_server:146 -   - 最终监听地址: http://0.0.0.0:8000
2025-08-21 13:45:20.440 | INFO     | __main__:start_server:149 -   - 本机可访问: http://127.0.0.1:8000
2025-08-21 13:45:20.440 | INFO     | __main__:start_server:150 -   - 局域网可访问: http://172.16.4.155:8000
2025-08-21 13:45:20.440 | INFO     | __main__:start_server:151 -   - 热重载模式: ❌ 关闭
2025-08-21 13:45:22.514 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 13:45:22.708 | CRITICAL | __main__:start_server:163 - ⚠️ Uvicorn 服务器启动失败: cannot import name 'SQLLITE_FILE' from 'app.cfg.config' (D:\ABT\0-Project\face_rec\app\cfg\config.py)
2025-08-21 13:55:09.106 | INFO     | __main__:init_app_state:38 - ⚙️  应用环境已确立: PRODUCTION
2025-08-21 13:55:09.107 | INFO     | __main__:start_server:145 - 
🚀 准备启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 13:55:09.108 | INFO     | __main__:start_server:146 -   - 最终监听地址: http://0.0.0.0:8000
2025-08-21 13:55:09.109 | INFO     | __main__:start_server:149 -   - 本机可访问: http://127.0.0.1:8000
2025-08-21 13:55:09.109 | INFO     | __main__:start_server:150 -   - 局域网可访问: http://172.16.4.155:8000
2025-08-21 13:55:09.109 | INFO     | __main__:start_server:151 -   - 热重载模式: ❌ 关闭
2025-08-21 13:55:11.231 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 13:55:12.309 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 13:55:12.310 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 13:55:12.312 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 13:55:12.313 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 13:55:12.313 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:55:12.315 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:55:12.316 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:55:17.137 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:55:17.536 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:55:17.537 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:55:17.538 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 13:55:17.539 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 13:55:20.923 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 13:55:20.924 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 13:55:20.924 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 13:55:20.925 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 13:55:20.925 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 13:55:20.926 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 13:55:20.930 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 13:55:20.934 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 13:55:20.935 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 13:55:20.935 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 13:55:20.935 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 13:55:20.935 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 13:57:25.430 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 13:57:25.430 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 13:57:25.431 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 13:57:25.431 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 13:57:25.431 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 13:57:25.432 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 13:57:25.550 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 13:57:25.550 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-21 13:58:25.245 | INFO     | __main__:init_app_state:38 - ⚙️  应用环境已确立: PRODUCTION
2025-08-21 13:58:25.245 | INFO     | __main__:start_server:145 - 
🚀 准备启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 13:58:25.245 | INFO     | __main__:start_server:146 -   - 最终监听地址: http://0.0.0.0:8000
2025-08-21 13:58:25.247 | INFO     | __main__:start_server:149 -   - 本机可访问: http://127.0.0.1:8000
2025-08-21 13:58:25.247 | INFO     | __main__:start_server:150 -   - 局域网可访问: http://172.16.4.155:8000
2025-08-21 13:58:25.247 | INFO     | __main__:start_server:151 -   - 热重载模式: ❌ 关闭
2025-08-21 13:58:27.371 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 13:58:28.069 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 13:58:28.069 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 13:58:28.071 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 13:58:28.071 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 13:58:28.072 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:58:28.073 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:58:28.073 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 13:58:31.373 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:58:31.793 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:58:31.904 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 13:58:31.904 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 13:58:31.905 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 13:58:33.614 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 13:58:33.614 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 13:58:33.614 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 13:58:33.615 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 13:58:33.615 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 13:58:33.616 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 13:58:33.619 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 13:58:33.622 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 13:58:33.622 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 13:58:33.622 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 13:58:33.622 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 13:58:33.622 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 13:59:24.802 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 13:59:24.803 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 13:59:24.803 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 13:59:24.803 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 13:59:24.804 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 13:59:24.804 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 13:59:24.908 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 13:59:24.908 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-21 14:05:15.387 | INFO     | __main__:init_app_state:38 - ⚙️  应用环境已确立: PRODUCTION
2025-08-21 14:05:15.387 | INFO     | __main__:start_server:145 - 
🚀 准备启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 14:05:15.388 | INFO     | __main__:start_server:146 -   - 最终监听地址: http://0.0.0.0:12011
2025-08-21 14:05:15.388 | INFO     | __main__:start_server:149 -   - 本机可访问: http://127.0.0.1:12011
2025-08-21 14:05:15.388 | INFO     | __main__:start_server:150 -   - 局域网可访问: http://172.16.4.155:12011
2025-08-21 14:05:15.389 | INFO     | __main__:start_server:151 -   - 热重载模式: ❌ 关闭
2025-08-21 14:05:17.373 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-21 14:05:18.028 | CRITICAL | __main__:start_server:163 - ⚠️ Uvicorn 服务器启动失败: cannot import name 'IMAGE_URL_IP' from 'app.cfg.config' (D:\ABT\0-Project\face_rec\app\cfg\config.py)
2025-08-21 14:06:34.005 | INFO     | __main__:init_app_state:38 - ⚙️  应用环境已确立: PRODUCTION
2025-08-21 14:06:34.006 | INFO     | __main__:start_server:145 - 
🚀 准备启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 14:06:34.006 | INFO     | __main__:start_server:146 -   - 最终监听地址: http://0.0.0.0:8000
2025-08-21 14:06:34.006 | INFO     | __main__:start_server:149 -   - 本机可访问: http://127.0.0.1:8000
2025-08-21 14:06:34.007 | INFO     | __main__:start_server:150 -   - 局域网可访问: http://172.16.4.155:8000
2025-08-21 14:06:34.007 | INFO     | __main__:start_server:151 -   - 热重载模式: ❌ 关闭
2025-08-21 14:06:35.869 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 14:06:36.509 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 14:06:36.509 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 14:06:36.511 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 14:06:36.512 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 14:06:36.512 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:06:36.513 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:06:36.513 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:06:39.781 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:06:40.230 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:06:40.355 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:06:40.356 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 14:06:40.357 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 14:06:42.153 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 14:06:42.154 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 14:06:42.154 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 14:06:42.155 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 14:06:42.155 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 14:06:42.155 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 14:06:42.158 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 14:06:42.161 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 14:06:42.162 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 14:06:42.162 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 14:06:42.162 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 14:06:42.162 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 14:06:43.478 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 14:06:43.478 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 14:06:43.479 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 14:06:43.479 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 14:06:43.479 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 14:06:43.480 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 14:06:43.577 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 14:06:43.577 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-21 14:15:23.530 | INFO     | __main__:init_app_state:32 - 应用环境: DEVELOPMENT
2025-08-21 14:15:23.531 | INFO     | __main__:start_server:91 - 启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 14:15:23.531 | INFO     | __main__:start_server:92 - 监听地址: http://0.0.0.0:8000
2025-08-21 14:15:23.533 | INFO     | __main__:start_server:96 - 本机访问: http://127.0.0.1:8000
2025-08-21 14:15:23.533 | INFO     | __main__:start_server:97 - 局域网访问: http://172.16.4.155:8000
2025-08-21 14:15:23.533 | INFO     | __main__:start_server:99 - 热重载: 关闭
2025-08-21 14:15:25.924 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 14:15:26.115 | CRITICAL | __main__:start_server:111 - 服务器启动失败: cannot import name 'SQLLITE_FILE' from 'app.cfg.config' (D:\ABT\0-Project\face_rec\app\cfg\config.py)
2025-08-21 14:18:24.387 | INFO     | __main__:init_app_state:32 - 应用环境: DEVELOPMENT
2025-08-21 14:18:24.388 | INFO     | __main__:start_server:91 - 启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 14:18:24.388 | INFO     | __main__:start_server:92 - 监听地址: http://0.0.0.0:8000
2025-08-21 14:18:24.389 | INFO     | __main__:start_server:96 - 本机访问: http://127.0.0.1:8000
2025-08-21 14:18:24.390 | INFO     | __main__:start_server:97 - 局域网访问: http://172.16.4.155:8000
2025-08-21 14:18:24.391 | INFO     | __main__:start_server:99 - 热重载: 关闭
2025-08-21 14:18:26.704 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 14:18:26.891 | CRITICAL | __main__:start_server:111 - 服务器启动失败: name 'SQLLITE_FILE' is not defined
2025-08-21 14:20:38.801 | INFO     | __main__:init_app_state:32 - 应用环境: DEVELOPMENT
2025-08-21 14:20:38.802 | INFO     | __main__:start_server:91 - 启动服务器: FastAPI人脸识别服务 v4.5.0-Final
2025-08-21 14:20:38.803 | INFO     | __main__:start_server:92 - 监听地址: http://0.0.0.0:8000
2025-08-21 14:20:38.803 | INFO     | __main__:start_server:96 - 本机访问: http://127.0.0.1:8000
2025-08-21 14:20:38.803 | INFO     | __main__:start_server:97 - 局域网访问: http://172.16.4.155:8000
2025-08-21 14:20:38.804 | INFO     | __main__:start_server:99 - 热重载: 关闭
2025-08-21 14:20:42.008 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: data\.insightface
2025-08-21 14:20:42.175 | CRITICAL | __main__:start_server:111 - 服务器启动失败: name 'SQLLITE_FILE' is not defined
2025-08-21 14:28:06.827 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-21 14:28:06.828 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-21 14:28:06.828 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:8000
2025-08-21 14:28:06.829 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:8000
2025-08-21 14:28:06.829 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:8000
2025-08-21 14:28:06.829 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-21 14:28:09.212 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-21 14:28:10.028 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 14:28:10.028 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 14:28:10.031 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 14:28:10.031 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 14:28:10.032 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:10.033 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:10.033 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:13.647 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:13.862 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:13.986 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:13.987 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 14:28:13.987 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 14:28:15.858 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 14:28:15.858 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 14:28:15.859 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 14:28:15.860 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 14:28:15.860 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 14:28:15.860 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 14:28:15.864 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 14:28:15.867 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 14:28:15.867 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 14:28:15.867 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 14:28:15.867 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 14:28:15.867 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 14:28:17.954 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 14:28:17.955 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 14:28:17.955 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 14:28:17.955 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 14:28:17.956 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 14:28:17.956 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 14:28:18.057 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 14:28:18.058 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-21 14:28:20.361 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-21 14:28:20.362 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-21 14:28:20.363 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:8000
2025-08-21 14:28:20.363 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:8000
2025-08-21 14:28:20.363 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:8000
2025-08-21 14:28:20.364 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-21 14:28:22.860 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-21 14:28:23.586 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 14:28:23.587 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 14:28:23.589 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 14:28:23.589 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 14:28:23.590 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:23.591 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:23.591 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:28:26.866 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:27.128 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:27.129 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:28:27.130 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 14:28:27.131 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 14:28:29.242 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 14:28:29.242 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 14:28:29.242 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 14:28:29.243 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 14:28:29.243 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 14:28:29.243 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 14:28:29.249 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 14:28:29.253 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 14:28:29.253 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 14:28:29.253 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 14:28:29.254 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 14:28:29.254 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 14:28:36.718 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 14:28:36.718 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 14:28:36.719 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 14:28:36.719 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 14:28:36.719 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 14:28:36.719 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 14:28:36.821 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 14:28:36.821 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-21 14:29:00.927 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-21 14:29:00.928 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-21 14:29:00.928 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-21 14:29:00.929 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-21 14:29:00.929 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-21 14:29:00.929 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-21 14:29:03.176 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-21 14:29:03.776 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-21 14:29:03.776 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-21 14:29:03.779 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-21 14:29:03.779 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-21 14:29:03.780 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:29:03.780 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:29:05.832 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-21 14:29:07.428 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:29:07.429 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:29:07.554 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-21 14:29:07.554 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-21 14:29:07.555 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-21 14:29:09.412 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-21 14:29:09.412 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-21 14:29:09.413 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-21 14:29:09.413 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-21 14:29:09.414 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-21 14:29:09.414 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-21 14:29:09.417 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 14:29:09.420 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-21 14:29:09.420 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-21 14:29:09.421 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-21 14:29:09.421 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-21 14:29:09.421 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-21 14:29:21.465 | INFO     | app.core.pipeline:__init__:46 - 【流水线 0f00f47c-c45b-48e3-b293-c2e910f18158】正在初始化...
2025-08-21 14:29:21.465 | INFO     | app.service.face_service:start_stream:196 - 🚀 视频流线程已启动: ID=0f00f47c-c45b-48e3-b293-c2e910f18158, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-21 14:29:21.470 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-21 14:29:21.475 | INFO     | app.core.pipeline:start:63 - 【流水线 0f00f47c-c45b-48e3-b293-c2e910f18158】正在启动...
2025-08-21 14:29:21.756 | INFO     | app.core.pipeline:_reader_thread:106 - 【T1:读帧 0f00f47c-c45b-48e3-b293-c2e910f18158】启动。
2025-08-21 14:29:21.757 | INFO     | app.core.pipeline:_preprocessor_thread:152 - 【T2:预处理 0f00f47c-c45b-48e3-b293-c2e910f18158】启动。
2025-08-21 14:29:21.763 | INFO     | app.core.pipeline:_inference_thread:166 - 【T3:推理 0f00f47c-c45b-48e3-b293-c2e910f18158】启动。
2025-08-21 14:29:21.777 | INFO     | app.core.pipeline:_postprocessor_thread:208 - 【T4:后处理 0f00f47c-c45b-48e3-b293-c2e910f18158】启动。
2025-08-21 14:29:58.090 | INFO     | app.core.pipeline:stop:73 - 【流水线 0f00f47c-c45b-48e3-b293-c2e910f18158】正在停止...
2025-08-21 14:29:58.094 | INFO     | app.core.pipeline:_inference_thread:202 - 【T3:推理 0f00f47c-c45b-48e3-b293-c2e910f18158】已停止。
2025-08-21 14:29:58.121 | INFO     | app.core.pipeline:_postprocessor_thread:277 - 【T4:后处理 0f00f47c-c45b-48e3-b293-c2e910f18158】已停止。
2025-08-21 14:29:58.122 | INFO     | app.core.pipeline:_reader_thread:148 - 【T1:读帧 0f00f47c-c45b-48e3-b293-c2e910f18158】已停止。
2025-08-21 14:30:00.151 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-21 14:30:00.151 | INFO     | app.core.pipeline:stop:87 - ✅【流水线 0f00f47c-c45b-48e3-b293-c2e910f18158】已安全停止。
2025-08-21 14:30:00.152 | INFO     | app.service.face_service:_pipeline_worker_thread:175 - ✅【线程 0f00f47c-c45b-48e3-b293-c2e910f18158】处理工作已结束。
2025-08-21 14:30:00.152 | INFO     | app.core.pipeline:_preprocessor_thread:162 - 【T2:预处理 0f00f47c-c45b-48e3-b293-c2e910f18158】已停止。
2025-08-21 14:30:00.153 | INFO     | app.service.face_service:stop_stream:205 - ✅ 视频流已成功停止: ID=0f00f47c-c45b-48e3-b293-c2e910f18158
2025-08-21 14:30:45.845 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-21 14:30:45.845 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-21 14:30:45.845 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-21 14:30:45.847 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-21 14:30:45.847 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-21 14:30:45.848 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-21 14:30:45.994 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-21 14:30:45.995 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-25 09:00:10.177 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 09:00:10.178 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 09:00:10.178 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 09:00:10.179 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 09:00:10.179 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 09:00:10.179 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 09:00:14.896 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 09:00:16.247 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-25 09:00:16.247 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-25 09:00:16.268 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-25 09:00:16.268 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 09:00:16.269 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:00:16.270 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:00:16.271 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:00:16.274 | ERROR    | app.core.model_manager:create_face_analysis_model:38 - 创建InsightFace模型失败: [WinError 183] 当文件已存在时，无法创建该文件。: 'D:\\ABT\\0-Project\\face_rec\\data\\.insightface\\models'
2025-08-25 09:00:16.275 | ERROR    | app.core.model_manager:create_face_analysis_model:38 - 创建InsightFace模型失败: [WinError 183] 当文件已存在时，无法创建该文件。: 'D:\\ABT\\0-Project\\face_rec\\data\\.insightface\\models'
2025-08-25 09:00:16.277 | ERROR    | app.core.model_manager:load_models:98 - 模型加载失败: 模型创建失败: [WinError 183] 当文件已存在时，无法创建该文件。: 'D:\\ABT\\0-Project\\face_rec\\data\\.insightface\\models'
2025-08-25 09:00:37.309 | ERROR    | app.core.model_manager:create_face_analysis_model:38 - 创建InsightFace模型失败: HTTPSConnectionPool(host='github.com', port=443): Max retries exceeded with url: /deepinsight/insightface/releases/download/v0.7/buffalo_l.zip (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x00000169671C12A0>, 'Connection to github.com timed out. (connect timeout=None)'))
2025-08-25 09:04:24.368 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 09:04:24.368 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 09:04:24.369 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 09:04:24.369 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 09:04:24.369 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 09:04:24.369 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 09:04:26.322 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 09:04:26.962 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-25 09:04:26.962 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-25 09:04:26.966 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-25 09:04:26.966 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 09:04:26.967 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:04:26.967 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:04:26.968 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:04:31.094 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:04:31.094 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:04:31.235 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:04:31.236 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 09:04:31.236 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 09:04:34.161 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 09:04:34.162 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-25 09:04:34.162 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-25 09:04:34.163 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-25 09:04:34.163 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-25 09:04:34.163 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 09:04:34.191 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 09:04:34.219 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 09:04:34.219 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 09:04:34.219 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-25 09:04:34.220 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 09:04:34.220 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 09:04:37.721 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 09:04:37.721 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-25 09:04:37.722 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-25 09:04:37.722 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-25 09:04:37.722 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-25 09:04:37.722 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-25 09:04:37.846 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-25 09:04:37.846 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-25 09:05:22.975 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 09:05:22.975 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 09:05:22.976 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 09:05:22.976 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 09:05:22.977 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 09:05:22.977 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 09:05:27.424 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 09:05:27.974 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-25 09:05:27.975 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-25 09:05:27.976 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-25 09:05:27.977 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 09:05:27.977 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:05:27.978 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:05:27.979 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 09:05:30.803 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:05:30.804 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:05:30.929 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 09:05:30.929 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 09:05:30.930 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 09:05:32.673 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 09:05:32.674 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-25 09:05:32.674 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-25 09:05:32.675 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-25 09:05:32.675 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-25 09:05:32.675 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 09:05:32.679 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 09:05:32.682 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 09:05:32.682 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 09:05:32.682 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-25 09:05:32.682 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 09:05:32.682 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 09:05:56.012 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 09:05:56.067 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'sn001' 的记录。
2025-08-25 09:05:56.137 | INFO     | app.service.face_service:update_face_by_sn:124 - 人员信息已更新: SN=sn001, 新数据={'name': 'z'}, 影响记录数=1
2025-08-25 10:30:23.631 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 10:30:23.632 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 10:30:23.632 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 10:30:23.633 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 10:30:23.633 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 10:30:23.634 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 10:30:30.103 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 10:30:34.541 | INFO     | app.main:lifespan:30 - 应用程序启动... 开始执行启动任务。
2025-08-25 10:30:34.542 | INFO     | app.main:lifespan:33 - 应用启动，开始初始化数据库...
2025-08-25 10:30:34.551 | INFO     | app.main:lifespan:35 - 数据库初始化完成。
2025-08-25 10:30:34.551 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 10:30:34.552 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:30:34.553 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:30:34.553 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:30:41.337 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:30:41.338 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:30:41.523 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:30:41.524 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 10:30:41.525 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 10:30:46.048 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 10:30:46.048 | INFO     | app.main:lifespan:39 - ✅ 模型池加载完成。
2025-08-25 10:30:46.049 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-25 10:30:46.050 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-25 10:30:46.051 | INFO     | app.main:lifespan:46 - ✅ 结果持久化服务已启动。
2025-08-25 10:30:46.051 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 10:30:46.059 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 10:30:46.064 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 10:30:46.065 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 10:30:46.065 | INFO     | app.main:lifespan:54 - ✅ FaceService 初始化完成。
2025-08-25 10:30:46.066 | INFO     | app.main:lifespan:59 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 10:30:46.066 | INFO     | app.main:lifespan:61 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 10:31:03.732 | INFO     | app.main:lifespan:64 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 10:31:03.733 | INFO     | app.main:lifespan:73 - ✅ 视频流清理任务已取消。
2025-08-25 10:31:03.733 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-25 10:31:03.733 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-25 10:31:03.734 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-25 10:31:03.734 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-25 10:31:03.935 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-25 10:31:03.936 | INFO     | app.main:lifespan:86 - ✅ 所有清理任务完成。
2025-08-25 10:32:39.066 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 10:32:39.067 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 10:32:39.067 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 10:32:39.067 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 10:32:39.068 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 10:32:39.068 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 10:32:51.393 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 10:32:52.024 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 10:32:52.024 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 10:32:52.026 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 10:32:52.026 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 10:32:52.027 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:32:52.027 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:32:52.028 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:32:55.631 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:32:55.893 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:32:56.019 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:32:56.020 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 10:32:56.021 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 10:32:57.903 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 10:32:57.903 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 10:32:57.904 | INFO     | app.core.result_processor:start:33 - 启动结果持久化服务...
2025-08-25 10:32:57.905 | INFO     | app.core.result_processor:_worker:59 - 结果持久化工作线程已启动。
2025-08-25 10:32:57.905 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 10:32:57.905 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 10:32:57.910 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 10:32:57.914 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 10:32:57.914 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 10:32:57.914 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 10:32:57.914 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 10:32:57.915 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 10:34:36.898 | INFO     | app.core.pipeline:__init__:46 - 【流水线 7436dd92-8900-4f81-8f58-9617149e52ba】正在初始化...
2025-08-25 10:34:36.898 | INFO     | app.service.face_service:start_stream:196 - 🚀 视频流线程已启动: ID=7436dd92-8900-4f81-8f58-9617149e52ba, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 10:34:36.906 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 10:34:36.911 | INFO     | app.core.pipeline:start:63 - 【流水线 7436dd92-8900-4f81-8f58-9617149e52ba】正在启动...
2025-08-25 10:34:37.246 | INFO     | app.core.pipeline:_reader_thread:106 - 【T1:读帧 7436dd92-8900-4f81-8f58-9617149e52ba】启动。
2025-08-25 10:34:37.247 | INFO     | app.core.pipeline:_preprocessor_thread:152 - 【T2:预处理 7436dd92-8900-4f81-8f58-9617149e52ba】启动。
2025-08-25 10:34:37.249 | INFO     | app.core.pipeline:_inference_thread:166 - 【T3:推理 7436dd92-8900-4f81-8f58-9617149e52ba】启动。
2025-08-25 10:34:37.253 | INFO     | app.core.pipeline:_postprocessor_thread:208 - 【T4:后处理 7436dd92-8900-4f81-8f58-9617149e52ba】启动。
2025-08-25 10:35:14.666 | INFO     | app.core.pipeline:stop:73 - 【流水线 7436dd92-8900-4f81-8f58-9617149e52ba】正在停止...
2025-08-25 10:35:14.667 | INFO     | app.core.pipeline:_reader_thread:148 - 【T1:读帧 7436dd92-8900-4f81-8f58-9617149e52ba】已停止。
2025-08-25 10:35:14.681 | INFO     | app.core.pipeline:_inference_thread:202 - 【T3:推理 7436dd92-8900-4f81-8f58-9617149e52ba】已停止。
2025-08-25 10:35:14.699 | INFO     | app.core.pipeline:_postprocessor_thread:277 - 【T4:后处理 7436dd92-8900-4f81-8f58-9617149e52ba】已停止。
2025-08-25 10:35:16.702 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 10:35:16.702 | INFO     | app.core.pipeline:_preprocessor_thread:162 - 【T2:预处理 7436dd92-8900-4f81-8f58-9617149e52ba】已停止。
2025-08-25 10:35:16.703 | INFO     | app.core.pipeline:stop:87 - ✅【流水线 7436dd92-8900-4f81-8f58-9617149e52ba】已安全停止。
2025-08-25 10:35:16.704 | INFO     | app.service.face_service:_pipeline_worker_thread:175 - ✅【线程 7436dd92-8900-4f81-8f58-9617149e52ba】处理工作已结束。
2025-08-25 10:35:16.708 | INFO     | app.service.face_service:stop_stream:205 - ✅ 视频流已成功停止: ID=7436dd92-8900-4f81-8f58-9617149e52ba
2025-08-25 10:39:46.361 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 10:39:46.364 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 10:39:46.364 | INFO     | app.core.result_processor:stop:38 - 正在停止结果持久化服务...
2025-08-25 10:39:46.365 | INFO     | app.core.result_processor:_worker:105 - 结果持久化工作线程已停止。
2025-08-25 10:39:46.366 | INFO     | app.core.result_processor:stop:46 - ✅ 结果持久化服务已停止。
2025-08-25 10:39:46.366 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-25 10:39:46.614 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-25 10:39:46.614 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 10:44:43.825 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 10:44:43.825 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 10:44:43.825 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 10:44:43.826 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 10:44:43.826 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 10:44:43.826 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 10:44:46.526 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 10:44:47.390 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 10:44:47.391 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 10:44:47.401 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 10:44:47.401 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 10:44:47.402 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:44:47.403 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:44:47.404 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 10:44:52.971 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:44:53.080 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:44:53.080 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 10:44:53.081 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 10:44:53.082 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 10:44:55.884 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 10:44:55.885 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 10:44:55.886 | INFO     | app.core.result_processor:_worker_loop:70 - 结果持久化处理器工作线程已启动
2025-08-25 10:44:55.887 | INFO     | app.core.result_processor:start:51 - ✅ 结果持久化处理器已启动
2025-08-25 10:44:55.887 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 10:44:55.887 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 10:44:55.906 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 10:44:55.926 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 10:44:55.926 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 10:44:55.926 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 10:44:55.927 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 10:44:55.927 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 10:44:58.328 | INFO     | app.core.pipeline:__init__:46 - 【流水线 80f11e9d-640c-4c56-afac-eae1f061d86e】正在初始化...
2025-08-25 10:44:58.329 | INFO     | app.service.face_service:start_stream:196 - 🚀 视频流线程已启动: ID=80f11e9d-640c-4c56-afac-eae1f061d86e, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 10:44:58.335 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 10:44:58.339 | INFO     | app.core.pipeline:start:63 - 【流水线 80f11e9d-640c-4c56-afac-eae1f061d86e】正在启动...
2025-08-25 10:44:58.571 | INFO     | app.core.pipeline:_reader_thread:106 - 【T1:读帧 80f11e9d-640c-4c56-afac-eae1f061d86e】启动。
2025-08-25 10:44:58.572 | INFO     | app.core.pipeline:_preprocessor_thread:152 - 【T2:预处理 80f11e9d-640c-4c56-afac-eae1f061d86e】启动。
2025-08-25 10:44:58.574 | INFO     | app.core.pipeline:_inference_thread:166 - 【T3:推理 80f11e9d-640c-4c56-afac-eae1f061d86e】启动。
2025-08-25 10:44:58.577 | INFO     | app.core.pipeline:_postprocessor_thread:208 - 【T4:后处理 80f11e9d-640c-4c56-afac-eae1f061d86e】启动。
2025-08-25 10:45:00.434 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.718
2025-08-25 10:45:00.451 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.718
2025-08-25 10:45:00.478 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.705
2025-08-25 10:45:00.521 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.684
2025-08-25 10:45:00.582 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.608
2025-08-25 10:45:00.650 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.604
2025-08-25 10:45:00.712 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.675
2025-08-25 10:45:00.772 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.718
2025-08-25 10:45:00.836 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.722
2025-08-25 10:45:00.902 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.723
2025-08-25 10:45:00.960 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.718
2025-08-25 10:45:01.022 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.709
2025-08-25 10:45:01.087 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.679
2025-08-25 10:45:04.566 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.692
2025-08-25 10:45:04.625 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:04.680 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.706
2025-08-25 10:45:04.749 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.712
2025-08-25 10:45:04.806 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.713
2025-08-25 10:45:04.863 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.716
2025-08-25 10:45:04.929 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.726
2025-08-25 10:45:05.000 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.720
2025-08-25 10:45:05.064 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.693
2025-08-25 10:45:05.135 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.686
2025-08-25 10:45:05.204 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.675
2025-08-25 10:45:05.268 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.672
2025-08-25 10:45:05.332 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.665
2025-08-25 10:45:05.390 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.658
2025-08-25 10:45:05.447 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.671
2025-08-25 10:45:05.506 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.662
2025-08-25 10:45:05.569 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.650
2025-08-25 10:45:05.633 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.638
2025-08-25 10:45:05.685 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.652
2025-08-25 10:45:05.739 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.664
2025-08-25 10:45:05.791 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.670
2025-08-25 10:45:05.851 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.674
2025-08-25 10:45:05.901 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.684
2025-08-25 10:45:05.959 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:06.014 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.702
2025-08-25 10:45:06.073 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:06.128 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:06.183 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.711
2025-08-25 10:45:06.236 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.716
2025-08-25 10:45:06.294 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.713
2025-08-25 10:45:06.353 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.719
2025-08-25 10:45:06.420 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.705
2025-08-25 10:45:06.473 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.708
2025-08-25 10:45:06.537 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.700
2025-08-25 10:45:06.589 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.698
2025-08-25 10:45:06.650 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.701
2025-08-25 10:45:06.706 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.704
2025-08-25 10:45:06.759 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.691
2025-08-25 10:45:06.811 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.785
2025-08-25 10:45:06.865 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:06.920 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:06.975 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.795
2025-08-25 10:45:07.033 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.781
2025-08-25 10:45:07.088 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.774
2025-08-25 10:45:07.143 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.768
2025-08-25 10:45:07.195 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.754
2025-08-25 10:45:07.254 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.744
2025-08-25 10:45:07.311 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.714
2025-08-25 10:45:07.368 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.728
2025-08-25 10:45:07.417 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.743
2025-08-25 10:45:07.473 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.743
2025-08-25 10:45:07.536 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.744
2025-08-25 10:45:07.593 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.713
2025-08-25 10:45:07.646 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.691
2025-08-25 10:45:07.706 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.689
2025-08-25 10:45:07.769 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.694
2025-08-25 10:45:07.833 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.717
2025-08-25 10:45:07.893 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.747
2025-08-25 10:45:07.948 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.756
2025-08-25 10:45:08.003 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:08.063 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.727
2025-08-25 10:45:08.123 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.729
2025-08-25 10:45:08.183 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.720
2025-08-25 10:45:08.242 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.750
2025-08-25 10:45:08.297 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.761
2025-08-25 10:45:08.363 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.788
2025-08-25 10:45:08.409 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.775
2025-08-25 10:45:08.469 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.770
2025-08-25 10:45:08.526 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.754
2025-08-25 10:45:08.581 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.730
2025-08-25 10:45:08.648 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.750
2025-08-25 10:45:08.703 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.754
2025-08-25 10:45:08.760 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.736
2025-08-25 10:45:08.818 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.712
2025-08-25 10:45:08.878 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.734
2025-08-25 10:45:08.930 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.744
2025-08-25 10:45:08.998 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.752
2025-08-25 10:45:09.060 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.750
2025-08-25 10:45:09.125 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.748
2025-08-25 10:45:09.191 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.733
2025-08-25 10:45:09.247 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.723
2025-08-25 10:45:09.314 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.739
2025-08-25 10:45:09.371 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.696
2025-08-25 10:45:09.429 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.731
2025-08-25 10:45:09.488 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.755
2025-08-25 10:45:09.545 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.767
2025-08-25 10:45:09.610 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.772
2025-08-25 10:45:09.667 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.782
2025-08-25 10:45:09.726 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.762
2025-08-25 10:45:09.781 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.574
2025-08-25 10:45:09.878 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.764
2025-08-25 10:45:09.936 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.749
2025-08-25 10:45:09.990 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.752
2025-08-25 10:45:10.050 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.744
2025-08-25 10:45:10.108 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.745
2025-08-25 10:45:10.170 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.748
2025-08-25 10:45:10.228 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.794
2025-08-25 10:45:10.279 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:10.344 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.800
2025-08-25 10:45:10.403 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.807
2025-08-25 10:45:10.460 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.737
2025-08-25 10:45:10.515 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.741
2025-08-25 10:45:10.571 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.749
2025-08-25 10:45:10.632 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.762
2025-08-25 10:45:10.697 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.746
2025-08-25 10:45:10.753 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.791
2025-08-25 10:45:10.813 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.783
2025-08-25 10:45:10.870 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.791
2025-08-25 10:45:10.927 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.703
2025-08-25 10:45:10.982 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.736
2025-08-25 10:45:11.036 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.754
2025-08-25 10:45:11.095 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.777
2025-08-25 10:45:11.155 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.785
2025-08-25 10:45:11.212 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.782
2025-08-25 10:45:11.281 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.737
2025-08-25 10:45:13.075 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.809
2025-08-25 10:45:13.118 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.809
2025-08-25 10:45:13.158 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.805
2025-08-25 10:45:13.194 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.812
2025-08-25 10:45:13.232 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.815
2025-08-25 10:45:13.270 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.782
2025-08-25 10:45:13.482 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:13.522 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:13.771 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.798
2025-08-25 10:45:13.780 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.789
2025-08-25 10:45:13.795 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.806
2025-08-25 10:45:13.804 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.801
2025-08-25 10:45:13.817 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:13.826 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.786
2025-08-25 10:45:13.856 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.798
2025-08-25 10:45:13.895 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:13.991 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.780
2025-08-25 10:45:14.034 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.776
2025-08-25 10:45:14.076 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.787
2025-08-25 10:45:14.113 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.785
2025-08-25 10:45:14.152 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.780
2025-08-25 10:45:14.195 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.770
2025-08-25 10:45:14.240 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:14.283 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.783
2025-08-25 10:45:14.332 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.786
2025-08-25 10:45:14.369 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.777
2025-08-25 10:45:14.408 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.831
2025-08-25 10:45:14.450 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.848
2025-08-25 10:45:14.488 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.842
2025-08-25 10:45:14.536 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.839
2025-08-25 10:45:14.573 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.839
2025-08-25 10:45:14.610 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.854
2025-08-25 10:45:14.649 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.865
2025-08-25 10:45:14.690 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.872
2025-08-25 10:45:14.734 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.896
2025-08-25 10:45:14.772 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.898
2025-08-25 10:45:14.813 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.898
2025-08-25 10:45:14.849 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.898
2025-08-25 10:45:14.899 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.908
2025-08-25 10:45:14.955 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.902
2025-08-25 10:45:14.991 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.905
2025-08-25 10:45:15.030 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.906
2025-08-25 10:45:15.076 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.900
2025-08-25 10:45:15.114 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.907
2025-08-25 10:45:15.152 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.900
2025-08-25 10:45:15.191 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.900
2025-08-25 10:45:15.234 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.885
2025-08-25 10:45:15.273 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.872
2025-08-25 10:45:15.315 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.847
2025-08-25 10:45:15.356 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.834
2025-08-25 10:45:15.391 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.831
2025-08-25 10:45:15.520 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.825
2025-08-25 10:45:15.532 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.824
2025-08-25 10:45:15.555 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.820
2025-08-25 10:45:15.593 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.835
2025-08-25 10:45:15.638 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.831
2025-08-25 10:45:15.676 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.840
2025-08-25 10:45:15.714 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.817
2025-08-25 10:45:15.761 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.790
2025-08-25 10:45:15.803 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.766
2025-08-25 10:45:15.842 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.714
2025-08-25 10:45:15.886 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.701
2025-08-25 10:45:15.930 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.711
2025-08-25 10:45:15.967 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.699
2025-08-25 10:45:16.008 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.688
2025-08-25 10:45:16.050 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.689
2025-08-25 10:45:16.090 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.722
2025-08-25 10:45:16.130 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.723
2025-08-25 10:45:16.179 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.718
2025-08-25 10:45:16.228 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.707
2025-08-25 10:45:16.272 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.680
2025-08-25 10:45:16.309 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.665
2025-08-25 10:45:16.353 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.662
2025-08-25 10:45:16.396 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.711
2025-08-25 10:45:16.432 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.733
2025-08-25 10:45:16.475 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.739
2025-08-25 10:45:16.511 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.739
2025-08-25 10:45:16.558 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.765
2025-08-25 10:45:16.604 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.772
2025-08-25 10:45:16.647 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.770
2025-08-25 10:45:16.691 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.782
2025-08-25 10:45:16.728 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.787
2025-08-25 10:45:16.771 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.790
2025-08-25 10:45:16.809 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:16.851 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.791
2025-08-25 10:45:16.900 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.791
2025-08-25 10:45:16.943 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.797
2025-08-25 10:45:16.980 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.793
2025-08-25 10:45:17.020 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.787
2025-08-25 10:45:17.080 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.779
2025-08-25 10:45:17.280 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.761
2025-08-25 10:45:17.361 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:17.422 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.785
2025-08-25 10:45:17.431 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.774
2025-08-25 10:45:17.446 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.801
2025-08-25 10:45:17.494 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.825
2025-08-25 10:45:17.555 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.812
2025-08-25 10:45:17.617 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.818
2025-08-25 10:45:17.676 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.792
2025-08-25 10:45:17.737 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.823
2025-08-25 10:45:17.806 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.863
2025-08-25 10:45:17.865 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.863
2025-08-25 10:45:17.927 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.868
2025-08-25 10:45:17.986 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.876
2025-08-25 10:45:18.051 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.884
2025-08-25 10:45:18.114 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.886
2025-08-25 10:45:18.180 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.896
2025-08-25 10:45:18.238 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.902
2025-08-25 10:45:18.304 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.909
2025-08-25 10:45:18.370 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.919
2025-08-25 10:45:18.429 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.912
2025-08-25 10:45:18.487 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.981
2025-08-25 10:45:18.554 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.984
2025-08-25 10:45:18.613 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.985
2025-08-25 10:45:18.678 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.986
2025-08-25 10:45:18.744 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.986
2025-08-25 10:45:18.806 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.986
2025-08-25 10:45:18.872 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.987
2025-08-25 10:45:18.929 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.988
2025-08-25 10:45:18.998 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.988
2025-08-25 10:45:19.057 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.987
2025-08-25 10:45:19.118 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.983
2025-08-25 10:45:19.180 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.982
2025-08-25 10:45:19.241 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.981
2025-08-25 10:45:19.314 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.980
2025-08-25 10:45:19.370 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.980
2025-08-25 10:45:19.576 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.979
2025-08-25 10:45:19.591 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.979
2025-08-25 10:45:19.673 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.977
2025-08-25 10:45:19.701 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.974
2025-08-25 10:45:19.731 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.972
2025-08-25 10:45:19.760 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.973
2025-08-25 10:45:19.831 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.972
2025-08-25 10:45:19.893 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.974
2025-08-25 10:45:19.950 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.973
2025-08-25 10:45:20.013 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.973
2025-08-25 10:45:20.075 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.973
2025-08-25 10:45:20.130 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.974
2025-08-25 10:45:20.191 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.972
2025-08-25 10:45:20.259 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.968
2025-08-25 10:45:20.325 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.966
2025-08-25 10:45:20.395 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.966
2025-08-25 10:45:20.458 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.967
2025-08-25 10:45:20.519 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.967
2025-08-25 10:45:20.581 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.966
2025-08-25 10:45:20.651 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.966
2025-08-25 10:45:20.731 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.690
2025-08-25 10:45:20.799 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.695
2025-08-25 10:45:20.862 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.690
2025-08-25 10:45:20.922 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.685
2025-08-25 10:45:20.995 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.680
2025-08-25 10:45:21.067 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.680
2025-08-25 10:45:21.120 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.682
2025-08-25 10:45:21.192 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.688
2025-08-25 10:45:21.251 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.701
2025-08-25 10:45:21.311 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.679
2025-08-25 10:45:21.368 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.682
2025-08-25 10:45:21.434 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.685
2025-08-25 10:45:21.502 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.690
2025-08-25 10:45:21.561 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.696
2025-08-25 10:45:21.622 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.697
2025-08-25 10:45:21.689 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.694
2025-08-25 10:45:21.756 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.695
2025-08-25 10:45:21.828 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.689
2025-08-25 10:45:21.896 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.690
2025-08-25 10:45:21.973 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.686
2025-08-25 10:45:22.058 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.670
2025-08-25 10:45:22.115 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.661
2025-08-25 10:45:22.182 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.653
2025-08-25 10:45:22.257 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.665
2025-08-25 10:45:22.331 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.663
2025-08-25 10:45:22.391 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.669
2025-08-25 10:45:22.461 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.657
2025-08-25 10:45:22.538 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.634
2025-08-25 10:45:22.609 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.622
2025-08-25 10:45:22.679 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.629
2025-08-25 10:45:22.745 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.593
2025-08-25 10:45:22.807 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.712
2025-08-25 10:45:22.873 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.752
2025-08-25 10:45:22.942 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.739
2025-08-25 10:45:23.009 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.740
2025-08-25 10:45:23.072 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.740
2025-08-25 10:45:23.365 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.618
2025-08-25 10:45:23.420 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.738
2025-08-25 10:45:23.488 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.767
2025-08-25 10:45:23.552 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.758
2025-08-25 10:45:23.618 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.775
2025-08-25 10:45:23.690 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.765
2025-08-25 10:45:23.815 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.747
2025-08-25 10:45:24.047 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.743
2025-08-25 10:45:24.163 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.717
2025-08-25 10:45:24.188 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.700
2025-08-25 10:45:24.212 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.529
2025-08-25 10:45:24.278 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.585
2025-08-25 10:45:24.306 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.647
2025-08-25 10:45:24.365 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.618
2025-08-25 10:45:24.429 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.589
2025-08-25 10:45:24.492 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.586
2025-08-25 10:45:25.388 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.501
2025-08-25 10:45:25.582 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.547
2025-08-25 10:45:25.671 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.578
2025-08-25 10:45:26.895 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.557
2025-08-25 10:45:26.937 | INFO     | app.core.result_processor:_process_detection_result:131 - 成功保存检测结果: SN=sn003, Name=hong1, Similarity=0.529
2025-08-25 10:45:28.817 | INFO     | app.core.pipeline:stop:73 - 【流水线 80f11e9d-640c-4c56-afac-eae1f061d86e】正在停止...
2025-08-25 10:45:28.825 | INFO     | app.core.pipeline:_postprocessor_thread:277 - 【T4:后处理 80f11e9d-640c-4c56-afac-eae1f061d86e】已停止。
2025-08-25 10:45:28.859 | INFO     | app.core.pipeline:_reader_thread:148 - 【T1:读帧 80f11e9d-640c-4c56-afac-eae1f061d86e】已停止。
2025-08-25 10:45:28.866 | INFO     | app.core.pipeline:_inference_thread:202 - 【T3:推理 80f11e9d-640c-4c56-afac-eae1f061d86e】已停止。
2025-08-25 10:45:30.907 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 10:45:30.907 | INFO     | app.core.pipeline:_preprocessor_thread:162 - 【T2:预处理 80f11e9d-640c-4c56-afac-eae1f061d86e】已停止。
2025-08-25 10:45:30.907 | INFO     | app.core.pipeline:stop:87 - ✅【流水线 80f11e9d-640c-4c56-afac-eae1f061d86e】已安全停止。
2025-08-25 10:45:30.908 | INFO     | app.service.face_service:_pipeline_worker_thread:175 - ✅【线程 80f11e9d-640c-4c56-afac-eae1f061d86e】处理工作已结束。
2025-08-25 10:45:30.913 | INFO     | app.service.face_service:stop_stream:205 - ✅ 视频流已成功停止: ID=80f11e9d-640c-4c56-afac-eae1f061d86e
2025-08-25 11:06:09.354 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 11:06:09.355 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 11:06:09.355 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 11:06:09.355 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 11:06:09.356 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 11:06:09.356 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 11:06:12.510 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 11:06:13.417 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 11:06:13.417 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 11:06:13.420 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 11:06:13.421 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 11:06:13.421 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:06:13.422 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:06:13.422 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:07:12.667 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 11:07:12.670 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 11:07:12.670 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 11:07:12.670 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 11:07:12.671 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 11:07:12.671 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 11:07:17.976 | INFO     | app.core.model_manager:_setup_environment:69 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 11:07:19.162 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 11:07:19.162 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 11:07:19.171 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 11:07:19.171 | INFO     | app.core.model_manager:load_models:78 - 开始加载3个模型实例到池中
2025-08-25 11:07:19.172 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:07:19.173 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:07:19.173 | INFO     | app.core.model_manager:create_face_analysis_model:16 - 创建InsightFace模型: buffalo_l
2025-08-25 11:07:23.005 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 11:07:23.178 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 11:07:23.179 | INFO     | app.core.model_manager:create_face_analysis_model:34 - InsightFace模型创建成功
2025-08-25 11:07:23.180 | INFO     | app.core.model_manager:load_models:92 - 成功加载3个模型到池中
2025-08-25 11:07:23.180 | INFO     | app.core.model_manager:_startup_test:109 - 开始启动自检
2025-08-25 11:07:25.099 | INFO     | app.core.model_manager:_startup_test:120 - 自检成功：检测到1张人脸
2025-08-25 11:07:25.100 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 11:07:25.101 | INFO     | app.core.result_processor:_worker_loop:70 - 结果持久化处理器工作线程已启动
2025-08-25 11:07:25.101 | INFO     | app.core.result_processor:start:51 - ✅ 结果持久化处理器已启动
2025-08-25 11:07:25.102 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 11:07:25.102 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 11:07:25.129 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 11:07:25.155 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 11:07:25.156 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 11:07:25.156 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 11:07:25.156 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 11:07:25.156 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 11:07:25.376 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 11:07:25.376 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 11:07:25.377 | INFO     | app.core.result_processor:_worker_loop:89 - 结果持久化处理器工作线程已停止
2025-08-25 11:07:25.377 | INFO     | app.core.result_processor:stop:66 - ✅ 结果持久化处理器已停止
2025-08-25 11:07:25.377 | INFO     | app.core.model_manager:cleanup:159 - 清理模型池资源
2025-08-25 11:07:25.488 | INFO     | app.core.model_manager:cleanup:165 - 模型池已清空
2025-08-25 11:07:25.488 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 11:18:29.787 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 11:18:29.788 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 11:18:29.788 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 11:18:29.788 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 11:18:29.789 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 11:18:29.789 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 11:18:33.093 | INFO     | app.core.model_manager:_setup_environment:86 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 11:18:33.769 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 11:18:33.769 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 11:18:33.771 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 11:18:33.772 | INFO     | app.core.model_manager:load_models:98 - 开始加载3个模型实例到池中
2025-08-25 11:18:33.772 | INFO     | app.core.model_manager:create_face_analysis_model:17 - 创建InsightFace模型: buffalo_l
2025-08-25 11:18:33.773 | INFO     | app.core.model_manager:create_face_analysis_model:17 - 创建InsightFace模型: buffalo_l
2025-08-25 11:18:33.773 | INFO     | app.core.model_manager:create_face_analysis_model:23 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:18:33.774 | INFO     | app.core.model_manager:create_face_analysis_model:23 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:18:33.774 | INFO     | app.core.model_manager:create_face_analysis_model:17 - 创建InsightFace模型: buffalo_l
2025-08-25 11:18:33.774 | ERROR    | app.core.model_manager:create_face_analysis_model:33 - 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.775 | ERROR    | app.core.model_manager:create_face_analysis_model:33 - 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.775 | INFO     | app.core.model_manager:create_face_analysis_model:23 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:18:33.776 | ERROR    | app.core.model_manager:create_face_analysis_model:55 - 创建InsightFace模型失败: 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.776 | ERROR    | app.core.model_manager:create_face_analysis_model:55 - 创建InsightFace模型失败: 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.777 | ERROR    | app.core.model_manager:load_models:118 - 模型加载失败: 模型创建失败: 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.778 | ERROR    | app.core.model_manager:create_face_analysis_model:33 - 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:18:33.779 | ERROR    | app.core.model_manager:create_face_analysis_model:55 - 创建InsightFace模型失败: 模型下载失败: 'function' object has no attribute 'download_onnx'
2025-08-25 11:21:06.647 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 11:21:06.648 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 11:21:06.648 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 11:21:06.649 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 11:21:06.649 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 11:21:06.650 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 11:21:10.573 | INFO     | app.core.model_manager:_setup_environment:130 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 11:21:11.200 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 11:21:11.200 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 11:21:11.202 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 11:21:11.203 | INFO     | app.core.model_manager:load_models:142 - 开始加载3个模型实例到池中
2025-08-25 11:21:11.203 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:21:11.203 | INFO     | app.core.model_manager:create_face_analysis_model:24 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:21:13.744 | INFO     | app.core.model_manager:create_face_analysis_model:46 - 模型下载成功: buffalo_l
2025-08-25 11:21:13.744 | INFO     | app.core.model_manager:load_models:147 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 11:21:13.745 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:21:13.746 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:21:13.746 | INFO     | app.core.model_manager:create_face_analysis_model:24 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:21:13.747 | INFO     | app.core.model_manager:create_face_analysis_model:24 - 模型文件不存在，开始下载: buffalo_l
2025-08-25 11:21:15.118 | INFO     | app.core.model_manager:create_face_analysis_model:46 - 模型下载成功: buffalo_l
2025-08-25 11:21:15.251 | INFO     | app.core.model_manager:create_face_analysis_model:46 - 模型下载成功: buffalo_l
2025-08-25 11:21:15.252 | INFO     | app.core.model_manager:load_models:163 - 成功加载3个模型到池中
2025-08-25 11:21:15.252 | INFO     | app.core.model_manager:_startup_test:180 - 开始启动自检
2025-08-25 11:21:17.041 | INFO     | app.core.model_manager:_startup_test:191 - 自检成功：检测到1张人脸
2025-08-25 11:21:17.042 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 11:21:17.043 | INFO     | app.core.result_processor:_worker_loop:82 - 结果持久化处理器工作线程已启动
2025-08-25 11:21:17.043 | INFO     | app.core.result_processor:start:60 - ✅ 结果持久化处理器已启动
2025-08-25 11:21:17.044 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 11:21:17.044 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 11:21:17.050 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 11:21:17.053 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 11:21:17.054 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 11:21:17.054 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 11:21:17.054 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 11:21:17.054 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 11:21:50.461 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 11:21:50.461 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 11:21:50.461 | INFO     | app.core.result_processor:_worker_loop:112 - 结果持久化处理器工作线程已停止
2025-08-25 11:21:50.462 | INFO     | app.core.result_processor:stop:78 - ✅ 结果持久化处理器已停止
2025-08-25 11:21:50.462 | INFO     | app.core.model_manager:cleanup:246 - 清理模型池资源
2025-08-25 11:21:50.574 | INFO     | app.core.model_manager:cleanup:252 - 模型池已清空
2025-08-25 11:21:50.574 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 11:25:40.112 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 11:25:40.113 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 11:25:40.113 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 11:25:40.114 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 11:25:40.114 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 11:25:40.115 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 11:25:51.347 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 11:25:51.939 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 11:25:51.939 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 11:25:51.941 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 11:25:51.941 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 11:25:51.941 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:25:54.488 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 11:25:54.489 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 11:25:54.491 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:25:54.492 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 11:25:55.908 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 11:25:56.021 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 11:25:56.022 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 11:25:56.022 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 11:25:57.877 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 11:25:57.877 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 11:25:57.878 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 11:25:57.879 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 11:25:57.879 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 11:25:57.879 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 11:25:57.880 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 11:25:57.884 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 11:25:57.887 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 11:25:57.887 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 11:25:57.888 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 11:25:57.888 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 11:25:57.888 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 11:26:36.554 | INFO     | app.core.pipeline:__init__:46 - 【流水线 5daaaa8b-bc63-44ab-935d-ac01d598da4d】正在初始化...
2025-08-25 11:26:36.555 | INFO     | app.service.face_service:start_stream:196 - 🚀 视频流线程已启动: ID=5daaaa8b-bc63-44ab-935d-ac01d598da4d, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 11:26:36.562 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 11:26:36.568 | INFO     | app.core.pipeline:start:63 - 【流水线 5daaaa8b-bc63-44ab-935d-ac01d598da4d】正在启动...
2025-08-25 11:26:36.801 | INFO     | app.core.pipeline:_reader_thread:106 - 【T1:读帧 5daaaa8b-bc63-44ab-935d-ac01d598da4d】启动。
2025-08-25 11:26:36.805 | INFO     | app.core.pipeline:_preprocessor_thread:152 - 【T2:预处理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】启动。
2025-08-25 11:26:36.807 | INFO     | app.core.pipeline:_inference_thread:166 - 【T3:推理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】启动。
2025-08-25 11:26:36.817 | INFO     | app.core.pipeline:_postprocessor_thread:208 - 【T4:后处理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】启动。
2025-08-25 11:26:42.348 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 11:26:47.415 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 11:26:52.473 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 11:26:57.506 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 11:27:03.155 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 11:27:08.166 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 11:27:13.814 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:27:18.831 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:27:23.888 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 11:27:28.926 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 11:27:34.008 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 11:27:39.039 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 11:27:44.100 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 11:27:49.124 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 11:27:54.185 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 11:28:00.379 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 11:28:05.387 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:28:11.122 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 11:28:16.137 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:28:21.206 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 11:28:26.353 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:28:31.438 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:28:36.466 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 11:28:41.535 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 11:28:46.561 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 11:28:51.595 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 11:28:57.096 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 11:29:02.217 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 11:29:02.817 | INFO     | app.core.pipeline:stop:73 - 【流水线 5daaaa8b-bc63-44ab-935d-ac01d598da4d】正在停止...
2025-08-25 11:29:02.833 | INFO     | app.core.pipeline:_reader_thread:148 - 【T1:读帧 5daaaa8b-bc63-44ab-935d-ac01d598da4d】已停止。
2025-08-25 11:29:02.877 | INFO     | app.core.pipeline:_postprocessor_thread:277 - 【T4:后处理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】已停止。
2025-08-25 11:29:02.962 | INFO     | app.core.pipeline:_inference_thread:202 - 【T3:推理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】已停止。
2025-08-25 11:29:04.868 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 11:29:04.868 | INFO     | app.core.pipeline:_preprocessor_thread:162 - 【T2:预处理 5daaaa8b-bc63-44ab-935d-ac01d598da4d】已停止。
2025-08-25 11:29:04.868 | INFO     | app.core.pipeline:stop:87 - ✅【流水线 5daaaa8b-bc63-44ab-935d-ac01d598da4d】已安全停止。
2025-08-25 11:29:04.869 | INFO     | app.service.face_service:_pipeline_worker_thread:175 - ✅【线程 5daaaa8b-bc63-44ab-935d-ac01d598da4d】处理工作已结束。
2025-08-25 11:29:04.871 | INFO     | app.service.face_service:stop_stream:205 - ✅ 视频流已成功停止: ID=5daaaa8b-bc63-44ab-935d-ac01d598da4d
2025-08-25 11:29:07.926 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:07:15.358 | ERROR    | app.main:generic_exception_handler:109 - 未处理的服务器内部错误: No module named 'app.models'
Traceback (most recent call last):
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 75, in app
    response = await f(request)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\fastapi\routing.py", line 302, in app
    raw_response = await run_endpoint_function(
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\fastapi\routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
  File "D:\ABT\0-Project\face_rec\app\router\detection_router.py", line 153, in debug_weekly_trend
    from app.models.detected_results import DetectedFace
ModuleNotFoundError: No module named 'app.models'
2025-08-25 13:08:59.589 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:08:59.590 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:08:59.591 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:08:59.592 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:08:59.592 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:09:00.057 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:09:00.058 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:09:02.855 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:09:02.855 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:09:02.856 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:09:02.856 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:09:02.856 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:09:02.857 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:09:09.620 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:09:10.434 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:09:10.434 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:09:10.437 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:09:10.437 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:09:10.437 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:09:12.371 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:09:12.372 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:09:12.374 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:09:12.375 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:09:14.181 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:09:14.181 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:09:14.182 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:09:14.183 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:09:16.125 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:09:16.125 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:09:16.126 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:09:16.127 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:09:16.127 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:09:16.127 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:09:16.127 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:09:16.131 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:09:16.136 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:09:16.136 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:09:16.136 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:09:16.137 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:09:16.137 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:20:13.666 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:20:13.666 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:20:13.667 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:20:13.667 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:20:13.667 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:20:13.785 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:20:13.785 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:20:15.491 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:20:15.491 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:20:15.491 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:20:15.493 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:20:15.493 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:20:15.493 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:20:21.423 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:20:22.011 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:20:22.011 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:20:22.013 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:20:22.013 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:20:22.014 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:20:23.491 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:20:23.491 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:20:23.493 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:20:23.493 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:20:24.988 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:20:24.988 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:20:24.989 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:20:24.990 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:20:27.089 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:20:27.090 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:20:27.090 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:20:27.091 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:20:27.091 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:20:27.092 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:20:27.092 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:20:27.097 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:20:27.100 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:20:27.101 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:20:27.101 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:20:27.102 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:20:27.102 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:30:28.580 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:30:28.581 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:30:28.581 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:30:28.582 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:30:28.582 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:30:28.697 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:30:28.697 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:30:31.648 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:30:31.648 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:30:31.649 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:30:31.649 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:30:31.650 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:30:31.651 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:30:36.287 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:30:36.869 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:30:36.870 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:30:36.872 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:30:36.872 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:30:36.872 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:30:38.490 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:30:38.490 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:30:38.492 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:30:38.493 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:30:39.876 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:30:39.877 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:30:39.878 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:30:39.878 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:30:41.793 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:30:41.794 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:30:41.794 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:30:41.796 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:30:41.797 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:30:41.798 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:30:41.798 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:30:41.803 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:30:41.808 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:30:41.809 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:30:41.809 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:30:41.810 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:30:41.810 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:33:09.769 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'sn001' 的记录。
2025-08-25 13:33:36.232 | INFO     | app.service.face_dao:create:74 - 成功向 LanceDB 添加记录: SN=sn002, Name=pang
2025-08-25 13:36:31.310 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:36:31.311 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:36:31.311 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:36:31.312 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:36:31.312 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:36:31.474 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:36:31.475 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:36:39.795 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:36:39.796 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:36:39.797 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:36:39.797 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:36:39.798 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:36:39.798 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:36:44.121 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:36:44.729 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:36:44.729 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:36:44.731 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:36:44.731 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:36:44.732 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:36:47.275 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:36:47.276 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:36:47.277 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:36:47.278 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:36:48.681 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:36:48.682 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:36:48.682 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:36:48.683 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:36:50.587 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:36:50.587 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:36:50.588 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:36:50.589 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:36:50.589 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:36:50.590 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:36:50.590 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:36:50.595 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:36:50.598 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:36:50.599 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:36:50.599 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:36:50.599 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:36:50.600 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:38:30.049 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:38:30.050 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:38:30.051 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:38:30.051 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:38:30.052 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:38:30.200 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:38:30.200 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:39:41.055 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:39:41.056 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:39:41.057 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:39:41.057 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:39:41.058 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:39:41.058 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:39:48.095 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:39:48.682 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:39:48.683 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:39:48.684 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:39:48.684 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:39:48.685 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:39:51.231 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:39:51.232 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:39:51.233 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:39:51.233 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:39:52.785 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:39:52.786 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:39:52.787 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:39:52.787 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:39:54.679 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:39:54.680 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:39:54.680 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:39:54.682 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:39:54.682 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:39:54.683 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:39:54.683 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:39:54.686 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:39:54.690 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:39:54.690 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:39:54.691 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:39:54.691 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:39:54.691 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:39:55.689 | WARNING  | app.service.face_service:register_face:71 - 使用默认阈值未检测到人脸，尝试使用更宽松的阈值重新检测
2025-08-25 13:39:57.092 | INFO     | app.service.face_service:register_face:96 - 注册人脸检测成功: 姓名=pang, SN=sn002, 置信度=0.465
2025-08-25 13:39:57.107 | INFO     | app.service.face_dao:create:74 - 成功向 LanceDB 添加记录: SN=sn002, Name=pang
2025-08-25 13:40:31.287 | INFO     | app.core.pipeline:__init__:46 - 【流水线 978c9281-83f8-409e-a3e1-fb7269fa7a66】正在初始化...
2025-08-25 13:40:31.287 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=978c9281-83f8-409e-a3e1-fb7269fa7a66, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 13:40:31.294 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:40:31.301 | INFO     | app.core.pipeline:start:63 - 【流水线 978c9281-83f8-409e-a3e1-fb7269fa7a66】正在启动...
2025-08-25 13:40:31.469 | INFO     | app.core.pipeline:_reader_thread:106 - 【T1:读帧 978c9281-83f8-409e-a3e1-fb7269fa7a66】启动。
2025-08-25 13:40:31.469 | INFO     | app.core.pipeline:_preprocessor_thread:152 - 【T2:预处理 978c9281-83f8-409e-a3e1-fb7269fa7a66】启动。
2025-08-25 13:40:31.470 | INFO     | app.core.pipeline:_inference_thread:166 - 【T3:推理 978c9281-83f8-409e-a3e1-fb7269fa7a66】启动。
2025-08-25 13:40:31.473 | INFO     | app.core.pipeline:_postprocessor_thread:208 - 【T4:后处理 978c9281-83f8-409e-a3e1-fb7269fa7a66】启动。
2025-08-25 13:40:35.045 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:40:35.045 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:40:38.112 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 13:40:38.113 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 13:40:41.152 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 13:40:41.154 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 13:40:44.166 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 7 条检测结果
2025-08-25 13:40:44.167 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 13:40:47.217 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 13:40:47.217 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 13:40:50.237 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 13:40:50.238 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 13:40:53.249 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 9 条检测结果
2025-08-25 13:40:53.250 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 9 条检测结果
2025-08-25 13:40:56.275 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 9 条检测结果
2025-08-25 13:40:56.276 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 9 条检测结果
2025-08-25 13:40:59.324 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 13:40:59.325 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 13:41:02.360 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 13:41:02.360 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 13:41:05.441 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 9 条检测结果
2025-08-25 13:41:05.442 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 9 条检测结果
2025-08-25 13:41:07.767 | INFO     | app.core.pipeline:stop:73 - 【流水线 978c9281-83f8-409e-a3e1-fb7269fa7a66】正在停止...
2025-08-25 13:41:07.778 | INFO     | app.core.pipeline:_inference_thread:202 - 【T3:推理 978c9281-83f8-409e-a3e1-fb7269fa7a66】已停止。
2025-08-25 13:41:07.799 | INFO     | app.core.pipeline:_reader_thread:148 - 【T1:读帧 978c9281-83f8-409e-a3e1-fb7269fa7a66】已停止。
2025-08-25 13:41:07.800 | INFO     | app.core.pipeline:_postprocessor_thread:277 - 【T4:后处理 978c9281-83f8-409e-a3e1-fb7269fa7a66】已停止。
2025-08-25 13:41:08.800 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:41:08.801 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:41:09.829 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:41:09.830 | INFO     | app.core.pipeline:stop:87 - ✅【流水线 978c9281-83f8-409e-a3e1-fb7269fa7a66】已安全停止。
2025-08-25 13:41:09.830 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 978c9281-83f8-409e-a3e1-fb7269fa7a66】处理工作已结束。
2025-08-25 13:41:09.832 | INFO     | app.core.pipeline:_preprocessor_thread:162 - 【T2:预处理 978c9281-83f8-409e-a3e1-fb7269fa7a66】已停止。
2025-08-25 13:41:09.833 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=978c9281-83f8-409e-a3e1-fb7269fa7a66
2025-08-25 13:43:01.297 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:43:01.297 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:43:01.298 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:43:01.298 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:43:01.298 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:43:01.527 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:43:01.527 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:44:04.818 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:44:04.819 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:44:04.819 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:44:04.820 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:44:04.821 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:44:04.821 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:44:08.013 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:44:08.715 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:44:08.716 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:44:08.718 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:44:08.718 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:44:08.718 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:44:11.388 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:44:11.389 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:44:11.391 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:44:11.392 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:44:13.242 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:44:13.243 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:44:13.244 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:44:13.244 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:44:15.328 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:44:15.329 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:44:15.330 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:44:15.331 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:44:15.332 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:44:15.332 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:44:15.332 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:44:15.341 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:44:15.345 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:44:15.345 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:44:15.346 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:44:15.346 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:44:15.347 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:44:31.967 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 13:44:31.997 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 2 条 SN 为 'sn002' 的记录。
2025-08-25 13:44:32.038 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn002, 新数据={'name': '胖'}, 影响记录数=2
2025-08-25 13:44:37.144 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 13:44:37.180 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 3 条 SN 为 'sn003' 的记录。
2025-08-25 13:44:37.214 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn003, 新数据={'name': '红'}, 影响记录数=3
2025-08-25 13:44:42.724 | INFO     | app.core.pipeline:__init__:117 - 【流水线 57f54e26-80b1-445f-8c5f-90b5fc246bfb】正在初始化...
2025-08-25 13:44:42.725 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=57f54e26-80b1-445f-8c5f-90b5fc246bfb, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 13:44:42.732 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:44:42.742 | INFO     | app.core.pipeline:start:134 - 【流水线 57f54e26-80b1-445f-8c5f-90b5fc246bfb】正在启动...
2025-08-25 13:44:42.898 | INFO     | app.core.pipeline:_reader_thread:177 - 【T1:读帧 57f54e26-80b1-445f-8c5f-90b5fc246bfb】启动。
2025-08-25 13:44:42.899 | INFO     | app.core.pipeline:_preprocessor_thread:223 - 【T2:预处理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】启动。
2025-08-25 13:44:42.951 | INFO     | app.core.pipeline:_inference_thread:237 - 【T3:推理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】启动。
2025-08-25 13:44:42.983 | INFO     | app.core.pipeline:_postprocessor_thread:279 - 【T4:后处理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】启动。
2025-08-25 13:44:48.076 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:44:48.080 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:44:51.170 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:44:51.170 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:44:54.213 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:44:54.213 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:44:55.137 | INFO     | app.core.pipeline:stop:144 - 【流水线 57f54e26-80b1-445f-8c5f-90b5fc246bfb】正在停止...
2025-08-25 13:44:55.153 | INFO     | app.core.pipeline:_reader_thread:219 - 【T1:读帧 57f54e26-80b1-445f-8c5f-90b5fc246bfb】已停止。
2025-08-25 13:44:55.190 | INFO     | app.core.pipeline:_postprocessor_thread:348 - 【T4:后处理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】已停止。
2025-08-25 13:44:55.202 | INFO     | app.core.pipeline:_inference_thread:273 - 【T3:推理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】已停止。
2025-08-25 13:44:57.191 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:44:57.191 | INFO     | app.core.pipeline:_preprocessor_thread:233 - 【T2:预处理 57f54e26-80b1-445f-8c5f-90b5fc246bfb】已停止。
2025-08-25 13:44:57.192 | INFO     | app.core.pipeline:stop:158 - ✅【流水线 57f54e26-80b1-445f-8c5f-90b5fc246bfb】已安全停止。
2025-08-25 13:44:57.193 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 57f54e26-80b1-445f-8c5f-90b5fc246bfb】处理工作已结束。
2025-08-25 13:44:57.197 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=57f54e26-80b1-445f-8c5f-90b5fc246bfb
2025-08-25 13:44:58.208 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:44:58.209 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:53:01.065 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:53:01.066 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:53:01.066 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:53:01.066 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:53:01.067 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:53:01.245 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:53:01.245 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:53:03.559 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:53:03.560 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:53:03.561 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:53:03.562 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:53:03.562 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:53:03.562 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:53:09.688 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:53:10.522 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:53:10.522 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:53:10.525 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:53:10.525 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:53:10.525 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:53:12.080 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:53:12.080 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:53:12.082 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:53:12.082 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:53:13.672 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:53:13.672 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:53:13.673 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:53:13.674 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:53:15.781 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:53:15.782 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:53:15.782 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:53:15.783 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:53:15.783 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:53:15.784 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:53:15.784 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:53:15.789 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:53:15.792 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:53:15.792 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:53:15.792 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:53:15.793 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:53:15.793 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:53:18.986 | INFO     | app.core.pipeline:__init__:123 - 【流水线 75713176-8f7b-4703-a110-33e0e2089b7a】正在初始化...
2025-08-25 13:53:18.986 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=75713176-8f7b-4703-a110-33e0e2089b7a, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 13:53:18.991 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:53:18.995 | INFO     | app.core.pipeline:start:140 - 【流水线 75713176-8f7b-4703-a110-33e0e2089b7a】正在启动...
2025-08-25 13:53:19.197 | INFO     | app.core.pipeline:_reader_thread:183 - 【T1:读帧 75713176-8f7b-4703-a110-33e0e2089b7a】启动。
2025-08-25 13:53:19.202 | INFO     | app.core.pipeline:_preprocessor_thread:229 - 【T2:预处理 75713176-8f7b-4703-a110-33e0e2089b7a】启动。
2025-08-25 13:53:19.204 | INFO     | app.core.pipeline:_inference_thread:243 - 【T3:推理 75713176-8f7b-4703-a110-33e0e2089b7a】启动。
2025-08-25 13:53:19.205 | INFO     | app.core.pipeline:_postprocessor_thread:285 - 【T4:后处理 75713176-8f7b-4703-a110-33e0e2089b7a】启动。
2025-08-25 13:53:21.426 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:53:21.427 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:53:24.471 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 13:53:24.471 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 13:53:27.486 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:53:27.487 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:53:30.527 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 13:53:30.528 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 13:53:33.553 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:53:33.554 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:53:35.388 | INFO     | app.core.pipeline:stop:150 - 【流水线 75713176-8f7b-4703-a110-33e0e2089b7a】正在停止...
2025-08-25 13:53:35.389 | INFO     | app.core.pipeline:_reader_thread:225 - 【T1:读帧 75713176-8f7b-4703-a110-33e0e2089b7a】已停止。
2025-08-25 13:53:35.390 | INFO     | app.core.pipeline:_postprocessor_thread:354 - 【T4:后处理 75713176-8f7b-4703-a110-33e0e2089b7a】已停止。
2025-08-25 13:53:35.397 | INFO     | app.core.pipeline:_inference_thread:279 - 【T3:推理 75713176-8f7b-4703-a110-33e0e2089b7a】已停止。
2025-08-25 13:53:37.211 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 13:53:37.213 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 13:53:37.412 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:53:37.412 | INFO     | app.core.pipeline:_preprocessor_thread:239 - 【T2:预处理 75713176-8f7b-4703-a110-33e0e2089b7a】已停止。
2025-08-25 13:53:37.413 | INFO     | app.core.pipeline:stop:164 - ✅【流水线 75713176-8f7b-4703-a110-33e0e2089b7a】已安全停止。
2025-08-25 13:53:37.413 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 75713176-8f7b-4703-a110-33e0e2089b7a】处理工作已结束。
2025-08-25 13:53:37.415 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=75713176-8f7b-4703-a110-33e0e2089b7a
2025-08-25 13:54:19.335 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:54:19.336 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:54:19.336 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:54:19.337 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:54:19.337 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:54:19.514 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:54:19.514 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 13:55:49.590 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 13:55:49.591 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 13:55:49.592 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 13:55:49.592 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 13:55:49.593 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 13:55:49.593 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 13:55:54.080 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 13:55:54.672 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 13:55:54.672 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 13:55:54.675 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 13:55:54.675 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 13:55:54.675 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:55:57.199 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:55:57.199 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 13:55:57.200 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:55:57.201 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 13:55:58.463 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:55:58.595 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 13:55:58.595 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 13:55:58.596 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 13:56:00.481 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 13:56:00.482 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 13:56:00.482 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 13:56:00.483 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 13:56:00.483 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 13:56:00.484 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 13:56:00.484 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 13:56:00.489 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:56:00.491 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 13:56:00.492 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 13:56:00.492 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 13:56:00.492 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 13:56:00.492 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 13:56:02.657 | INFO     | app.core.pipeline:__init__:162 - 【流水线 768d03c8-fc9e-42e8-85a4-014aa503cd8c】正在初始化...
2025-08-25 13:56:02.657 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=768d03c8-fc9e-42e8-85a4-014aa503cd8c, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 13:56:02.662 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:56:02.665 | INFO     | app.core.pipeline:start:179 - 【流水线 768d03c8-fc9e-42e8-85a4-014aa503cd8c】正在启动...
2025-08-25 13:56:02.851 | INFO     | app.core.pipeline:_reader_thread:222 - 【T1:读帧 768d03c8-fc9e-42e8-85a4-014aa503cd8c】启动。
2025-08-25 13:56:02.852 | INFO     | app.core.pipeline:_preprocessor_thread:268 - 【T2:预处理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】启动。
2025-08-25 13:56:02.853 | INFO     | app.core.pipeline:_inference_thread:282 - 【T3:推理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】启动。
2025-08-25 13:56:02.854 | INFO     | app.core.pipeline:_postprocessor_thread:324 - 【T4:后处理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】启动。
2025-08-25 13:56:05.261 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:56:05.261 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:56:08.274 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 13:56:08.276 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 13:56:11.309 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 13:56:11.309 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 13:56:14.328 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 13:56:14.328 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 13:56:17.338 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 13:56:17.341 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 13:56:19.992 | INFO     | app.core.pipeline:stop:189 - 【流水线 768d03c8-fc9e-42e8-85a4-014aa503cd8c】正在停止...
2025-08-25 13:56:19.999 | INFO     | app.core.pipeline:_inference_thread:318 - 【T3:推理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】已停止。
2025-08-25 13:56:20.009 | INFO     | app.core.pipeline:_reader_thread:264 - 【T1:读帧 768d03c8-fc9e-42e8-85a4-014aa503cd8c】已停止。
2025-08-25 13:56:20.044 | INFO     | app.core.pipeline:_postprocessor_thread:393 - 【T4:后处理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】已停止。
2025-08-25 13:56:21.033 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 13:56:21.034 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 13:56:22.034 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:56:22.034 | INFO     | app.core.pipeline:_preprocessor_thread:278 - 【T2:预处理 768d03c8-fc9e-42e8-85a4-014aa503cd8c】已停止。
2025-08-25 13:56:22.035 | INFO     | app.core.pipeline:stop:203 - ✅【流水线 768d03c8-fc9e-42e8-85a4-014aa503cd8c】已安全停止。
2025-08-25 13:56:22.037 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 768d03c8-fc9e-42e8-85a4-014aa503cd8c】处理工作已结束。
2025-08-25 13:56:22.039 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=768d03c8-fc9e-42e8-85a4-014aa503cd8c
2025-08-25 13:56:27.939 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 13:56:27.969 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 3 条 SN 为 'sn003' 的记录。
2025-08-25 13:56:28.010 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn003, 新数据={'name': 'hong'}, 影响记录数=3
2025-08-25 13:56:33.267 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 13:56:33.296 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 2 条 SN 为 'sn002' 的记录。
2025-08-25 13:56:33.327 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn002, 新数据={'name': 'pang'}, 影响记录数=2
2025-08-25 13:56:35.082 | ERROR    | app.main:generic_exception_handler:109 - 未处理的服务器内部错误: Caught handled exception, but response already started.
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_utils.py", line 77, in collapse_excgroups
  |     yield
  |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 271, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 76, in app
    |     await response(scope, receive, send)
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 270, in __call__
    |     with collapse_excgroups():
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 153, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_utils.py", line 83, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 274, in wrap
    |     await func()
    |   File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 254, in stream_response
    |     async for chunk in self.body_iterator:
    |   File "D:\ABT\0-Project\face_rec\app\service\face_service.py", line 233, in get_stream_feed
    |     if stream_id not in self.active_streams: raise HTTPException(status_code=404, detail="Stream not found.")
    | fastapi.exceptions.HTTPException: 404: Stream not found.
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 76, in app
    await response(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 270, in __call__
    with collapse_excgroups():
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_utils.py", line 83, in collapse_excgroups
    raise exc
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 274, in wrap
    await func()
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\responses.py", line 254, in stream_response
    async for chunk in self.body_iterator:
  File "D:\ABT\0-Project\face_rec\app\service\face_service.py", line 233, in get_stream_feed
    if stream_id not in self.active_streams: raise HTTPException(status_code=404, detail="Stream not found.")
fastapi.exceptions.HTTPException: 404: Stream not found.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\31425\AppData\Local\Programs\Python\Python310\lib\site-packages\starlette\_exception_handler.py", line 56, in wrapped_app
    raise RuntimeError("Caught handled exception, but response already started.") from exc
RuntimeError: Caught handled exception, but response already started.
2025-08-25 13:56:35.640 | INFO     | app.core.pipeline:__init__:162 - 【流水线 aa223280-0a63-4363-9a2d-b3525d2b7c8d】正在初始化...
2025-08-25 13:56:35.641 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=aa223280-0a63-4363-9a2d-b3525d2b7c8d, Source=0
2025-08-25 13:56:35.647 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:56:35.653 | INFO     | app.core.pipeline:start:179 - 【流水线 aa223280-0a63-4363-9a2d-b3525d2b7c8d】正在启动...
2025-08-25 13:56:39.502 | INFO     | app.core.pipeline:_reader_thread:222 - 【T1:读帧 aa223280-0a63-4363-9a2d-b3525d2b7c8d】启动。
2025-08-25 13:56:39.502 | INFO     | app.core.pipeline:_preprocessor_thread:268 - 【T2:预处理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】启动。
2025-08-25 13:56:39.503 | INFO     | app.core.pipeline:_inference_thread:282 - 【T3:推理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】启动。
2025-08-25 13:56:39.504 | INFO     | app.core.pipeline:_postprocessor_thread:324 - 【T4:后处理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】启动。
2025-08-25 13:56:54.604 | INFO     | app.core.pipeline:stop:189 - 【流水线 aa223280-0a63-4363-9a2d-b3525d2b7c8d】正在停止...
2025-08-25 13:56:54.608 | INFO     | app.core.pipeline:_postprocessor_thread:393 - 【T4:后处理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】已停止。
2025-08-25 13:56:54.651 | INFO     | app.core.pipeline:_reader_thread:264 - 【T1:读帧 aa223280-0a63-4363-9a2d-b3525d2b7c8d】已停止。
2025-08-25 13:56:54.654 | INFO     | app.core.pipeline:_inference_thread:318 - 【T3:推理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】已停止。
2025-08-25 13:56:56.984 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:56:56.985 | INFO     | app.core.pipeline:_preprocessor_thread:278 - 【T2:预处理 aa223280-0a63-4363-9a2d-b3525d2b7c8d】已停止。
2025-08-25 13:56:56.986 | INFO     | app.core.pipeline:stop:203 - ✅【流水线 aa223280-0a63-4363-9a2d-b3525d2b7c8d】已安全停止。
2025-08-25 13:56:56.987 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 aa223280-0a63-4363-9a2d-b3525d2b7c8d】处理工作已结束。
2025-08-25 13:56:56.987 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=aa223280-0a63-4363-9a2d-b3525d2b7c8d
2025-08-25 13:57:05.010 | INFO     | app.core.pipeline:__init__:162 - 【流水线 f784b1b9-c832-442e-b41a-f318f0f26de1】正在初始化...
2025-08-25 13:57:05.010 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=f784b1b9-c832-442e-b41a-f318f0f26de1, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 13:57:05.016 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 13:57:05.023 | INFO     | app.core.pipeline:start:179 - 【流水线 f784b1b9-c832-442e-b41a-f318f0f26de1】正在启动...
2025-08-25 13:57:05.287 | INFO     | app.core.pipeline:_reader_thread:222 - 【T1:读帧 f784b1b9-c832-442e-b41a-f318f0f26de1】启动。
2025-08-25 13:57:05.288 | INFO     | app.core.pipeline:_preprocessor_thread:268 - 【T2:预处理 f784b1b9-c832-442e-b41a-f318f0f26de1】启动。
2025-08-25 13:57:05.289 | INFO     | app.core.pipeline:_inference_thread:282 - 【T3:推理 f784b1b9-c832-442e-b41a-f318f0f26de1】启动。
2025-08-25 13:57:05.291 | INFO     | app.core.pipeline:_postprocessor_thread:324 - 【T4:后处理 f784b1b9-c832-442e-b41a-f318f0f26de1】启动。
2025-08-25 13:57:06.052 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 13:57:06.057 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 13:57:09.074 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 13:57:09.074 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 13:57:11.350 | INFO     | app.core.pipeline:stop:189 - 【流水线 f784b1b9-c832-442e-b41a-f318f0f26de1】正在停止...
2025-08-25 13:57:11.353 | INFO     | app.core.pipeline:_postprocessor_thread:393 - 【T4:后处理 f784b1b9-c832-442e-b41a-f318f0f26de1】已停止。
2025-08-25 13:57:11.363 | INFO     | app.core.pipeline:_inference_thread:318 - 【T3:推理 f784b1b9-c832-442e-b41a-f318f0f26de1】已停止。
2025-08-25 13:57:11.380 | INFO     | app.core.pipeline:_reader_thread:264 - 【T1:读帧 f784b1b9-c832-442e-b41a-f318f0f26de1】已停止。
2025-08-25 13:57:12.379 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 13:57:12.380 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 13:57:13.411 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 13:57:13.411 | INFO     | app.core.pipeline:_preprocessor_thread:278 - 【T2:预处理 f784b1b9-c832-442e-b41a-f318f0f26de1】已停止。
2025-08-25 13:57:13.412 | INFO     | app.core.pipeline:stop:203 - ✅【流水线 f784b1b9-c832-442e-b41a-f318f0f26de1】已安全停止。
2025-08-25 13:57:13.414 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 f784b1b9-c832-442e-b41a-f318f0f26de1】处理工作已结束。
2025-08-25 13:57:13.419 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=f784b1b9-c832-442e-b41a-f318f0f26de1
2025-08-25 13:58:40.266 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 13:58:40.267 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 13:58:40.268 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 13:58:40.269 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 13:58:40.269 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 13:58:40.517 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 13:58:40.518 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:01:52.455 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:01:52.456 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:01:52.456 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:01:52.457 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:01:52.457 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:01:52.458 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:01:56.115 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:01:56.740 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:01:56.740 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:01:56.742 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:01:56.742 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:01:56.742 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:01:59.327 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:01:59.328 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:01:59.329 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:01:59.329 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:02:00.615 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:02:00.731 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:02:00.731 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:02:00.732 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:02:02.625 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:02:02.626 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:02:02.626 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:02:02.627 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:02:02.627 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:02:02.628 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:02:02.628 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:02:02.633 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:02:02.635 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:02:02.636 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:02:02.636 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:02:02.636 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:02:02.636 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:02:05.067 | INFO     | app.core.pipeline:__init__:136 - 【流水线 3af4746f-3960-478e-85fe-ff06fe150429】正在初始化...
2025-08-25 14:02:05.067 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=3af4746f-3960-478e-85fe-ff06fe150429, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:02:05.072 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:02:05.075 | INFO     | app.core.pipeline:start:153 - 【流水线 3af4746f-3960-478e-85fe-ff06fe150429】正在启动...
2025-08-25 14:02:05.221 | INFO     | app.core.pipeline:_reader_thread:196 - 【T1:读帧 3af4746f-3960-478e-85fe-ff06fe150429】启动。
2025-08-25 14:02:05.225 | INFO     | app.core.pipeline:_preprocessor_thread:242 - 【T2:预处理 3af4746f-3960-478e-85fe-ff06fe150429】启动。
2025-08-25 14:02:05.227 | INFO     | app.core.pipeline:_inference_thread:256 - 【T3:推理 3af4746f-3960-478e-85fe-ff06fe150429】启动。
2025-08-25 14:02:05.228 | INFO     | app.core.pipeline:_postprocessor_thread:298 - 【T4:后处理 3af4746f-3960-478e-85fe-ff06fe150429】启动。
2025-08-25 14:02:07.388 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1009), np.int64(-3)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:07.466 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1013), np.int64(-5)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:07.747 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:02:07.747 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:02:10.787 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:02:10.788 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:02:11.112 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1221), np.int64(-1)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.175 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1253), np.int64(-35)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.235 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1255), np.int64(-45)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.293 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1265), np.int64(-61)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.356 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1272), np.int64(-73)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.461 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1282), np.int64(-103)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.496 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1301), np.int64(-129)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.569 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1308), np.int64(-136)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.629 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1312), np.int64(-154)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.686 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1319), np.int64(-161)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.749 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1325), np.int64(-162)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.825 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1343), np.int64(-158)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.896 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1369), np.int64(-137)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:11.955 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1384), np.int64(-117)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.025 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1393), np.int64(-112)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.094 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1405), np.int64(-116)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.179 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1412), np.int64(-112)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.262 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1422), np.int64(-105)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.331 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1441), np.int64(-104)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.399 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1449), np.int64(-109)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.463 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1452), np.int64(-103)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.541 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1461), np.int64(-98)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.610 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1477), np.int64(-93)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.693 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1484), np.int64(-100)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:12.741 | WARNING  | app.core.pipeline:_draw_chinese_text_on_frame:40 - 文本位置超出图像范围: (np.int64(1487), np.int64(-94)), 图像尺寸: (1080, 1920, 3)
2025-08-25 14:02:13.828 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 9 条检测结果
2025-08-25 14:02:13.829 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 9 条检测结果
2025-08-25 14:02:14.301 | INFO     | app.core.pipeline:stop:163 - 【流水线 3af4746f-3960-478e-85fe-ff06fe150429】正在停止...
2025-08-25 14:02:14.329 | INFO     | app.core.pipeline:_postprocessor_thread:367 - 【T4:后处理 3af4746f-3960-478e-85fe-ff06fe150429】已停止。
2025-08-25 14:02:14.332 | INFO     | app.core.pipeline:_reader_thread:238 - 【T1:读帧 3af4746f-3960-478e-85fe-ff06fe150429】已停止。
2025-08-25 14:02:14.347 | INFO     | app.core.pipeline:_inference_thread:292 - 【T3:推理 3af4746f-3960-478e-85fe-ff06fe150429】已停止。
2025-08-25 14:02:16.352 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:02:16.352 | INFO     | app.core.pipeline:_preprocessor_thread:252 - 【T2:预处理 3af4746f-3960-478e-85fe-ff06fe150429】已停止。
2025-08-25 14:02:16.353 | INFO     | app.core.pipeline:stop:177 - ✅【流水线 3af4746f-3960-478e-85fe-ff06fe150429】已安全停止。
2025-08-25 14:02:16.354 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 3af4746f-3960-478e-85fe-ff06fe150429】处理工作已结束。
2025-08-25 14:02:16.355 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=3af4746f-3960-478e-85fe-ff06fe150429
2025-08-25 14:02:17.313 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 14:02:17.313 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 14:04:20.928 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:04:20.928 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:04:20.929 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:04:20.929 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:04:20.929 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:04:21.079 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:04:21.079 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:04:22.800 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:04:22.800 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:04:22.801 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:04:22.802 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:04:22.802 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:04:22.802 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:04:30.405 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:04:31.036 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:04:31.036 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:04:31.039 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:04:31.039 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:04:31.039 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:04:32.545 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:04:32.545 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:04:32.546 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:04:32.547 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:04:33.904 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:04:34.031 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:04:34.032 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:04:34.033 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:04:35.915 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:04:35.915 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:04:35.916 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:04:35.917 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:04:35.917 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:04:35.917 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:04:35.918 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:04:35.922 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:04:35.925 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:04:35.925 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:04:35.925 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:04:35.925 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:04:35.925 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:04:37.623 | INFO     | app.core.pipeline:__init__:146 - 【流水线 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】正在初始化...
2025-08-25 14:04:37.624 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=28bd49fc-5c0c-4e62-a0fd-d61c833ab53e, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:04:37.628 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:04:37.633 | INFO     | app.core.pipeline:start:163 - 【流水线 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】正在启动...
2025-08-25 14:04:37.787 | INFO     | app.core.pipeline:_reader_thread:206 - 【T1:读帧 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】启动。
2025-08-25 14:04:37.789 | INFO     | app.core.pipeline:_preprocessor_thread:252 - 【T2:预处理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】启动。
2025-08-25 14:04:37.791 | INFO     | app.core.pipeline:_inference_thread:266 - 【T3:推理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】启动。
2025-08-25 14:04:37.793 | INFO     | app.core.pipeline:_postprocessor_thread:308 - 【T4:后处理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】启动。
2025-08-25 14:04:40.006 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:04:40.007 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:04:43.033 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:04:43.034 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:04:46.100 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:04:46.101 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:04:49.109 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:04:49.110 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:04:52.146 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 14:04:52.147 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 14:04:55.181 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:04:55.183 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:04:57.954 | INFO     | app.core.pipeline:stop:173 - 【流水线 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】正在停止...
2025-08-25 14:04:57.969 | INFO     | app.core.pipeline:_reader_thread:248 - 【T1:读帧 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】已停止。
2025-08-25 14:04:58.023 | INFO     | app.core.pipeline:_postprocessor_thread:377 - 【T4:后处理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】已停止。
2025-08-25 14:04:58.035 | INFO     | app.core.pipeline:_inference_thread:302 - 【T3:推理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】已停止。
2025-08-25 14:04:58.976 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:04:58.976 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:04:59.991 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:04:59.991 | INFO     | app.core.pipeline:_preprocessor_thread:262 - 【T2:预处理 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】已停止。
2025-08-25 14:04:59.991 | INFO     | app.core.pipeline:stop:187 - ✅【流水线 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】已安全停止。
2025-08-25 14:04:59.992 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 28bd49fc-5c0c-4e62-a0fd-d61c833ab53e】处理工作已结束。
2025-08-25 14:04:59.992 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=28bd49fc-5c0c-4e62-a0fd-d61c833ab53e
2025-08-25 14:05:02.184 | INFO     | app.core.pipeline:__init__:146 - 【流水线 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】正在初始化...
2025-08-25 14:05:02.185 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9, Source=0
2025-08-25 14:05:02.191 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:05:02.196 | INFO     | app.core.pipeline:start:163 - 【流水线 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】正在启动...
2025-08-25 14:05:05.760 | INFO     | app.core.pipeline:_reader_thread:206 - 【T1:读帧 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】启动。
2025-08-25 14:05:05.761 | INFO     | app.core.pipeline:_preprocessor_thread:252 - 【T2:预处理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】启动。
2025-08-25 14:05:05.762 | INFO     | app.core.pipeline:_inference_thread:266 - 【T3:推理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】启动。
2025-08-25 14:05:05.763 | INFO     | app.core.pipeline:_postprocessor_thread:308 - 【T4:后处理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】启动。
2025-08-25 14:05:27.918 | INFO     | app.core.pipeline:stop:173 - 【流水线 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】正在停止...
2025-08-25 14:05:27.921 | INFO     | app.core.pipeline:_inference_thread:302 - 【T3:推理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】已停止。
2025-08-25 14:05:27.949 | INFO     | app.core.pipeline:_reader_thread:248 - 【T1:读帧 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】已停止。
2025-08-25 14:05:27.956 | INFO     | app.core.pipeline:_postprocessor_thread:377 - 【T4:后处理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】已停止。
2025-08-25 14:05:30.250 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:05:30.251 | INFO     | app.core.pipeline:_preprocessor_thread:262 - 【T2:预处理 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】已停止。
2025-08-25 14:05:30.252 | INFO     | app.core.pipeline:stop:187 - ✅【流水线 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】已安全停止。
2025-08-25 14:05:30.253 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9】处理工作已结束。
2025-08-25 14:05:30.254 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=572d1ab0-9ea4-45bd-9817-d2ba5cd8eba9
2025-08-25 14:08:31.449 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:08:31.451 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:08:31.451 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:08:31.452 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:08:31.452 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:08:31.678 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:08:31.679 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:08:33.367 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:08:33.367 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:08:33.368 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:08:33.368 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:08:33.368 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:08:33.369 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:08:39.147 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:08:39.830 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:08:39.830 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:08:39.832 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:08:39.832 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:08:39.833 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:08:41.508 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:08:41.508 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:08:41.510 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:08:41.510 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:08:43.164 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:08:43.165 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:08:43.167 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:08:43.168 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:08:46.673 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:08:46.674 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:08:46.675 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:08:46.676 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:08:46.676 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:08:46.677 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:08:46.677 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:08:46.688 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:08:46.692 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:08:46.692 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:08:46.692 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:08:46.693 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:08:46.693 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:08:47.058 | INFO     | app.core.pipeline:__init__:108 - 【流水线 13139586-d6d7-4696-bfd7-cab1860a9287】正在初始化...
2025-08-25 14:08:47.058 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=13139586-d6d7-4696-bfd7-cab1860a9287, Source=0
2025-08-25 14:08:47.063 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:08:47.069 | INFO     | app.core.pipeline:start:125 - 【流水线 13139586-d6d7-4696-bfd7-cab1860a9287】正在启动...
2025-08-25 14:08:50.030 | INFO     | app.core.pipeline:_reader_thread:168 - 【T1:读帧 13139586-d6d7-4696-bfd7-cab1860a9287】启动。
2025-08-25 14:08:50.030 | INFO     | app.core.pipeline:_preprocessor_thread:214 - 【T2:预处理 13139586-d6d7-4696-bfd7-cab1860a9287】启动。
2025-08-25 14:08:50.031 | INFO     | app.core.pipeline:_inference_thread:228 - 【T3:推理 13139586-d6d7-4696-bfd7-cab1860a9287】启动。
2025-08-25 14:08:50.031 | INFO     | app.core.pipeline:_postprocessor_thread:270 - 【T4:后处理 13139586-d6d7-4696-bfd7-cab1860a9287】启动。
2025-08-25 14:09:07.135 | INFO     | app.core.pipeline:stop:135 - 【流水线 13139586-d6d7-4696-bfd7-cab1860a9287】正在停止...
2025-08-25 14:09:07.146 | INFO     | app.core.pipeline:_inference_thread:264 - 【T3:推理 13139586-d6d7-4696-bfd7-cab1860a9287】已停止。
2025-08-25 14:09:07.151 | INFO     | app.core.pipeline:_reader_thread:210 - 【T1:读帧 13139586-d6d7-4696-bfd7-cab1860a9287】已停止。
2025-08-25 14:09:07.162 | INFO     | app.core.pipeline:_postprocessor_thread:339 - 【T4:后处理 13139586-d6d7-4696-bfd7-cab1860a9287】已停止。
2025-08-25 14:09:09.464 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:09:09.464 | INFO     | app.core.pipeline:_preprocessor_thread:224 - 【T2:预处理 13139586-d6d7-4696-bfd7-cab1860a9287】已停止。
2025-08-25 14:09:09.464 | INFO     | app.core.pipeline:stop:149 - ✅【流水线 13139586-d6d7-4696-bfd7-cab1860a9287】已安全停止。
2025-08-25 14:09:09.465 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 13139586-d6d7-4696-bfd7-cab1860a9287】处理工作已结束。
2025-08-25 14:09:09.466 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=13139586-d6d7-4696-bfd7-cab1860a9287
2025-08-25 14:09:24.925 | INFO     | app.core.pipeline:__init__:108 - 【流水线 7ab8d826-30e8-4fd3-a273-ab519b437b0f】正在初始化...
2025-08-25 14:09:24.925 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=7ab8d826-30e8-4fd3-a273-ab519b437b0f, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:09:24.931 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:09:24.938 | INFO     | app.core.pipeline:start:125 - 【流水线 7ab8d826-30e8-4fd3-a273-ab519b437b0f】正在启动...
2025-08-25 14:09:25.152 | INFO     | app.core.pipeline:_reader_thread:168 - 【T1:读帧 7ab8d826-30e8-4fd3-a273-ab519b437b0f】启动。
2025-08-25 14:09:25.153 | INFO     | app.core.pipeline:_preprocessor_thread:214 - 【T2:预处理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】启动。
2025-08-25 14:09:25.154 | INFO     | app.core.pipeline:_inference_thread:228 - 【T3:推理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】启动。
2025-08-25 14:09:25.154 | INFO     | app.core.pipeline:_postprocessor_thread:270 - 【T4:后处理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】启动。
2025-08-25 14:09:27.568 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:09:27.568 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:09:30.627 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:09:30.628 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:09:33.197 | INFO     | app.core.pipeline:stop:135 - 【流水线 7ab8d826-30e8-4fd3-a273-ab519b437b0f】正在停止...
2025-08-25 14:09:33.231 | INFO     | app.core.pipeline:_postprocessor_thread:339 - 【T4:后处理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】已停止。
2025-08-25 14:09:33.244 | INFO     | app.core.pipeline:_reader_thread:210 - 【T1:读帧 7ab8d826-30e8-4fd3-a273-ab519b437b0f】已停止。
2025-08-25 14:09:33.256 | INFO     | app.core.pipeline:_inference_thread:264 - 【T3:推理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】已停止。
2025-08-25 14:09:34.203 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 7 条检测结果
2025-08-25 14:09:34.204 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 14:09:35.264 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:09:35.264 | INFO     | app.core.pipeline:stop:149 - ✅【流水线 7ab8d826-30e8-4fd3-a273-ab519b437b0f】已安全停止。
2025-08-25 14:09:35.264 | INFO     | app.core.pipeline:_preprocessor_thread:224 - 【T2:预处理 7ab8d826-30e8-4fd3-a273-ab519b437b0f】已停止。
2025-08-25 14:09:35.264 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 7ab8d826-30e8-4fd3-a273-ab519b437b0f】处理工作已结束。
2025-08-25 14:09:35.266 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=7ab8d826-30e8-4fd3-a273-ab519b437b0f
2025-08-25 14:10:02.740 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:10:02.741 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:10:02.741 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:10:02.742 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:10:02.742 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:10:02.972 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:10:02.973 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:10:48.376 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:10:48.377 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:10:48.377 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:10:48.378 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:10:48.378 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:10:48.379 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:10:55.039 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:10:55.824 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:10:55.825 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:10:55.827 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:10:55.827 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:10:55.827 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:10:58.448 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:10:58.449 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:10:58.450 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:10:58.451 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:11:00.276 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:11:00.277 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:11:00.278 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:11:00.278 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:11:02.383 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:11:02.383 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:11:02.384 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:11:02.385 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:11:02.386 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:11:02.386 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:11:02.386 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:11:02.391 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:11:02.395 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:11:02.395 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:11:02.395 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:11:02.395 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:11:02.396 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:11:10.863 | INFO     | app.core.pipeline:__init__:113 - 【流水线 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】正在初始化...
2025-08-25 14:11:10.864 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=b7ed45e5-7eaf-4079-aecf-aea676ad03d7, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:11:10.870 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:11:10.876 | INFO     | app.core.pipeline:start:130 - 【流水线 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】正在启动...
2025-08-25 14:11:11.072 | INFO     | app.core.pipeline:_reader_thread:173 - 【T1:读帧 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】启动。
2025-08-25 14:11:11.073 | INFO     | app.core.pipeline:_preprocessor_thread:219 - 【T2:预处理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】启动。
2025-08-25 14:11:11.075 | INFO     | app.core.pipeline:_inference_thread:233 - 【T3:推理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】启动。
2025-08-25 14:11:11.076 | INFO     | app.core.pipeline:_postprocessor_thread:275 - 【T4:后处理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】启动。
2025-08-25 14:11:13.557 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:11:13.558 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:11:16.569 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:11:16.570 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:11:19.619 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:11:19.620 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:11:22.662 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:11:22.663 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:11:25.755 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:11:25.756 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:11:28.806 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:11:28.809 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:11:30.249 | INFO     | app.core.pipeline:stop:140 - 【流水线 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】正在停止...
2025-08-25 14:11:30.289 | INFO     | app.core.pipeline:_reader_thread:215 - 【T1:读帧 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】已停止。
2025-08-25 14:11:30.294 | INFO     | app.core.pipeline:_postprocessor_thread:344 - 【T4:后处理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】已停止。
2025-08-25 14:11:30.325 | INFO     | app.core.pipeline:_inference_thread:269 - 【T3:推理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】已停止。
2025-08-25 14:11:32.294 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:11:32.295 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:11:32.338 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:11:32.339 | INFO     | app.core.pipeline:_preprocessor_thread:229 - 【T2:预处理 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】已停止。
2025-08-25 14:11:32.339 | INFO     | app.core.pipeline:stop:154 - ✅【流水线 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】已安全停止。
2025-08-25 14:11:32.340 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 b7ed45e5-7eaf-4079-aecf-aea676ad03d7】处理工作已结束。
2025-08-25 14:11:32.343 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=b7ed45e5-7eaf-4079-aecf-aea676ad03d7
2025-08-25 14:13:04.281 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:13:04.282 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:13:04.282 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:13:04.283 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:13:04.283 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:13:04.464 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:13:04.464 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:13:07.729 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:13:07.730 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:13:07.730 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:13:07.730 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:13:07.731 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:13:07.731 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:13:12.258 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:13:13.032 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:13:13.032 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:13:13.035 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:13:13.035 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:13:13.036 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:13:14.542 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:13:14.542 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:13:14.543 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:13:14.544 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:13:16.003 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:13:16.004 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:13:16.004 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:13:16.005 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:13:18.118 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:13:18.118 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:13:18.119 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:13:18.120 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:13:18.120 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:13:18.121 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:13:18.121 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:13:18.125 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:13:18.128 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:13:18.128 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:13:18.129 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:13:18.129 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:13:18.129 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:13:18.352 | INFO     | app.core.pipeline:__init__:116 - 【流水线 fb4f8835-ac25-4582-8302-250983f94dbf】正在初始化...
2025-08-25 14:13:18.352 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=fb4f8835-ac25-4582-8302-250983f94dbf, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:13:18.356 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:13:18.361 | INFO     | app.core.pipeline:start:133 - 【流水线 fb4f8835-ac25-4582-8302-250983f94dbf】正在启动...
2025-08-25 14:13:18.550 | INFO     | app.core.pipeline:_reader_thread:176 - 【T1:读帧 fb4f8835-ac25-4582-8302-250983f94dbf】启动。
2025-08-25 14:13:18.551 | INFO     | app.core.pipeline:_preprocessor_thread:222 - 【T2:预处理 fb4f8835-ac25-4582-8302-250983f94dbf】启动。
2025-08-25 14:13:18.551 | INFO     | app.core.pipeline:_inference_thread:236 - 【T3:推理 fb4f8835-ac25-4582-8302-250983f94dbf】启动。
2025-08-25 14:13:18.552 | INFO     | app.core.pipeline:_postprocessor_thread:278 - 【T4:后处理 fb4f8835-ac25-4582-8302-250983f94dbf】启动。
2025-08-25 14:13:21.145 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 14:13:21.148 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 14:13:24.216 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:13:24.218 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:13:27.263 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:13:27.263 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:13:30.329 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:13:30.330 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:13:33.375 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:13:33.376 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:13:36.430 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:13:36.431 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:13:39.446 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:13:39.448 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:13:42.496 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:13:42.496 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:13:43.783 | INFO     | app.core.pipeline:stop:143 - 【流水线 fb4f8835-ac25-4582-8302-250983f94dbf】正在停止...
2025-08-25 14:13:43.802 | INFO     | app.core.pipeline:_postprocessor_thread:347 - 【T4:后处理 fb4f8835-ac25-4582-8302-250983f94dbf】已停止。
2025-08-25 14:13:43.815 | INFO     | app.core.pipeline:_reader_thread:218 - 【T1:读帧 fb4f8835-ac25-4582-8302-250983f94dbf】已停止。
2025-08-25 14:13:43.831 | INFO     | app.core.pipeline:_inference_thread:272 - 【T3:推理 fb4f8835-ac25-4582-8302-250983f94dbf】已停止。
2025-08-25 14:13:45.775 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:13:45.775 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:13:45.849 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:13:45.850 | INFO     | app.core.pipeline:_preprocessor_thread:232 - 【T2:预处理 fb4f8835-ac25-4582-8302-250983f94dbf】已停止。
2025-08-25 14:13:45.850 | INFO     | app.core.pipeline:stop:157 - ✅【流水线 fb4f8835-ac25-4582-8302-250983f94dbf】已安全停止。
2025-08-25 14:13:45.851 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 fb4f8835-ac25-4582-8302-250983f94dbf】处理工作已结束。
2025-08-25 14:13:45.853 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=fb4f8835-ac25-4582-8302-250983f94dbf
2025-08-25 14:14:27.652 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:14:27.652 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:14:27.653 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:14:27.653 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:14:27.653 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:14:27.827 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:14:27.827 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:15:25.725 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:15:25.726 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:15:25.726 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:15:25.727 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:15:25.727 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:15:25.728 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:15:30.203 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:15:30.838 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:15:30.838 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:15:30.840 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:15:30.840 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:15:30.840 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:15:33.384 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:15:33.385 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:15:33.386 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:15:33.387 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:15:34.791 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:15:34.909 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:15:34.910 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:15:34.911 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:15:37.006 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:15:37.007 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:15:37.007 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:15:37.008 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:15:37.008 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:15:37.008 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:15:37.009 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:15:37.013 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:15:37.017 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:15:37.017 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:15:37.017 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:15:37.018 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:15:37.018 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:16:18.165 | INFO     | app.core.pipeline:__init__:116 - 【流水线 ade29264-2011-4a63-822c-2ca24db03887】正在初始化...
2025-08-25 14:16:18.166 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=ade29264-2011-4a63-822c-2ca24db03887, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:16:18.172 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:16:18.177 | INFO     | app.core.pipeline:start:133 - 【流水线 ade29264-2011-4a63-822c-2ca24db03887】正在启动...
2025-08-25 14:16:18.345 | INFO     | app.core.pipeline:_reader_thread:176 - 【T1:读帧 ade29264-2011-4a63-822c-2ca24db03887】启动。
2025-08-25 14:16:18.346 | INFO     | app.core.pipeline:_preprocessor_thread:222 - 【T2:预处理 ade29264-2011-4a63-822c-2ca24db03887】启动。
2025-08-25 14:16:18.347 | INFO     | app.core.pipeline:_inference_thread:236 - 【T3:推理 ade29264-2011-4a63-822c-2ca24db03887】启动。
2025-08-25 14:16:18.349 | INFO     | app.core.pipeline:_postprocessor_thread:278 - 【T4:后处理 ade29264-2011-4a63-822c-2ca24db03887】启动。
2025-08-25 14:16:20.927 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:16:20.928 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:16:23.941 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 14:16:23.942 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 14:16:26.983 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 14:16:26.984 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 14:16:30.029 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 7 条检测结果
2025-08-25 14:16:30.030 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 14:16:33.090 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 14:16:33.092 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 14:16:36.143 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:16:36.144 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:16:38.552 | INFO     | app.core.pipeline:stop:143 - 【流水线 ade29264-2011-4a63-822c-2ca24db03887】正在停止...
2025-08-25 14:16:38.569 | INFO     | app.core.pipeline:_inference_thread:272 - 【T3:推理 ade29264-2011-4a63-822c-2ca24db03887】已停止。
2025-08-25 14:16:38.583 | INFO     | app.core.pipeline:_reader_thread:218 - 【T1:读帧 ade29264-2011-4a63-822c-2ca24db03887】已停止。
2025-08-25 14:16:38.602 | INFO     | app.core.pipeline:_postprocessor_thread:347 - 【T4:后处理 ade29264-2011-4a63-822c-2ca24db03887】已停止。
2025-08-25 14:16:39.589 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 14:16:39.589 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 14:16:40.599 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:16:40.599 | INFO     | app.core.pipeline:_preprocessor_thread:232 - 【T2:预处理 ade29264-2011-4a63-822c-2ca24db03887】已停止。
2025-08-25 14:16:40.600 | INFO     | app.core.pipeline:stop:157 - ✅【流水线 ade29264-2011-4a63-822c-2ca24db03887】已安全停止。
2025-08-25 14:16:40.600 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 ade29264-2011-4a63-822c-2ca24db03887】处理工作已结束。
2025-08-25 14:16:40.601 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=ade29264-2011-4a63-822c-2ca24db03887
2025-08-25 14:19:35.922 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:19:35.923 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:19:35.923 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:19:35.923 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:19:35.924 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:19:36.095 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:19:36.096 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:19:37.679 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:19:37.680 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:19:37.680 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:19:37.681 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:19:37.681 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:19:37.681 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:19:48.767 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:19:49.785 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:19:49.785 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:19:49.788 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:19:49.789 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:19:49.789 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:19:52.703 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:19:52.704 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:19:52.705 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:19:52.706 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:19:54.229 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:19:54.230 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:19:54.230 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:19:54.231 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:19:56.055 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:19:56.055 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:19:56.056 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:19:56.057 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:19:56.057 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:19:56.057 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:19:56.057 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:19:56.062 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:19:56.066 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:19:56.066 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:19:56.066 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:19:56.066 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:19:56.066 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:19:58.871 | INFO     | app.core.pipeline:__init__:103 - 【流水线 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】正在初始化...
2025-08-25 14:19:58.871 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=bc92fb98-1ad1-40eb-817e-b3d7d9aedc35, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:19:58.875 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:19:58.880 | INFO     | app.core.pipeline:start:120 - 【流水线 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】正在启动...
2025-08-25 14:19:59.028 | INFO     | app.core.pipeline:_reader_thread:163 - 【T1:读帧 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】启动。
2025-08-25 14:19:59.028 | INFO     | app.core.pipeline:_preprocessor_thread:209 - 【T2:预处理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】启动。
2025-08-25 14:19:59.029 | INFO     | app.core.pipeline:_inference_thread:223 - 【T3:推理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】启动。
2025-08-25 14:19:59.030 | INFO     | app.core.pipeline:_postprocessor_thread:265 - 【T4:后处理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】启动。
2025-08-25 14:20:01.215 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:20:01.215 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:20:04.271 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:20:04.272 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:20:06.075 | INFO     | app.core.pipeline:stop:130 - 【流水线 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】正在停止...
2025-08-25 14:20:06.101 | INFO     | app.core.pipeline:_inference_thread:259 - 【T3:推理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】已停止。
2025-08-25 14:20:06.106 | INFO     | app.core.pipeline:_reader_thread:205 - 【T1:读帧 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】已停止。
2025-08-25 14:20:06.141 | INFO     | app.core.pipeline:_postprocessor_thread:334 - 【T4:后处理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】已停止。
2025-08-25 14:20:08.124 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:20:08.124 | INFO     | app.core.pipeline:_preprocessor_thread:219 - 【T2:预处理 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】已停止。
2025-08-25 14:20:08.125 | INFO     | app.core.pipeline:stop:144 - ✅【流水线 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】已安全停止。
2025-08-25 14:20:08.126 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 bc92fb98-1ad1-40eb-817e-b3d7d9aedc35】处理工作已结束。
2025-08-25 14:20:08.127 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=bc92fb98-1ad1-40eb-817e-b3d7d9aedc35
2025-08-25 14:20:08.142 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:20:08.143 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:20:16.409 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 14:20:16.449 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 2 条 SN 为 'sn002' 的记录。
2025-08-25 14:20:16.487 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn002, 新数据={'name': '胖'}, 影响记录数=2
2025-08-25 14:20:20.821 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-08-25 14:20:20.853 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 3 条 SN 为 'sn003' 的记录。
2025-08-25 14:20:20.886 | INFO     | app.service.face_service:update_face_by_sn:147 - 人员信息已更新: SN=sn003, 新数据={'name': '女'}, 影响记录数=3
2025-08-25 14:20:29.691 | INFO     | app.core.pipeline:__init__:103 - 【流水线 0b42c265-b04c-40b1-a8e8-23f753789a5d】正在初始化...
2025-08-25 14:20:29.691 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=0b42c265-b04c-40b1-a8e8-23f753789a5d, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:20:29.697 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:20:29.703 | INFO     | app.core.pipeline:start:120 - 【流水线 0b42c265-b04c-40b1-a8e8-23f753789a5d】正在启动...
2025-08-25 14:20:29.888 | INFO     | app.core.pipeline:_reader_thread:163 - 【T1:读帧 0b42c265-b04c-40b1-a8e8-23f753789a5d】启动。
2025-08-25 14:20:29.889 | INFO     | app.core.pipeline:_preprocessor_thread:209 - 【T2:预处理 0b42c265-b04c-40b1-a8e8-23f753789a5d】启动。
2025-08-25 14:20:29.890 | INFO     | app.core.pipeline:_inference_thread:223 - 【T3:推理 0b42c265-b04c-40b1-a8e8-23f753789a5d】启动。
2025-08-25 14:20:29.891 | INFO     | app.core.pipeline:_postprocessor_thread:265 - 【T4:后处理 0b42c265-b04c-40b1-a8e8-23f753789a5d】启动。
2025-08-25 14:20:32.579 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:20:32.580 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:20:35.603 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 14:20:35.604 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 14:20:38.637 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 7 条检测结果
2025-08-25 14:20:38.637 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 14:20:41.668 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 3 条检测结果
2025-08-25 14:20:41.668 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 3 条检测结果
2025-08-25 14:20:44.691 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 14:20:44.692 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 14:20:47.749 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:20:47.750 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:20:48.055 | INFO     | app.core.pipeline:stop:130 - 【流水线 0b42c265-b04c-40b1-a8e8-23f753789a5d】正在停止...
2025-08-25 14:20:48.087 | INFO     | app.core.pipeline:_reader_thread:205 - 【T1:读帧 0b42c265-b04c-40b1-a8e8-23f753789a5d】已停止。
2025-08-25 14:20:48.091 | INFO     | app.core.pipeline:_postprocessor_thread:334 - 【T4:后处理 0b42c265-b04c-40b1-a8e8-23f753789a5d】已停止。
2025-08-25 14:20:48.117 | INFO     | app.core.pipeline:_inference_thread:259 - 【T3:推理 0b42c265-b04c-40b1-a8e8-23f753789a5d】已停止。
2025-08-25 14:20:50.116 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:20:50.117 | INFO     | app.core.pipeline:_preprocessor_thread:219 - 【T2:预处理 0b42c265-b04c-40b1-a8e8-23f753789a5d】已停止。
2025-08-25 14:20:50.117 | INFO     | app.core.pipeline:stop:144 - ✅【流水线 0b42c265-b04c-40b1-a8e8-23f753789a5d】已安全停止。
2025-08-25 14:20:50.118 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 0b42c265-b04c-40b1-a8e8-23f753789a5d】处理工作已结束。
2025-08-25 14:20:50.119 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=0b42c265-b04c-40b1-a8e8-23f753789a5d
2025-08-25 14:20:51.071 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 14:20:51.072 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 14:21:46.838 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:21:46.839 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:21:46.839 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:21:46.840 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:21:46.840 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:21:47.063 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:21:47.064 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:22:22.053 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:22:22.054 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:22:22.055 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:22:22.055 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:22:22.056 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:22:22.056 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:22:25.179 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:22:25.872 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:22:25.873 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:22:25.874 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:22:25.874 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:22:25.875 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:22:28.480 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:22:28.481 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:22:28.482 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:22:28.482 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:22:29.816 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:22:29.886 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:22:29.887 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:22:29.887 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:22:31.639 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:22:31.639 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:22:31.640 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:22:31.641 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:22:31.641 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:22:31.642 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:22:31.642 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:22:31.646 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:22:31.649 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:22:31.650 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:22:31.650 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:22:31.650 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:22:31.651 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:22:35.320 | INFO     | app.core.pipeline:__init__:110 - 【流水线 bc61e830-b9eb-437e-97c2-c887128d7396】正在初始化...
2025-08-25 14:22:35.321 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=bc61e830-b9eb-437e-97c2-c887128d7396, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:22:35.325 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:22:35.328 | INFO     | app.core.pipeline:start:127 - 【流水线 bc61e830-b9eb-437e-97c2-c887128d7396】正在启动...
2025-08-25 14:22:35.531 | INFO     | app.core.pipeline:_reader_thread:170 - 【T1:读帧 bc61e830-b9eb-437e-97c2-c887128d7396】启动。
2025-08-25 14:22:35.532 | INFO     | app.core.pipeline:_preprocessor_thread:216 - 【T2:预处理 bc61e830-b9eb-437e-97c2-c887128d7396】启动。
2025-08-25 14:22:35.533 | INFO     | app.core.pipeline:_inference_thread:230 - 【T3:推理 bc61e830-b9eb-437e-97c2-c887128d7396】启动。
2025-08-25 14:22:35.533 | INFO     | app.core.pipeline:_postprocessor_thread:272 - 【T4:后处理 bc61e830-b9eb-437e-97c2-c887128d7396】启动。
2025-08-25 14:22:37.715 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:22:37.716 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:22:40.760 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 4 条检测结果
2025-08-25 14:22:40.761 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 4 条检测结果
2025-08-25 14:22:43.821 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:22:43.822 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:22:46.622 | INFO     | app.core.pipeline:stop:137 - 【流水线 bc61e830-b9eb-437e-97c2-c887128d7396】正在停止...
2025-08-25 14:22:46.648 | INFO     | app.core.pipeline:_postprocessor_thread:341 - 【T4:后处理 bc61e830-b9eb-437e-97c2-c887128d7396】已停止。
2025-08-25 14:22:46.651 | INFO     | app.core.pipeline:_reader_thread:212 - 【T1:读帧 bc61e830-b9eb-437e-97c2-c887128d7396】已停止。
2025-08-25 14:22:46.688 | INFO     | app.core.pipeline:_inference_thread:266 - 【T3:推理 bc61e830-b9eb-437e-97c2-c887128d7396】已停止。
2025-08-25 14:22:47.633 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 7 条检测结果
2025-08-25 14:22:47.633 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 7 条检测结果
2025-08-25 14:22:48.668 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:22:48.668 | INFO     | app.core.pipeline:_preprocessor_thread:226 - 【T2:预处理 bc61e830-b9eb-437e-97c2-c887128d7396】已停止。
2025-08-25 14:22:48.669 | INFO     | app.core.pipeline:stop:151 - ✅【流水线 bc61e830-b9eb-437e-97c2-c887128d7396】已安全停止。
2025-08-25 14:22:48.669 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 bc61e830-b9eb-437e-97c2-c887128d7396】处理工作已结束。
2025-08-25 14:22:48.670 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=bc61e830-b9eb-437e-97c2-c887128d7396
2025-08-25 14:22:50.474 | INFO     | app.core.pipeline:__init__:110 - 【流水线 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】正在初始化...
2025-08-25 14:22:50.475 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1, Source=0
2025-08-25 14:22:50.481 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:22:50.489 | INFO     | app.core.pipeline:start:127 - 【流水线 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】正在启动...
2025-08-25 14:22:53.865 | INFO     | app.core.pipeline:_reader_thread:170 - 【T1:读帧 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】启动。
2025-08-25 14:22:53.866 | INFO     | app.core.pipeline:_preprocessor_thread:216 - 【T2:预处理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】启动。
2025-08-25 14:22:53.867 | INFO     | app.core.pipeline:_inference_thread:230 - 【T3:推理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】启动。
2025-08-25 14:22:53.867 | INFO     | app.core.pipeline:_postprocessor_thread:272 - 【T4:后处理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】启动。
2025-08-25 14:23:16.074 | INFO     | app.core.pipeline:stop:137 - 【流水线 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】正在停止...
2025-08-25 14:23:16.090 | INFO     | app.core.pipeline:_reader_thread:212 - 【T1:读帧 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】已停止。
2025-08-25 14:23:16.093 | INFO     | app.core.pipeline:_inference_thread:266 - 【T3:推理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】已停止。
2025-08-25 14:23:16.116 | INFO     | app.core.pipeline:_postprocessor_thread:341 - 【T4:后处理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】已停止。
2025-08-25 14:23:18.398 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:23:18.398 | INFO     | app.core.pipeline:stop:151 - ✅【流水线 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】已安全停止。
2025-08-25 14:23:18.398 | INFO     | app.core.pipeline:_preprocessor_thread:226 - 【T2:预处理 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】已停止。
2025-08-25 14:23:18.399 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1】处理工作已结束。
2025-08-25 14:23:18.401 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=dc8f6c79-a6ce-4d4d-b64a-bb727b8a69e1
2025-08-25 14:23:26.186 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:23:26.187 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:23:26.187 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:23:26.188 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:23:26.188 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:23:26.376 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:23:26.376 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:24:32.301 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:24:32.302 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:24:32.302 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:24:32.303 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:24:32.303 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:24:32.303 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:24:35.784 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:24:36.442 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:24:36.442 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:24:36.445 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:24:36.446 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:24:36.446 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:24:39.084 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:24:39.085 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:24:39.085 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:24:39.086 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:24:40.695 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:24:40.815 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:24:40.816 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:24:40.817 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:24:42.837 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:24:42.838 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:24:42.839 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:24:42.840 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:24:42.840 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:24:42.840 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:24:42.841 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:24:42.844 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:24:42.848 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:24:42.848 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:24:42.849 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:24:42.849 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:24:42.849 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:24:43.284 | INFO     | app.core.pipeline:__init__:135 - 【流水线 f30c323f-db69-415e-9faa-7cac75a03662】正在初始化...
2025-08-25 14:24:43.285 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=f30c323f-db69-415e-9faa-7cac75a03662, Source=0
2025-08-25 14:24:43.289 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:24:43.295 | INFO     | app.core.pipeline:start:152 - 【流水线 f30c323f-db69-415e-9faa-7cac75a03662】正在启动...
2025-08-25 14:24:45.830 | INFO     | app.core.pipeline:_reader_thread:195 - 【T1:读帧 f30c323f-db69-415e-9faa-7cac75a03662】启动。
2025-08-25 14:24:45.831 | INFO     | app.core.pipeline:_preprocessor_thread:241 - 【T2:预处理 f30c323f-db69-415e-9faa-7cac75a03662】启动。
2025-08-25 14:24:45.832 | INFO     | app.core.pipeline:_inference_thread:255 - 【T3:推理 f30c323f-db69-415e-9faa-7cac75a03662】启动。
2025-08-25 14:24:45.833 | INFO     | app.core.pipeline:_postprocessor_thread:297 - 【T4:后处理 f30c323f-db69-415e-9faa-7cac75a03662】启动。
2025-08-25 14:25:05.025 | INFO     | app.core.pipeline:stop:162 - 【流水线 f30c323f-db69-415e-9faa-7cac75a03662】正在停止...
2025-08-25 14:25:05.070 | INFO     | app.core.pipeline:_reader_thread:237 - 【T1:读帧 f30c323f-db69-415e-9faa-7cac75a03662】已停止。
2025-08-25 14:25:05.075 | INFO     | app.core.pipeline:_inference_thread:291 - 【T3:推理 f30c323f-db69-415e-9faa-7cac75a03662】已停止。
2025-08-25 14:25:05.105 | INFO     | app.core.pipeline:_postprocessor_thread:366 - 【T4:后处理 f30c323f-db69-415e-9faa-7cac75a03662】已停止。
2025-08-25 14:25:07.369 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:25:07.369 | INFO     | app.core.pipeline:_preprocessor_thread:251 - 【T2:预处理 f30c323f-db69-415e-9faa-7cac75a03662】已停止。
2025-08-25 14:25:07.370 | INFO     | app.core.pipeline:stop:176 - ✅【流水线 f30c323f-db69-415e-9faa-7cac75a03662】已安全停止。
2025-08-25 14:25:07.372 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 f30c323f-db69-415e-9faa-7cac75a03662】处理工作已结束。
2025-08-25 14:25:07.374 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=f30c323f-db69-415e-9faa-7cac75a03662
2025-08-25 14:25:09.674 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:25:09.675 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:25:09.675 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:25:09.676 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:25:09.676 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:25:10.001 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:25:10.002 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:37:47.362 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:37:47.363 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:37:47.363 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:37:47.364 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:37:47.364 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:37:47.364 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:37:59.046 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:37:59.949 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:37:59.949 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:37:59.951 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:37:59.951 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:37:59.952 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:38:03.707 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:38:03.707 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:38:03.708 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:38:03.709 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:38:05.492 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:38:05.493 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:38:05.494 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:38:05.494 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:38:08.550 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:38:08.550 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:38:08.551 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:38:08.553 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:38:08.553 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:38:08.554 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:38:08.554 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:38:08.584 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:38:08.617 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:38:08.617 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:38:08.618 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:38:08.618 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:38:08.618 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:38:36.778 | INFO     | app.core.pipeline:__init__:140 - 【流水线 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】正在初始化...
2025-08-25 14:38:36.778 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=ddb20b5b-8a1a-4210-aa8e-4aa03206d232, Source=0
2025-08-25 14:38:36.784 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:38:36.790 | INFO     | app.core.pipeline:start:157 - 【流水线 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】正在启动...
2025-08-25 14:38:40.696 | INFO     | app.core.pipeline:_reader_thread:200 - 【T1:读帧 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】启动。
2025-08-25 14:38:40.697 | INFO     | app.core.pipeline:_preprocessor_thread:246 - 【T2:预处理 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】启动。
2025-08-25 14:38:40.698 | INFO     | app.core.pipeline:_inference_thread:260 - 【T3:推理 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】启动。
2025-08-25 14:38:40.699 | INFO     | app.core.pipeline:_postprocessor_thread:302 - 【T4:后处理 ddb20b5b-8a1a-4210-aa8e-4aa03206d232】启动。
2025-08-25 14:40:36.490 | INFO     | app.service.face_service:get_stream_feed:245 - 客户端从流 ddb20b5b-8a1a-4210-aa8e-4aa03206d232 断开。
2025-08-25 14:40:40.618 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:40:40.619 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:40:40.619 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:40:40.620 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:40:40.620 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:40:40.620 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:40:46.916 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:40:47.787 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:40:47.788 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:40:47.789 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:40:47.790 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:40:47.790 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:40:50.439 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:40:50.440 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:40:50.441 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:40:50.442 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:40:52.330 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:40:52.512 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:40:52.514 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:40:52.514 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:40:55.822 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:40:55.823 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:40:55.824 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:40:55.826 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:40:55.826 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:40:55.827 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:40:55.827 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:40:55.834 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:40:55.839 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:40:55.839 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:40:55.840 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:40:55.840 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:40:55.840 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:41:01.869 | INFO     | app.core.pipeline:__init__:140 - 【流水线 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】正在初始化...
2025-08-25 14:41:01.869 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=083d42c4-bbda-4d5c-8f90-e01ccc5643b8, Source=0
2025-08-25 14:41:01.874 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:41:01.878 | INFO     | app.core.pipeline:start:157 - 【流水线 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】正在启动...
2025-08-25 14:41:04.091 | INFO     | app.core.pipeline:_reader_thread:200 - 【T1:读帧 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】启动。
2025-08-25 14:41:04.092 | INFO     | app.core.pipeline:_preprocessor_thread:246 - 【T2:预处理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】启动。
2025-08-25 14:41:04.093 | INFO     | app.core.pipeline:_inference_thread:260 - 【T3:推理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】启动。
2025-08-25 14:41:04.093 | INFO     | app.core.pipeline:_postprocessor_thread:302 - 【T4:后处理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】启动。
2025-08-25 14:41:18.222 | INFO     | app.core.pipeline:stop:167 - 【流水线 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】正在停止...
2025-08-25 14:41:18.237 | INFO     | app.core.pipeline:_reader_thread:242 - 【T1:读帧 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】已停止。
2025-08-25 14:41:18.237 | INFO     | app.core.pipeline:_preprocessor_thread:256 - 【T2:预处理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】已停止。
2025-08-25 14:41:18.290 | INFO     | app.core.pipeline:_inference_thread:296 - 【T3:推理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】已停止。
2025-08-25 14:41:18.310 | INFO     | app.core.pipeline:_postprocessor_thread:371 - 【T4:后处理 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】已停止。
2025-08-25 14:41:18.617 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:41:18.617 | INFO     | app.core.pipeline:stop:181 - ✅【流水线 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】已安全停止。
2025-08-25 14:41:18.618 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 083d42c4-bbda-4d5c-8f90-e01ccc5643b8】处理工作已结束。
2025-08-25 14:41:18.621 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=083d42c4-bbda-4d5c-8f90-e01ccc5643b8
2025-08-25 14:48:13.962 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:48:13.962 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:48:13.963 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:48:13.963 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:48:13.964 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:48:14.368 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:48:14.368 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 14:48:16.644 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 14:48:16.645 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 14:48:16.645 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 14:48:16.646 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 14:48:16.646 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 14:48:16.646 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 14:48:28.509 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 14:48:29.281 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 14:48:29.281 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 14:48:29.283 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 14:48:29.283 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 14:48:29.283 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:48:31.856 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:48:31.857 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 14:48:31.858 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:48:31.859 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 14:48:33.374 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:48:33.374 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 14:48:33.375 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 14:48:33.375 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 14:48:35.312 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 14:48:35.312 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 14:48:35.313 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 14:48:35.313 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 14:48:35.313 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 14:48:35.314 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 14:48:35.314 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 14:48:35.318 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:48:35.322 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 14:48:35.323 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 14:48:35.323 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 14:48:35.323 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 14:48:35.324 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 14:48:38.145 | INFO     | app.core.pipeline:__init__:181 - 【流水线 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】正在初始化...
2025-08-25 14:48:38.145 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=413afe07-d01c-4f9f-bb20-b4fb08ff36d6, Source=0
2025-08-25 14:48:38.150 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:48:38.154 | INFO     | app.core.pipeline:start:198 - 【流水线 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】正在启动...
2025-08-25 14:48:40.484 | INFO     | app.core.pipeline:_reader_thread:241 - 【T1:读帧 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】启动。
2025-08-25 14:48:40.484 | INFO     | app.core.pipeline:_preprocessor_thread:287 - 【T2:预处理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】启动。
2025-08-25 14:48:40.485 | INFO     | app.core.pipeline:_inference_thread:301 - 【T3:推理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】启动。
2025-08-25 14:48:40.485 | INFO     | app.core.pipeline:_postprocessor_thread:343 - 【T4:后处理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】启动。
2025-08-25 14:49:01.711 | INFO     | app.core.pipeline:stop:208 - 【流水线 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】正在停止...
2025-08-25 14:49:01.727 | INFO     | app.core.pipeline:_reader_thread:283 - 【T1:读帧 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】已停止。
2025-08-25 14:49:01.727 | INFO     | app.core.pipeline:_preprocessor_thread:297 - 【T2:预处理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】已停止。
2025-08-25 14:49:01.745 | INFO     | app.core.pipeline:_inference_thread:337 - 【T3:推理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】已停止。
2025-08-25 14:49:01.767 | INFO     | app.core.pipeline:_postprocessor_thread:412 - 【T4:后处理 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】已停止。
2025-08-25 14:49:02.104 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:49:02.104 | INFO     | app.core.pipeline:stop:222 - ✅【流水线 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】已安全停止。
2025-08-25 14:49:02.104 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 413afe07-d01c-4f9f-bb20-b4fb08ff36d6】处理工作已结束。
2025-08-25 14:49:02.105 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=413afe07-d01c-4f9f-bb20-b4fb08ff36d6
2025-08-25 14:49:17.846 | INFO     | app.core.pipeline:__init__:181 - 【流水线 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】正在初始化...
2025-08-25 14:49:17.847 | INFO     | app.service.face_service:start_stream:219 - 🚀 视频流线程已启动: ID=4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-08-25 14:49:17.854 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 14:49:17.859 | INFO     | app.core.pipeline:start:198 - 【流水线 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】正在启动...
2025-08-25 14:49:18.089 | INFO     | app.core.pipeline:_reader_thread:241 - 【T1:读帧 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】启动。
2025-08-25 14:49:18.096 | INFO     | app.core.pipeline:_preprocessor_thread:287 - 【T2:预处理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】启动。
2025-08-25 14:49:18.097 | INFO     | app.core.pipeline:_inference_thread:301 - 【T3:推理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】启动。
2025-08-25 14:49:18.103 | INFO     | app.core.pipeline:_postprocessor_thread:343 - 【T4:后处理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】启动。
2025-08-25 14:49:21.970 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 1 条检测结果
2025-08-25 14:49:21.970 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 1 条检测结果
2025-08-25 14:49:24.997 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 6 条检测结果
2025-08-25 14:49:25.003 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 6 条检测结果
2025-08-25 14:49:28.067 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 8 条检测结果
2025-08-25 14:49:28.068 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 8 条检测结果
2025-08-25 14:49:31.088 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 5 条检测结果
2025-08-25 14:49:31.092 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 5 条检测结果
2025-08-25 14:49:32.253 | INFO     | app.core.pipeline:stop:208 - 【流水线 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】正在停止...
2025-08-25 14:49:32.255 | INFO     | app.core.pipeline:_inference_thread:337 - 【T3:推理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】已停止。
2025-08-25 14:49:32.283 | INFO     | app.core.pipeline:_reader_thread:283 - 【T1:读帧 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】已停止。
2025-08-25 14:49:32.296 | INFO     | app.core.pipeline:_postprocessor_thread:412 - 【T4:后处理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】已停止。
2025-08-25 14:49:34.290 | INFO     | app.core.database.results_ops:insert_batch_results:131 - 成功批量插入 2 条检测结果
2025-08-25 14:49:34.291 | INFO     | app.core.result_processor:_save_batch_buffer:209 - 成功批量保存 2 条检测结果
2025-08-25 14:49:34.329 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-08-25 14:49:34.331 | INFO     | app.core.pipeline:stop:222 - ✅【流水线 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】已安全停止。
2025-08-25 14:49:34.330 | INFO     | app.core.pipeline:_preprocessor_thread:297 - 【T2:预处理 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】已停止。
2025-08-25 14:49:34.331 | INFO     | app.service.face_service:_pipeline_worker_thread:198 - ✅【线程 4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d】处理工作已结束。
2025-08-25 14:49:34.333 | INFO     | app.service.face_service:stop_stream:228 - ✅ 视频流已成功停止: ID=4aabfcb3-3fcd-42ab-875f-0c4f4a4beb9d
2025-08-25 14:49:55.420 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 14:49:55.421 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 14:49:55.421 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 14:49:55.421 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 14:49:55.422 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 14:49:55.682 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 14:49:55.683 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 15:00:35.432 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 15:00:35.433 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 15:00:35.434 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 15:00:35.434 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 15:00:35.435 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 15:00:35.435 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 15:00:38.683 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 15:00:39.693 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 15:00:39.693 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 15:00:39.703 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 15:00:39.703 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 15:00:39.704 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:00:43.892 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:00:43.893 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 15:00:43.896 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:00:43.897 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:00:45.239 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:00:45.566 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:00:45.567 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 15:00:45.567 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 15:00:47.685 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 15:00:47.686 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 15:00:47.686 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 15:00:47.687 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 15:00:47.687 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 15:00:47.688 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 15:00:47.689 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 15:00:47.714 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 15:00:47.741 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 15:00:47.741 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 15:00:47.742 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 15:00:47.742 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 15:00:47.742 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 15:25:47.273 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 15:25:47.274 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 15:25:47.275 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 15:25:47.276 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 15:25:47.276 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 15:25:47.276 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 15:26:00.376 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 15:26:01.478 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 15:26:01.478 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 15:26:01.486 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 15:26:01.487 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 15:26:01.487 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:26:04.490 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:26:04.491 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 15:26:04.493 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:26:04.494 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:26:06.054 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:26:06.162 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:26:06.163 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 15:26:06.163 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 15:26:09.139 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 15:26:09.140 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 15:26:09.141 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 15:26:09.144 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 15:26:09.144 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 15:26:09.145 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 15:26:09.145 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 15:26:09.216 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 15:26:09.262 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 15:26:09.263 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 15:26:09.264 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 15:26:09.264 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 15:26:09.265 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 15:34:33.271 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 15:34:33.273 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 15:34:33.274 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 15:34:33.274 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 15:34:33.275 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 15:34:33.567 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 15:34:33.568 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 15:41:00.759 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 15:41:00.759 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 15:41:00.760 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 15:41:00.760 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 15:41:00.761 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 15:41:00.762 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 15:41:12.024 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 15:41:13.180 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 15:41:13.180 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 15:41:13.182 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 15:41:13.182 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 15:41:13.182 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:41:17.645 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:41:17.646 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 15:41:17.648 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:41:17.649 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:41:19.491 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:41:19.705 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:41:19.706 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 15:41:19.707 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 15:41:25.577 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 15:41:25.578 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 15:41:25.579 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 15:41:25.580 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 15:41:25.580 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 15:41:25.581 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 15:41:25.581 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 15:41:25.587 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 15:41:25.592 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 15:41:25.593 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 15:41:25.593 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 15:41:25.593 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 15:41:25.594 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 15:42:44.705 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 15:42:44.706 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 15:42:44.706 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 15:42:44.706 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 15:42:44.707 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 15:42:44.898 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 15:42:44.898 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
2025-08-25 15:46:21.333 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-08-25 15:46:21.334 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-08-25 15:46:21.335 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-08-25 15:46:21.335 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-08-25 15:46:21.336 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-08-25 15:46:21.336 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-08-25 15:46:33.472 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-08-25 15:46:34.673 | INFO     | app.main:lifespan:31 - 应用程序启动... 开始执行启动任务。
2025-08-25 15:46:34.673 | INFO     | app.main:lifespan:34 - 应用启动，开始初始化数据库...
2025-08-25 15:46:34.682 | INFO     | app.main:lifespan:36 - 数据库初始化完成。
2025-08-25 15:46:34.683 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-08-25 15:46:34.683 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:46:39.471 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:46:39.472 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-08-25 15:46:39.473 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:46:39.474 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-08-25 15:46:41.751 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:46:41.901 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-08-25 15:46:41.902 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-08-25 15:46:41.903 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-08-25 15:46:45.547 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-08-25 15:46:45.547 | INFO     | app.main:lifespan:40 - ✅ 模型池加载完成。
2025-08-25 15:46:45.548 | INFO     | app.core.result_processor:__init__:49 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-08-25 15:46:45.548 | INFO     | app.core.result_processor:_worker_loop:86 - 结果持久化处理器工作线程已启动
2025-08-25 15:46:45.549 | INFO     | app.core.result_processor:start:64 - ✅ 结果持久化处理器已启动
2025-08-25 15:46:45.549 | INFO     | app.main:lifespan:47 - ✅ 结果持久化服务已启动。
2025-08-25 15:46:45.549 | INFO     | app.service.face_service:__init__:30 - 正在初始化 FaceService (多线程 + 模型池)...
2025-08-25 15:46:45.579 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-08-25 15:46:45.606 | INFO     | app.service.face_service:initialize:44 - FaceService 正在初始化...
2025-08-25 15:46:45.606 | INFO     | app.service.face_service:initialize:45 - ✅ FaceService 初始化完毕。
2025-08-25 15:46:45.606 | INFO     | app.main:lifespan:55 - ✅ FaceService 初始化完成。
2025-08-25 15:46:45.607 | INFO     | app.main:lifespan:60 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-08-25 15:46:45.607 | INFO     | app.main:lifespan:62 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-08-25 15:47:12.054 | INFO     | app.main:lifespan:65 - 应用程序正在关闭... 开始执行清理任务。
2025-08-25 15:47:12.054 | INFO     | app.main:lifespan:74 - ✅ 视频流清理任务已取消。
2025-08-25 15:47:12.055 | INFO     | app.core.result_processor:_worker_loop:116 - 结果持久化处理器工作线程已停止
2025-08-25 15:47:12.055 | INFO     | app.core.result_processor:stop:82 - ✅ 结果持久化处理器已停止
2025-08-25 15:47:12.056 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-08-25 15:47:12.214 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-08-25 15:47:12.214 | INFO     | app.main:lifespan:87 - ✅ 所有清理任务完成。
