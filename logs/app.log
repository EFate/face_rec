2025-09-08 15:41:15.542 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-08 15:41:15.543 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-08 15:41:15.543 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-08 15:41:15.545 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-08 15:41:15.545 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-08 15:41:15.546 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-08 15:41:17.607 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-08 15:41:18.306 | INFO     | app.main:lifespan:35 - 应用程序启动... 开始执行启动任务。
2025-09-08 15:41:18.306 | INFO     | app.main:lifespan:36 - 应用启动，开始初始化数据库...
2025-09-08 15:41:18.308 | INFO     | app.main:lifespan:38 - 数据库初始化完成。
2025-09-08 15:41:18.308 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-09-08 15:41:18.309 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 15:44:38.156 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 15:44:38.157 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-09-08 15:44:38.158 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 15:44:38.159 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 15:44:39.694 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 15:44:39.841 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 15:44:39.842 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-09-08 15:44:39.842 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-09-08 15:44:43.341 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-09-08 15:44:43.341 | INFO     | app.main:lifespan:42 - ✅ 模型池加载完成。
2025-09-08 15:44:43.457 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-08 15:44:43.457 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-08 15:44:43.458 | INFO     | app.main:lifespan:48 - ✅ MQTT管理器已启动。
2025-09-08 15:44:43.460 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-08 15:44:43.461 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-08 15:44:43.461 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-08 15:44:43.461 | INFO     | app.main:lifespan:55 - ✅ 结果持久化服务已启动。
2025-09-08 15:44:43.462 | INFO     | app.service.face_service:__init__:31 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-08 15:44:43.498 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-08 15:44:43.539 | INFO     | app.service.face_service:initialize:46 - FaceService 正在初始化...
2025-09-08 15:44:43.539 | INFO     | app.service.face_service:initialize:47 - ✅ FaceService 初始化完毕。
2025-09-08 15:44:43.539 | INFO     | app.main:lifespan:63 - ✅ FaceService 初始化完成。
2025-09-08 15:44:43.540 | INFO     | app.main:lifespan:68 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-08 15:44:43.540 | INFO     | app.main:lifespan:70 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-08 15:44:43.542 | INFO     | app.main:lifespan:73 - 应用程序正在关闭... 开始执行清理任务。
2025-09-08 15:44:43.542 | INFO     | app.main:lifespan:82 - ✅ 视频流清理任务已取消。
2025-09-08 15:44:43.542 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-08 15:44:44.354 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-08 15:44:44.354 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-08 15:44:44.354 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-08 15:44:44.355 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-09-08 15:44:44.530 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-09-08 15:44:44.530 | INFO     | app.main:lifespan:99 - ✅ 所有清理任务完成。
2025-09-08 16:11:09.638 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-08 16:11:09.639 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-08 16:11:09.639 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-08 16:11:09.641 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-08 16:11:09.641 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-08 16:11:09.641 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-08 16:11:12.777 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-08 16:11:14.071 | INFO     | app.main:lifespan:35 - 应用程序启动... 开始执行启动任务。
2025-09-08 16:11:14.071 | INFO     | app.main:lifespan:36 - 应用启动，开始初始化数据库...
2025-09-08 16:11:14.079 | INFO     | app.main:lifespan:38 - 数据库初始化完成。
2025-09-08 16:11:14.080 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-09-08 16:11:14.080 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 16:11:16.383 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 16:11:16.383 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-09-08 16:11:16.385 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 16:11:16.387 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-08 16:11:18.793 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 16:11:18.795 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-08 16:11:18.796 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-09-08 16:11:18.796 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-09-08 16:11:23.633 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-09-08 16:11:23.633 | INFO     | app.main:lifespan:42 - ✅ 模型池加载完成。
2025-09-08 16:11:23.768 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-08 16:11:23.769 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-08 16:11:23.770 | INFO     | app.main:lifespan:48 - ✅ MQTT管理器已启动。
2025-09-08 16:11:23.771 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-08 16:11:23.772 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-08 16:11:23.773 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-08 16:11:23.774 | INFO     | app.main:lifespan:55 - ✅ 结果持久化服务已启动。
2025-09-08 16:11:23.774 | INFO     | app.service.face_service:__init__:31 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-08 16:11:23.811 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-08 16:11:23.859 | INFO     | app.service.face_service:initialize:46 - FaceService 正在初始化...
2025-09-08 16:11:23.859 | INFO     | app.service.face_service:initialize:47 - ✅ FaceService 初始化完毕。
2025-09-08 16:11:23.860 | INFO     | app.main:lifespan:63 - ✅ FaceService 初始化完成。
2025-09-08 16:11:23.860 | INFO     | app.main:lifespan:68 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-08 16:11:23.861 | INFO     | app.main:lifespan:70 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-08 16:11:23.864 | INFO     | app.main:lifespan:73 - 应用程序正在关闭... 开始执行清理任务。
2025-09-08 16:11:23.864 | INFO     | app.main:lifespan:82 - ✅ 视频流清理任务已取消。
2025-09-08 16:11:23.865 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-08 16:11:24.664 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-08 16:11:24.664 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-08 16:11:24.665 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-08 16:11:24.666 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-09-08 16:11:24.834 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-09-08 16:11:24.834 | INFO     | app.main:lifespan:99 - ✅ 所有清理任务完成。
2025-09-09 10:44:56.696 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 10:44:56.697 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 10:44:56.697 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 10:44:56.698 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 10:44:56.698 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 10:44:56.698 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 10:44:59.425 | INFO     | app.core.model_manager:_setup_environment:72 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 10:45:00.812 | INFO     | app.main:lifespan:35 - 应用程序启动... 开始执行启动任务。
2025-09-09 10:45:00.812 | INFO     | app.main:lifespan:36 - 应用启动，开始初始化数据库...
2025-09-09 10:45:00.823 | INFO     | app.main:lifespan:38 - 数据库初始化完成。
2025-09-09 10:45:00.823 | INFO     | app.core.model_manager:load_models:84 - 开始加载3个模型实例到池中
2025-09-09 10:45:00.824 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-09 10:45:04.731 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-09 10:45:04.731 | INFO     | app.core.model_manager:load_models:89 - 第一个模型加载成功，继续加载剩余模型
2025-09-09 10:45:04.733 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-09 10:45:04.734 | INFO     | app.core.model_manager:create_face_analysis_model:18 - 创建InsightFace模型: buffalo_l
2025-09-09 10:45:06.756 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-09 10:45:06.973 | INFO     | app.core.model_manager:create_face_analysis_model:37 - 模型下载成功: buffalo_l
2025-09-09 10:45:06.975 | INFO     | app.core.model_manager:load_models:105 - 成功加载3个模型到池中
2025-09-09 10:45:06.977 | INFO     | app.core.model_manager:_startup_test:122 - 开始启动自检
2025-09-09 10:45:11.590 | INFO     | app.core.model_manager:_startup_test:133 - 自检成功：检测到1张人脸
2025-09-09 10:45:11.591 | INFO     | app.main:lifespan:42 - ✅ 模型池加载完成。
2025-09-09 10:45:11.702 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 10:45:11.703 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 10:45:11.703 | INFO     | app.main:lifespan:48 - ✅ MQTT管理器已启动。
2025-09-09 10:45:11.704 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 10:45:11.705 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 10:45:11.705 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 10:45:11.705 | INFO     | app.main:lifespan:55 - ✅ 结果持久化服务已启动。
2025-09-09 10:45:11.706 | INFO     | app.service.face_service:__init__:31 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 10:45:11.751 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 10:45:11.797 | INFO     | app.service.face_service:initialize:46 - FaceService 正在初始化...
2025-09-09 10:45:11.797 | INFO     | app.service.face_service:initialize:47 - ✅ FaceService 初始化完毕。
2025-09-09 10:45:11.797 | INFO     | app.main:lifespan:63 - ✅ FaceService 初始化完成。
2025-09-09 10:45:11.797 | INFO     | app.main:lifespan:68 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 10:45:11.798 | INFO     | app.main:lifespan:70 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 10:45:55.379 | INFO     | app.core.pipeline:__init__:186 - 【流水线 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】正在初始化...
2025-09-09 10:45:55.381 | INFO     | app.service.face_service:start_stream:283 - 🚀 视频流线程已启动: ID=16298362-092f-4ec4-92a3-ca1dc6eeaa6c, TaskID=1234567890, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-09-09 10:45:55.389 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 10:45:55.393 | INFO     | app.core.pipeline:start:202 - 【流水线 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】正在启动...
2025-09-09 10:45:55.764 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】启动。
2025-09-09 10:45:55.764 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】启动。
2025-09-09 10:45:55.765 | INFO     | app.core.pipeline:_postprocessor_thread:385 - 【T3:后处理 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】启动。
2025-09-09 10:45:58.204 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 10:46:01.246 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:46:04.339 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:46:07.408 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:46:10.526 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:46:13.591 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 10:46:16.673 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:46:19.752 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 10:46:22.926 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 9 条检测结果
2025-09-09 10:46:26.014 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:46:29.140 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:46:32.185 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:46:35.312 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 9 条检测结果
2025-09-09 10:46:38.457 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 9 条检测结果
2025-09-09 10:46:41.513 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:46:45.299 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 10:46:48.364 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:46:51.421 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 10:46:54.700 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:46:57.802 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:47:00.885 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 10:47:04.068 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 10:47:07.120 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:47:10.156 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 10 条检测结果
2025-09-09 10:47:13.244 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:47:16.336 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 10:47:19.419 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:47:22.499 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 10:47:25.560 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 10:47:28.630 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:47:31.806 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:47:34.917 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 10 条检测结果
2025-09-09 10:47:38.035 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 10:47:41.161 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:47:44.245 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 10:47:46.860 | INFO     | app.main:lifespan:73 - 应用程序正在关闭... 开始执行清理任务。
2025-09-09 10:47:46.860 | INFO     | app.main:lifespan:82 - ✅ 视频流清理任务已取消。
2025-09-09 10:47:46.862 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-09 10:47:46.926 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-09 10:47:47.008 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 10:47:47.059 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 10:47:47.060 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-09 10:47:47.060 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-09 10:47:47.061 | INFO     | app.service.face_service:stop_all_streams:452 - 正在停止所有活动流: ['16298362-092f-4ec4-92a3-ca1dc6eeaa6c']
2025-09-09 10:47:48.039 | INFO     | app.core.pipeline:stop:213 - 【流水线 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】正在停止...
2025-09-09 10:47:48.050 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】已停止。
2025-09-09 10:47:48.066 | INFO     | app.core.pipeline:_postprocessor_thread:472 - 【T3:后处理 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】已停止。
2025-09-09 10:47:48.120 | INFO     | app.core.pipeline:_inference_thread:379 - 【T2:推理 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】已停止。
2025-09-09 10:47:48.142 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 10:47:48.143 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】已安全停止。
2025-09-09 10:47:48.143 | INFO     | app.service.face_service:_pipeline_worker_thread:253 - ✅【线程 16298362-092f-4ec4-92a3-ca1dc6eeaa6c】处理工作已结束。
2025-09-09 10:47:48.154 | INFO     | app.service.face_service:stop_stream:303 - ✅ 视频流已成功停止: ID=16298362-092f-4ec4-92a3-ca1dc6eeaa6c
2025-09-09 10:47:48.156 | INFO     | app.service.face_service:stop_all_streams:462 - 停止视频流完成: 成功=1, 错误=0
2025-09-09 10:47:48.156 | INFO     | app.main:lifespan:96 - ✅ 所有视频流已停止。
2025-09-09 10:47:48.156 | INFO     | app.core.model_manager:cleanup:188 - 清理模型池资源
2025-09-09 10:47:48.419 | INFO     | app.core.model_manager:cleanup:194 - 模型池已清空
2025-09-09 10:47:48.419 | INFO     | app.main:lifespan:103 - ✅ 模型资源已释放。
2025-09-09 10:47:48.420 | INFO     | app.main:lifespan:107 - ✅ 所有清理任务完成。
2025-09-09 15:49:28.699 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 15:49:28.701 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 15:49:28.701 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 15:49:28.702 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 15:49:28.703 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 15:49:28.703 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 15:49:34.169 | INFO     | app.core.model_manager:_setup_environment:84 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 15:49:35.485 | CRITICAL | __main__:start_server:103 - 服务器启动失败: 'await' outside async function (pipeline.py, line 363)
2025-09-09 15:51:51.572 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 15:51:51.573 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 15:51:51.573 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 15:51:51.574 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 15:51:51.575 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 15:51:51.575 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 15:51:54.526 | INFO     | app.core.model_manager:_setup_environment:84 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 15:51:55.682 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 15:51:55.714 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 15:51:55.714 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 15:51:55.715 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 15:51:55.715 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 15:51:55.728 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 15:51:55.728 | INFO     | app.core.model_manager:load_models:92 - 使用新的异构算力卡推理引擎
2025-09-09 15:51:55.729 | INFO     | app.core.model_manager_v2:load_models:78 - 开始加载3个推理引擎实例到池中
2025-09-09 15:51:55.729 | INFO     | app.core.model_manager_v2:load_models:79 - 使用设备类型: cuda
2025-09-09 15:51:55.729 | INFO     | app.inference.factory:create_engine:45 - 创建 cuda 推理引擎
2025-09-09 15:51:55.729 | INFO     | app.inference.factory:create_engine_with_fallback:87 - 成功创建 cuda 推理引擎
2025-09-09 15:51:55.730 | INFO     | app.inference.devices.cuda.engine:initialize:51 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 15:51:55.731 | INFO     | app.inference.devices.cuda.engine:initialize:62 - CUDA推理引擎初始化成功
2025-09-09 15:51:55.732 | INFO     | app.inference.devices.cuda.engine:load_models:80 - 加载InsightFace模型: buffalo_l
2025-09-09 15:52:00.173 | INFO     | app.inference.devices.cuda.engine:load_models:99 - InsightFace模型加载成功
2025-09-09 15:52:00.173 | INFO     | app.core.model_manager_v2:_create_engine:125 - 推理引擎创建成功: cuda
2025-09-09 15:52:00.175 | INFO     | app.core.model_manager_v2:load_models:84 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 15:52:00.175 | INFO     | app.inference.factory:create_engine:45 - 创建 cuda 推理引擎
2025-09-09 15:52:00.175 | INFO     | app.inference.factory:create_engine_with_fallback:87 - 成功创建 cuda 推理引擎
2025-09-09 15:52:00.175 | INFO     | app.inference.devices.cuda.engine:initialize:51 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 15:52:00.177 | INFO     | app.inference.devices.cuda.engine:initialize:62 - CUDA推理引擎初始化成功
2025-09-09 15:52:00.178 | INFO     | app.inference.devices.cuda.engine:load_models:80 - 加载InsightFace模型: buffalo_l
2025-09-09 15:52:01.421 | INFO     | app.inference.devices.cuda.engine:load_models:99 - InsightFace模型加载成功
2025-09-09 15:52:01.422 | INFO     | app.core.model_manager_v2:_create_engine:125 - 推理引擎创建成功: cuda
2025-09-09 15:52:01.422 | INFO     | app.inference.factory:create_engine:45 - 创建 cuda 推理引擎
2025-09-09 15:52:01.422 | INFO     | app.inference.factory:create_engine_with_fallback:87 - 成功创建 cuda 推理引擎
2025-09-09 15:52:01.423 | INFO     | app.inference.devices.cuda.engine:initialize:51 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 15:52:01.424 | INFO     | app.inference.devices.cuda.engine:initialize:62 - CUDA推理引擎初始化成功
2025-09-09 15:52:01.424 | INFO     | app.inference.devices.cuda.engine:load_models:80 - 加载InsightFace模型: buffalo_l
2025-09-09 15:52:02.706 | INFO     | app.inference.devices.cuda.engine:load_models:99 - InsightFace模型加载成功
2025-09-09 15:52:02.706 | INFO     | app.core.model_manager_v2:_create_engine:125 - 推理引擎创建成功: cuda
2025-09-09 15:52:02.707 | INFO     | app.core.model_manager_v2:load_models:99 - 成功加载3个推理引擎到池中
2025-09-09 15:52:02.708 | INFO     | app.core.model_manager_v2:_startup_test:140 - 开始启动自检
2025-09-09 15:52:09.535 | INFO     | app.core.model_manager_v2:_startup_test:161 - 自检成功：检测到1张人脸
2025-09-09 15:52:09.536 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 15:52:09.652 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 15:52:09.652 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 15:52:09.653 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 15:52:09.654 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 15:52:09.655 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 15:52:09.656 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 15:52:09.657 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 15:52:09.657 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 15:52:09.715 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 15:52:09.771 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 15:52:09.771 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 15:52:09.771 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 15:52:09.772 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 15:52:09.772 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 15:52:39.169 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 15:53:35.711 | INFO     | app.core.degirum_cleanup:_signal_handler:114 - 收到信号 2，开始清理Degirum资源
2025-09-09 15:53:35.712 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:107 - 程序退出，开始清理Degirum资源
2025-09-09 15:53:35.713 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:90 - 开始清理Degirum工作进程
2025-09-09 15:53:35.792 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:99 - 未发现需要清理的Degirum工作进程
2025-09-09 15:53:35.824 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:107 - 程序退出，开始清理Degirum资源
2025-09-09 15:53:35.825 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:90 - 开始清理Degirum工作进程
2025-09-09 15:53:35.869 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:99 - 未发现需要清理的Degirum工作进程
2025-09-09 16:06:24.601 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:06:24.601 | INFO     | __main__:test_all_engines:97 - 开始测试所有推理引擎
2025-09-09 16:06:35.938 | WARNING  | app.inference.devices.hailo8.engine:<module>:27 - Degirum库未安装，Hailo8推理引擎不可用
2025-09-09 16:06:35.945 | WARNING  | app.inference.devices.rk3588.engine:<module>:27 - Degirum库未安装，RK3588推理引擎不可用
2025-09-09 16:06:35.946 | INFO     | __main__:test_all_engines:108 - 可用的推理引擎: ['cuda', 'hailo8', 'rk3588']
2025-09-09 16:06:35.946 | INFO     | __main__:test_inference_engine:26 - 开始测试 cuda 推理引擎
2025-09-09 16:06:35.946 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:06:35.947 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:06:35.948 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:06:35.948 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:06:39.571 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:06:42.585 | INFO     | __main__:test_inference_engine:69 - cuda 推理成功:
2025-09-09 16:06:42.586 | INFO     | __main__:test_inference_engine:70 -   检测到 1 张人脸
2025-09-09 16:06:42.586 | INFO     | __main__:test_inference_engine:71 -   处理时间: 2.970s
2025-09-09 16:06:42.586 | INFO     | __main__:test_inference_engine:72 -   设备类型: cuda
2025-09-09 16:06:42.586 | INFO     | __main__:test_inference_engine:76 -   人脸 1:
2025-09-09 16:06:42.587 | INFO     | __main__:test_inference_engine:77 -     边界框: [312.9760437011719, 166.5177001953125, 698.8760375976562, 712.04150390625]
2025-09-09 16:06:42.587 | INFO     | __main__:test_inference_engine:78 -     置信度: 0.875
2025-09-09 16:06:42.587 | INFO     | __main__:test_inference_engine:79 -     特征向量长度: 512
2025-09-09 16:06:42.588 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:06:42.702 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:06:42.702 | INFO     | __main__:test_inference_engine:87 - cuda 推理引擎测试完成
2025-09-09 16:06:42.703 | INFO     | __main__:test_inference_engine:26 - 开始测试 hailo8 推理引擎
2025-09-09 16:06:42.703 | INFO     | app.inference.factory:create_engine:60 - 创建 hailo8 推理引擎
2025-09-09 16:06:42.704 | ERROR    | __main__:test_inference_engine:91 - hailo8 推理引擎测试失败: Degirum库未安装，无法使用Hailo8推理引擎
2025-09-09 16:06:42.705 | INFO     | __main__:test_inference_engine:26 - 开始测试 rk3588 推理引擎
2025-09-09 16:06:42.706 | INFO     | app.inference.factory:create_engine:60 - 创建 rk3588 推理引擎
2025-09-09 16:06:42.707 | ERROR    | __main__:test_inference_engine:91 - rk3588 推理引擎测试失败: Degirum库未安装，无法使用RK3588推理引擎
2025-09-09 16:06:42.707 | INFO     | __main__:test_all_engines:121 - 测试结果汇总:
2025-09-09 16:06:42.708 | INFO     | __main__:test_all_engines:124 -   cuda: ✅ 成功
2025-09-09 16:06:42.708 | INFO     | __main__:test_all_engines:124 -   hailo8: ❌ 失败
2025-09-09 16:06:42.709 | INFO     | __main__:test_all_engines:124 -   rk3588: ❌ 失败
2025-09-09 16:06:42.709 | INFO     | __main__:test_fallback:129 - 开始测试降级机制
2025-09-09 16:06:42.710 | INFO     | app.inference.factory:create_engine:60 - 创建 hailo8 推理引擎
2025-09-09 16:06:42.710 | WARNING  | app.inference.factory:create_engine_with_fallback:139 - 创建 hailo8 推理引擎失败: Degirum库未安装，无法使用Hailo8推理引擎
2025-09-09 16:06:42.710 | INFO     | app.inference.factory:create_engine_with_fallback:143 - 尝试降级到CUDA/CPU推理引擎
2025-09-09 16:06:42.711 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:06:42.712 | INFO     | app.inference.factory:create_engine_with_fallback:149 - 成功创建CPU推理引擎作为降级方案
2025-09-09 16:06:42.712 | INFO     | __main__:test_fallback:141 - 降级测试成功，使用的引擎类型: cuda
2025-09-09 16:06:42.712 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:06:42.713 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:06:42.714 | INFO     | __main__:main:168 - 异构算力卡适配测试完成
2025-09-09 16:06:42.715 | INFO     | app.core.degirum_cleanup:force_cleanup:155 - 执行强制Degirum资源清理
2025-09-09 16:06:42.715 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:06:42.763 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:06:42.835 | INFO     | app.core.degirum_cleanup:force_cleanup:164 - Degirum资源强制清理完成
2025-09-09 16:06:42.839 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:06:42.839 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:06:42.878 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:06:51.706 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:07:21.973 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:07:21.975 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:07:21.976 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:07:21.978 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:07:21.978 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:07:21.978 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:07:25.326 | INFO     | app.core.model_manager:_setup_environment:85 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:07:26.967 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:07:26.994 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:07:26.995 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:07:26.996 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:07:26.996 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:07:27.000 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:07:27.001 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:07:27.001 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:07:27.002 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:07:27.008 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:07:27.009 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:07:27.009 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:07:27.011 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:07:27.012 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:07:30.355 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:07:30.355 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:07:30.355 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:07:30.356 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:07:30.356 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:07:30.356 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:07:30.357 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:07:30.357 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:07:31.881 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:07:31.882 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:07:31.882 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:07:31.884 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:07:31.884 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:07:31.888 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:07:31.889 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:07:33.415 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:07:33.416 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:07:33.416 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:07:33.417 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:07:36.050 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:07:36.051 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:07:36.173 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:07:36.173 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:07:36.174 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:07:36.174 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:07:36.175 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:07:36.176 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:07:36.176 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:07:36.177 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:07:36.184 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:07:36.192 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:07:36.193 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:07:36.193 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:07:36.194 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:07:36.194 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:07:40.833 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:07:46.818 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:07:50.797 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:07:50.797 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:07:50.798 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:07:50.856 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:07:50.883 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:07:50.883 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:07:50.922 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:08:30.428 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:08:30.429 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:08:30.429 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:08:30.429 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:08:30.443 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:08:30.444 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:08:30.444 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:08:30.444 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:08:30.450 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:08:30.450 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:08:30.450 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:08:30.451 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:08:30.451 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:08:33.609 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:08:33.609 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:08:33.610 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:08:33.610 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:08:33.611 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:08:33.611 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:08:33.613 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:08:33.613 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:08:34.904 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:08:34.904 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:08:34.904 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:08:34.905 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:08:34.905 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:08:34.908 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:08:34.909 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:08:36.195 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:08:36.196 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:08:36.196 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:08:36.198 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:08:38.809 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:08:38.810 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:08:38.930 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:08:38.931 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:08:38.931 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:08:38.932 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:08:38.935 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:08:38.935 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:08:38.936 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:08:38.936 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:08:38.978 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:08:39.019 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:08:39.020 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:08:39.020 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:08:39.020 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:08:39.020 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:10:10.632 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:10:10.633 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:10:10.634 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:10:10.677 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:10:10.689 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:10:10.690 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:10:10.725 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:10:25.618 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:10:25.619 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:10:25.619 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:10:25.619 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:10:25.623 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:10:25.624 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:10:25.624 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:10:25.624 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:10:25.630 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:25.630 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:25.631 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:25.632 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:25.634 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:10:28.952 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:10:28.953 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:10:28.954 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:10:28.954 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:28.955 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:28.956 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:28.957 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:28.958 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:10:30.243 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:10:30.244 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:10:30.245 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:30.245 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:30.247 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:30.248 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:30.248 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:10:31.527 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:10:31.528 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:10:31.529 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:10:31.531 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:10:34.584 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:10:34.585 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:10:34.704 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:10:34.704 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:10:34.704 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:10:34.705 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:10:34.706 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:10:34.706 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:10:34.707 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:10:34.707 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:10:34.714 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:10:34.721 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:10:34.721 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:10:34.721 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:10:34.722 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:10:34.722 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:10:34.734 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:10:34.735 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:10:34.783 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:10:51.124 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:10:51.125 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:10:51.125 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:10:51.125 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:10:51.137 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:10:51.138 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:10:51.141 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:10:51.143 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:10:51.156 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:51.157 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:51.158 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:51.160 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:51.161 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:10:56.254 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:10:56.255 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:10:56.255 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:10:56.256 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:56.257 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:56.258 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:56.261 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:56.262 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:10:58.630 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:10:58.630 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:10:58.631 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:10:58.631 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:10:58.631 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:10:58.634 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:10:58.634 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:11:00.641 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:11:00.642 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:11:00.643 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:11:00.644 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:11:03.262 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:11:03.264 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:11:03.383 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:11:03.383 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:11:03.384 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:11:03.385 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:11:03.387 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:11:03.387 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:11:03.388 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:11:03.390 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:11:03.399 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:11:03.406 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:11:03.406 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:11:03.406 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:11:03.408 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:11:03.408 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:11:03.414 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:11:03.414 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:11:03.463 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:11:17.827 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:11:17.828 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:11:17.828 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:11:17.829 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:11:17.834 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:11:17.835 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:11:17.835 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:11:17.835 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:11:17.840 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:11:17.841 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:11:17.841 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:11:17.842 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:11:17.843 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:11:21.155 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:11:21.155 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:11:21.156 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:11:21.156 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:11:21.157 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:11:21.157 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:11:21.158 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:11:21.159 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:11:22.467 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:11:22.468 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:11:22.468 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:11:22.468 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:11:22.468 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:11:22.471 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:11:22.472 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:11:23.746 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:11:23.746 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:11:23.748 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:11:23.751 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:11:26.231 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:11:26.231 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:11:26.348 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:11:26.348 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:11:26.349 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:11:26.349 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:11:26.351 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:11:26.352 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:11:26.352 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:11:26.353 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:11:26.361 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:11:26.366 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:11:26.366 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:11:26.367 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:11:26.367 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:11:26.367 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:11:26.422 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:11:26.424 | WARNING  | app.service.face_service:register_face:80 - 使用默认阈值未检测到人脸，尝试使用更宽松的阈值重新检测
2025-09-09 16:11:26.425 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:11:26.467 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:11:26.505 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:67 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'predict'
2025-09-09 16:12:05.420 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:12:05.420 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:12:05.420 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:12:05.485 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:12:05.494 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:12:05.494 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:12:05.549 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:12:20.378 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:12:20.378 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:12:20.379 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:12:20.379 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:12:20.381 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:12:20.381 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:12:20.381 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:12:20.382 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:12:20.384 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:20.384 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:20.385 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:20.385 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:20.385 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:23.396 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:23.396 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:23.397 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:12:23.397 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:23.398 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:23.398 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:23.399 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:23.400 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:24.708 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:24.709 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:24.710 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:24.710 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:24.710 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:24.711 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:24.711 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:25.895 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:25.896 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:25.896 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:12:25.898 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:12:28.364 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:12:28.365 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:12:28.490 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:12:28.490 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:12:28.493 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:12:28.495 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:12:28.503 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:12:28.503 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:12:28.504 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:12:28.504 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:12:28.539 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:12:28.550 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:12:28.550 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:12:28.551 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:12:28.552 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:12:28.554 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:12:28.569 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:12:28.570 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:12:28.706 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:12:42.764 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:12:42.765 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:12:42.765 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:12:42.765 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:12:42.771 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:12:42.772 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:12:42.772 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:12:42.772 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:12:42.779 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:42.779 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:42.779 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:42.780 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:42.780 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:46.061 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:46.062 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:46.063 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:12:46.064 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:46.065 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:46.065 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:46.066 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:46.067 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:47.088 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:47.089 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:47.090 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:12:47.091 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:12:47.093 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:12:47.093 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:12:47.094 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:12:48.429 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:12:48.430 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:12:48.431 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:12:48.432 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:12:50.854 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:12:50.855 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:12:50.964 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:12:50.964 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:12:50.964 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:12:50.965 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:12:50.966 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:12:50.967 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:12:50.967 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:12:50.968 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:12:50.978 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:12:50.982 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:12:50.982 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:12:50.982 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:12:50.982 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:12:50.982 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:12:50.991 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:12:50.993 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:12:51.051 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:13:04.898 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:13:04.898 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:13:04.899 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:13:04.899 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:13:04.903 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:13:04.904 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:13:04.904 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:13:04.904 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:13:04.910 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:04.910 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:04.911 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:04.914 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:04.914 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:08.116 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:08.117 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:08.117 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:13:08.118 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:08.118 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:08.118 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:08.120 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:08.120 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:09.303 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:09.304 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:09.305 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:09.305 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:09.306 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:09.307 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:09.307 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:10.672 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:10.672 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:10.674 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:13:10.675 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:13:13.233 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:13:13.234 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:13:13.366 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:13:13.366 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:13:13.367 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:13:13.368 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:13:13.369 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:13:13.369 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:13:13.370 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:13:13.370 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:13:13.379 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:13:13.384 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:13:13.384 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:13:13.384 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:13:13.385 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:13:13.385 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:13:13.391 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:13:13.391 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:13:13.442 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:13:27.096 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:13:27.097 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:13:27.098 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:13:27.098 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:13:27.102 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:13:27.103 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:13:27.103 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:13:27.104 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:13:27.109 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:27.110 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:27.110 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:27.111 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:27.112 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:27.123 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:13:27.124 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:13:27.125 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:13:27.126 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:13:27.131 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:13:27.132 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:13:27.133 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:13:27.133 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:13:27.141 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:27.142 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:27.142 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:27.144 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:27.145 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:30.312 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:30.313 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:30.313 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:13:30.313 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:30.313 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:30.313 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:30.315 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:30.315 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:30.362 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:30.362 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:30.363 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:13:30.363 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:30.364 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:30.364 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:30.365 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:30.365 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:31.616 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:31.617 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:31.617 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:31.617 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:31.618 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:31.619 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:31.619 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:31.717 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:31.718 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:31.718 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:31.719 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:31.719 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:31.720 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:31.721 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:32.999 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:32.999 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:33.001 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:13:33.002 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:13:33.097 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:33.098 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:33.098 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:13:33.099 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:13:36.275 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:13:36.276 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:13:36.284 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:13:36.285 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:13:36.395 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:13:36.395 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:13:36.395 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:13:36.396 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:13:36.395 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:13:36.398 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:13:36.398 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:13:36.400 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:13:36.402 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:13:36.402 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:13:36.403 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:13:36.404 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:13:36.404 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:13:36.404 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:13:36.404 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:13:36.405 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:13:36.449 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:13:36.449 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:13:36.489 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:13:36.489 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:13:36.490 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:13:36.490 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:13:36.491 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:13:36.491 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:13:36.492 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:13:36.492 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:13:36.492 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:13:36.492 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:13:36.505 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:13:36.505 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:13:36.506 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:13:36.565 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:13:36.565 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:13:50.458 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:13:50.458 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:13:50.459 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:13:50.459 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:13:50.461 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:13:50.461 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:13:50.462 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:13:50.462 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:13:50.465 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:50.465 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:50.465 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:50.466 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:50.466 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:53.082 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:53.083 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:53.083 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:13:53.083 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:53.084 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:53.084 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:53.084 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:53.085 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:53.807 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:53.807 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:53.808 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:13:53.808 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:13:53.809 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:13:53.809 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:13:53.809 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:13:54.548 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:13:54.548 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:13:54.548 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:13:54.549 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:13:56.354 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:13:56.355 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:13:56.475 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:13:56.475 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:13:56.475 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:13:56.476 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:13:56.477 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:13:56.477 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:13:56.477 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:13:56.478 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:13:56.482 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:13:56.485 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:13:56.485 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:13:56.485 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:13:56.485 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:13:56.486 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:13:56.493 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:13:56.494 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:13:56.522 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:14:08.925 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:14:08.925 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:14:08.926 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:14:08.927 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:14:08.928 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:14:08.929 | INFO     | app.core.model_manager:load_models:93 - 使用新的异构算力卡推理引擎
2025-09-09 16:14:08.929 | INFO     | app.core.model_manager_v2:load_models:51 - 开始加载3个推理引擎实例到池中
2025-09-09 16:14:08.929 | INFO     | app.core.model_manager_v2:load_models:52 - 使用设备类型: cuda
2025-09-09 16:14:08.932 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:14:08.932 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:14:08.932 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:14:08.933 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:14:08.933 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:14:11.978 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:14:11.978 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:14:11.978 | INFO     | app.core.model_manager_v2:load_models:57 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:14:11.979 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:14:11.979 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:14:11.980 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:14:11.980 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:14:11.981 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:14:12.810 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:14:12.810 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:14:12.811 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:14:12.811 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:14:12.811 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:14:12.812 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:14:12.813 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:14:13.695 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:14:13.696 | INFO     | app.core.model_manager_v2:_create_engine:98 - 推理引擎创建成功: cuda
2025-09-09 16:14:13.697 | INFO     | app.core.model_manager_v2:load_models:72 - 成功加载3个推理引擎到池中
2025-09-09 16:14:13.698 | INFO     | app.core.model_manager_v2:_startup_test:113 - 开始启动自检
2025-09-09 16:14:15.732 | INFO     | app.core.model_manager_v2:_startup_test:134 - 自检成功：检测到1张人脸
2025-09-09 16:14:15.733 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:14:15.859 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:14:15.859 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:14:15.860 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:14:15.862 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:14:15.863 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:14:15.864 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:14:15.865 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:14:15.866 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:14:15.875 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:14:15.882 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:14:15.882 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:14:15.883 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:14:15.885 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:14:15.886 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:14:15.929 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'acquire_engine_async'
2025-09-09 16:14:37.108 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'acquire_engine_async'
2025-09-09 16:14:37.109 | WARNING  | app.service.face_service:register_face:80 - 使用默认阈值未检测到人脸，尝试使用更宽松的阈值重新检测
2025-09-09 16:14:37.109 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'acquire_engine_async'
2025-09-09 16:14:37.143 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: 'ModelManager' object has no attribute 'acquire_engine_async'
2025-09-09 16:14:44.920 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:14:44.921 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:14:44.921 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:14:44.972 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:14:44.980 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:14:44.981 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:14:45.016 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:17:51.839 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:17:51.840 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:17:51.841 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:17:51.841 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:17:51.844 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:17:51.845 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:17:51.845 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:17:51.848 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:17:51.849 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:17:51.849 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:17:51.849 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:17:51.850 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:17:55.090 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:17:55.091 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:17:55.092 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:17:55.092 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:17:55.093 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:17:55.093 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:17:55.096 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:17:55.097 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:17:56.532 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:17:56.533 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:17:56.534 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:17:56.535 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:17:56.535 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:17:56.536 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:17:56.537 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:17:58.216 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:17:58.217 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:17:58.217 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:17:58.218 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:18:00.765 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:18:00.766 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:18:00.876 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:18:00.877 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:18:00.877 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:18:00.879 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:18:00.881 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:18:00.882 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:18:00.883 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:18:00.883 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:18:00.894 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:18:00.902 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:18:00.903 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:18:00.903 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:18:00.904 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:18:00.904 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:18:24.095 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:18:24.096 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:18:24.096 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:18:24.139 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:18:24.146 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:18:24.147 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:18:24.181 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:18:38.864 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:18:38.864 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:18:38.864 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:18:38.864 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:18:38.867 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:18:38.867 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:18:38.868 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:18:38.873 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:18:38.873 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:18:38.873 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:18:38.874 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:18:38.874 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:18:41.513 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:18:41.513 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:18:41.514 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:18:41.514 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:18:41.514 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:18:41.514 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:18:41.515 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:18:41.515 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:18:42.336 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:18:42.337 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:18:42.337 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:18:42.337 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:18:42.338 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:18:42.338 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:18:42.338 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:18:43.159 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:18:43.160 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:18:43.160 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:18:43.161 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:18:44.973 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:18:44.973 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:18:45.087 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:18:45.088 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:18:45.088 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:18:45.089 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:18:45.089 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:18:45.090 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:18:45.090 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:18:45.090 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:18:45.095 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:18:45.098 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:18:45.098 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:18:45.098 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:18:45.099 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:18:45.099 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:18:49.204 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:18:49.205 | WARNING  | app.service.face_service:register_face:80 - 使用默认阈值未检测到人脸，尝试使用更宽松的阈值重新检测
2025-09-09 16:18:51.039 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:18:51.134 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:19:07.791 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:19:07.791 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:19:07.792 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:19:07.845 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:19:07.853 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:19:07.853 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:19:07.891 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:19:21.847 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:19:21.848 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:19:21.848 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:19:21.848 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:19:21.854 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:19:21.855 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:19:21.855 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:19:21.861 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:19:21.861 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:19:21.861 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:19:21.861 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:19:21.863 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:19:25.048 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:19:25.048 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:19:25.049 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:19:25.049 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:19:25.050 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:19:25.050 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:19:25.053 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:19:25.054 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:19:26.286 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:19:26.287 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:19:26.287 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:19:26.289 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:19:26.290 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:19:26.292 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:19:26.292 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:19:27.514 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:19:27.514 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:19:27.514 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:19:27.515 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:19:29.744 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:19:29.744 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:19:29.866 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:19:29.866 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:19:29.867 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:19:29.868 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:19:29.870 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:19:29.870 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:19:29.871 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:19:29.871 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:19:29.880 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:19:29.885 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:19:29.886 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:19:29.887 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:19:29.887 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:19:29.888 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:20:19.661 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:20:19.662 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:20:19.663 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:20:19.713 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:20:19.720 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:20:19.720 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:20:19.758 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:20:34.820 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:20:34.820 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:20:34.820 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:20:34.821 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:20:34.825 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:20:34.825 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:20:34.826 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:20:34.832 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:20:34.833 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:20:34.833 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:20:34.834 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:20:34.835 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:20:38.190 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:20:38.191 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:20:38.192 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:20:38.193 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:20:38.194 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:20:38.194 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:20:38.197 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:20:38.197 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:20:39.499 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:20:39.500 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:20:39.500 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:20:39.501 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:20:39.501 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:20:39.503 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:20:39.503 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:20:40.822 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:20:40.823 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:20:40.824 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:20:40.825 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:20:43.550 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:20:43.551 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:20:43.672 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:20:43.672 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:20:43.673 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:20:43.674 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:20:43.677 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:20:43.678 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:20:43.678 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:20:43.679 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:20:43.690 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:20:43.695 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:20:43.695 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:20:43.696 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:20:43.696 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:20:43.697 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:20:43.708 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:20:43.708 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:20:43.760 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:20:57.773 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:20:57.774 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:20:57.774 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:20:57.774 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:20:57.777 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:20:57.778 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:20:57.778 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:20:57.784 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:20:57.784 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:20:57.784 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:20:57.786 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:20:57.787 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:01.122 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:01.123 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:01.123 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:21:01.125 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:21:01.126 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:21:01.127 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:21:01.128 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:21:01.128 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:02.805 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:02.807 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:02.807 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:21:02.808 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:21:02.808 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:21:02.810 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:21:02.811 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:03.011 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:21:03.011 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:21:03.011 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:21:03.012 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:21:03.016 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:21:03.017 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:21:03.018 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:21:03.025 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:21:03.026 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:21:03.027 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:21:03.030 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:21:03.031 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:04.592 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:04.593 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:04.593 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:21:04.594 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:21:05.151 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:05.151 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:05.152 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:21:05.153 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:21:05.154 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:21:05.155 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:21:05.157 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:21:05.158 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:06.882 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:06.882 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:06.883 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:21:06.884 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:21:06.884 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:21:06.885 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:21:06.886 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:21:08.617 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:21:08.618 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:21:08.668 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:21:08.669 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:21:08.670 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:21:08.671 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:21:08.735 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:21:08.735 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:21:08.735 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:21:08.736 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:21:08.738 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:21:08.739 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:21:08.740 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:21:08.740 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:21:08.750 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:21:08.756 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:21:08.756 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:21:08.756 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:21:08.757 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:21:08.757 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:21:11.305 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:21:11.306 | WARNING  | app.service.face_service:register_face:80 - 使用默认阈值未检测到人脸，尝试使用更宽松的阈值重新检测
2025-09-09 16:21:11.802 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:21:11.803 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:21:11.920 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:21:11.921 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:21:11.922 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:21:11.923 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:21:11.926 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:21:11.927 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:21:11.928 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:21:11.929 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:21:11.938 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:21:11.944 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:21:11.945 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:21:11.945 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:21:11.945 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:21:11.946 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:21:11.961 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:21:11.962 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:21:12.014 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:21:14.007 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:21:47.483 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:21:47.483 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:21:47.483 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:21:47.529 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:21:47.539 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:21:47.539 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:21:47.576 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:22:03.762 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:22:03.764 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:22:03.764 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:22:03.764 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:22:03.767 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:22:03.768 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:22:03.768 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:22:03.772 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:22:03.772 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:22:03.773 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:22:03.773 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:22:03.774 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:22:06.247 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:22:06.247 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:22:06.248 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:22:06.248 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:22:06.249 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:22:06.252 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:22:06.254 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:22:06.254 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:22:08.016 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:22:08.018 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:22:08.019 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:22:08.019 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:22:08.020 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:22:08.021 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:22:08.022 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:22:09.912 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:22:09.913 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:22:09.914 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:22:09.915 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:22:13.336 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:22:13.337 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:22:13.464 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:22:13.464 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:22:13.465 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:22:13.467 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:22:13.468 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:22:13.469 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:22:13.469 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:22:13.470 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:22:13.481 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:22:13.487 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:22:13.487 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:22:13.488 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:22:13.488 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:22:13.488 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:22:39.536 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:22:39.536 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:22:39.536 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:22:39.583 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:22:39.589 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:22:39.590 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:22:39.631 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:23:42.342 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:23:42.343 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:23:42.343 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:23:42.343 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:23:42.343 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:23:42.343 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:23:45.262 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:23:46.564 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:23:46.580 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:23:46.580 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:23:46.580 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:23:46.580 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:23:46.589 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:23:46.589 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:23:46.590 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:23:46.593 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:23:46.593 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:23:46.593 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:23:46.594 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:23:46.594 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:23:49.425 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:23:49.425 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:23:49.426 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:23:49.426 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:23:49.426 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:23:49.426 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:23:49.428 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:23:49.428 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:23:50.773 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:23:50.773 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:23:50.773 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:23:50.774 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:23:50.774 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:23:50.776 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:23:50.777 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:23:51.971 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:23:51.972 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:23:51.973 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:23:51.973 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:23:54.306 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:23:54.306 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:23:54.422 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:23:54.422 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:23:54.424 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:23:54.425 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:23:54.427 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:23:54.427 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:23:54.429 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:23:54.429 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:23:54.474 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:23:54.524 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:23:54.524 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:23:54.525 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:23:54.526 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:23:54.526 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:24:01.645 | ERROR    | app.core.inference_adapter:_get_faces_new_inference:72 - 新推理引擎获取人脸失败: can't set attribute 'normed_embedding'
2025-09-09 16:24:20.688 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:24:20.688 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:24:20.688 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:24:20.731 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:24:20.753 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:24:20.753 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:24:20.786 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:27:15.748 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:27:15.749 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:27:15.749 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:27:15.749 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:27:15.753 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:27:15.753 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:27:15.754 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:27:15.760 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:27:15.761 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:27:15.761 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:27:15.762 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:27:15.762 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:27:18.998 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:27:18.998 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:27:18.999 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:27:19.001 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:27:19.001 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:27:19.002 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:27:19.004 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:27:19.004 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:27:20.305 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:27:20.306 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:27:20.307 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:27:20.307 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:27:20.308 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:27:20.308 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:27:20.309 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:27:21.663 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:27:21.663 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:27:21.664 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:27:21.665 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:27:24.439 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:27:24.440 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:27:24.561 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:27:24.561 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:27:24.562 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:27:24.564 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:27:24.565 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:27:24.566 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:27:24.566 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:27:24.567 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:27:24.576 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:27:24.582 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:27:24.582 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:27:24.582 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:27:24.583 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:27:24.583 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:27:38.116 | INFO     | app.service.face_service:register_face:102 - 注册人脸检测成功: 姓名=测试用户Router, SN=test_router_001, 置信度=0.875
2025-09-09 16:27:38.289 | INFO     | app.service.face_dao:create:74 - 成功向 LanceDB 添加记录: SN=test_router_001, Name=测试用户Router
2025-09-09 16:27:40.740 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-09-09 16:27:40.778 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'test_router_001' 的记录。
2025-09-09 16:27:40.810 | INFO     | app.service.face_service:update_face_by_sn:193 - 人员信息已更新: SN=test_router_001, 新数据={'name': '测试用户Router更新'}, 影响记录数=1
2025-09-09 16:27:40.843 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'test_router_001' 的记录。
2025-09-09 16:27:41.054 | INFO     | app.core.pipeline:__init__:186 - 【流水线 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】正在初始化...
2025-09-09 16:27:41.054 | INFO     | app.service.face_service:start_stream:290 - 🚀 视频流线程已启动: ID=e0a57cd9-f2c3-436a-a2ca-c9265187a4c3, TaskID=1234567890, Source=0
2025-09-09 16:27:41.060 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:27:41.066 | INFO     | app.core.pipeline:start:202 - 【流水线 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】正在启动...
2025-09-09 16:27:44.741 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】启动。
2025-09-09 16:27:44.743 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】启动。
2025-09-09 16:27:44.745 | INFO     | app.core.pipeline:_postprocessor_thread:419 - 【T3:后处理 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】启动。
2025-09-09 16:27:44.746 | INFO     | app.core.pipeline:stop:213 - 【流水线 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】正在停止...
2025-09-09 16:27:45.421 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】已停止。
2025-09-09 16:27:45.671 | ERROR    | app.core.pipeline:_inference_thread:390 - 【T2:推理 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】模型推理失败: can't set attribute 'normed_embedding'
2025-09-09 16:27:45.672 | INFO     | app.core.pipeline:_inference_thread:413 - 【T2:推理 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】已停止。
2025-09-09 16:27:45.752 | INFO     | app.core.pipeline:_postprocessor_thread:506 - 【T3:后处理 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】已停止。
2025-09-09 16:27:46.084 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:27:46.084 | WARNING  | app.service.face_service:stop_stream_by_task_id:345 - 视频流线程 TaskID=1234567890 未能及时退出
2025-09-09 16:27:46.085 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】已安全停止。
2025-09-09 16:27:46.086 | INFO     | app.service.face_service:_pipeline_worker_thread:260 - ✅【线程 e0a57cd9-f2c3-436a-a2ca-c9265187a4c3】处理工作已结束。
2025-09-09 16:27:51.544 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:27:51.544 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:27:51.544 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:27:51.593 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:27:51.602 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:27:51.602 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:27:51.649 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:28:07.787 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:28:07.788 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:28:07.788 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:28:07.788 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:28:07.790 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:28:07.790 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:28:07.791 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:28:07.797 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:07.797 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:07.798 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:07.798 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:07.799 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:10.406 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:28:10.407 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:28:10.407 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:28:10.442 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:28:10.464 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:28:10.464 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:28:10.494 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:28:25.420 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:28:25.421 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:28:25.421 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:28:25.421 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:28:25.426 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:28:25.426 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:28:25.426 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:28:25.430 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:25.431 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:25.431 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:25.432 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:25.432 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:28.532 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:28.532 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:28.532 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:28:28.533 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:28.533 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:28.533 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:28.534 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:28.534 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:29.775 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:29.775 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:29.775 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:29.776 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:29.777 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:29.777 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:29.778 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:30.970 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:30.971 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:30.971 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:28:30.972 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:28:33.037 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:28:33.038 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:28:33.167 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:28:33.167 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:28:33.168 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:28:33.170 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:28:33.172 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:28:33.172 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:28:33.173 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:28:33.174 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:28:33.182 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:28:33.185 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:28:33.185 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:28:33.185 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:28:33.185 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:28:33.185 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:28:33.197 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:28:33.198 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:28:33.340 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:28:46.919 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:28:46.920 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:28:46.920 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:28:46.920 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:28:46.929 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:28:46.930 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:28:46.931 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:28:46.940 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:46.941 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:46.943 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:46.945 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:46.945 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:50.470 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:50.472 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:50.472 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:28:50.473 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:50.473 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:50.474 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:50.475 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:50.475 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:51.788 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:51.788 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:51.789 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:28:51.789 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:28:51.790 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:28:51.791 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:28:51.791 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:28:54.030 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:28:54.031 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:28:54.033 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:28:54.035 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:28:56.977 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:28:56.979 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:28:57.092 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:28:57.092 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:28:57.093 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:28:57.093 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:28:57.096 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:28:57.096 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:28:57.097 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:28:57.097 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:28:57.106 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:28:57.113 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:28:57.114 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:28:57.115 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:28:57.116 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:28:57.118 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:28:57.121 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:28:57.122 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:28:57.175 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:29:12.140 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:29:12.141 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:29:12.141 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:29:12.141 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:29:12.145 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:29:12.145 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:29:12.145 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:29:12.149 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:12.150 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:12.150 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:12.152 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:12.152 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:15.491 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:15.493 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:15.494 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:29:15.495 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:15.495 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:15.496 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:15.496 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:15.498 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:16.842 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:16.842 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:16.843 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:16.843 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:16.844 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:16.846 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:16.846 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:18.325 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:18.326 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:18.328 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:29:18.329 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:29:21.058 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:29:21.059 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:29:21.183 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:29:21.184 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:29:21.185 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:29:21.186 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:29:21.188 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:29:21.188 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:29:21.188 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:29:21.189 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:29:21.196 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:29:21.203 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:29:21.203 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:29:21.204 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:29:21.204 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:29:21.206 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:29:21.215 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:29:21.215 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:29:21.267 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:29:36.284 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:29:36.285 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:29:36.286 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:29:36.286 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:29:36.291 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:29:36.291 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:29:36.291 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:29:36.295 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:36.296 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:36.297 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:36.297 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:36.299 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:39.586 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:39.586 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:39.588 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:29:39.589 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:39.590 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:39.591 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:39.592 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:39.592 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:40.912 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:40.914 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:40.918 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:29:40.919 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:29:40.919 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:29:40.921 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:29:40.922 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:29:42.244 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:29:42.245 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:29:42.245 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:29:42.246 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:29:45.082 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:29:45.084 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:29:45.204 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:29:45.205 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:29:45.206 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:29:45.207 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:29:45.209 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:29:45.210 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:29:45.210 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:29:45.211 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:29:45.226 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:29:45.232 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:29:45.234 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:29:45.234 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:29:45.235 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:29:45.235 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:29:45.253 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:29:45.254 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:29:45.358 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:30:00.034 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:30:00.034 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:30:00.035 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:30:00.036 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:30:00.042 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:30:00.043 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:30:00.044 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:30:00.050 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:00.051 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:00.051 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:00.053 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:00.054 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:30:03.330 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:30:03.331 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:30:03.332 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:30:03.333 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:03.334 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:03.334 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:03.335 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:03.336 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:30:04.017 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:30:04.018 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:30:04.019 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:30:04.081 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:30:04.093 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:30:04.094 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:30:04.134 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:30:19.541 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:30:19.542 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:30:19.542 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:30:19.544 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:30:19.547 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:30:19.548 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:30:19.548 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:30:19.554 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:19.554 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:19.555 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:19.556 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:19.556 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:30:22.769 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:30:22.769 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:30:22.769 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:30:22.770 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:22.771 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:22.771 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:22.772 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:22.773 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:30:24.114 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:30:24.115 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:30:24.116 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:24.116 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:24.117 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:24.117 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:24.118 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:30:25.503 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:30:25.504 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:30:25.505 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:30:25.506 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:30:28.381 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:30:28.382 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:30:28.518 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:30:28.519 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:30:28.520 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:30:28.521 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:30:28.522 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:30:28.523 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:30:28.523 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:30:28.524 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:30:28.534 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:30:28.540 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:30:28.540 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:30:28.540 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:30:28.540 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:30:28.540 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:30:30.723 | INFO     | app.service.face_service:register_face:102 - 注册人脸检测成功: 姓名=最终测试用户, SN=final_test_001, 置信度=0.875
2025-09-09 16:30:30.754 | INFO     | app.service.face_dao:create:74 - 成功向 LanceDB 添加记录: SN=final_test_001, Name=最终测试用户
2025-09-09 16:30:33.105 | WARNING  | app.service.face_dao:update_by_sn:111 - LanceDB 的更新操作通过“删除+新增”实现，可能影响性能。
2025-09-09 16:30:33.132 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'final_test_001' 的记录。
2025-09-09 16:30:33.154 | INFO     | app.service.face_service:update_face_by_sn:193 - 人员信息已更新: SN=final_test_001, 新数据={'name': '最终测试用户更新'}, 影响记录数=1
2025-09-09 16:30:33.175 | INFO     | app.service.face_dao:delete_by_sn:102 - 成功从 LanceDB 中删除 1 条 SN 为 'final_test_001' 的记录。
2025-09-09 16:30:33.334 | INFO     | app.core.pipeline:__init__:186 - 【流水线 20f2a5fe-cf85-420d-9186-563c08ccea88】正在初始化...
2025-09-09 16:30:33.334 | INFO     | app.service.face_service:start_stream:290 - 🚀 视频流线程已启动: ID=20f2a5fe-cf85-420d-9186-563c08ccea88, TaskID=9876543210, Source=0
2025-09-09 16:30:33.337 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:30:33.341 | INFO     | app.core.pipeline:start:202 - 【流水线 20f2a5fe-cf85-420d-9186-563c08ccea88】正在启动...
2025-09-09 16:30:35.857 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 20f2a5fe-cf85-420d-9186-563c08ccea88】启动。
2025-09-09 16:30:35.858 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 20f2a5fe-cf85-420d-9186-563c08ccea88】启动。
2025-09-09 16:30:35.859 | INFO     | app.core.pipeline:_postprocessor_thread:419 - 【T3:后处理 20f2a5fe-cf85-420d-9186-563c08ccea88】启动。
2025-09-09 16:30:35.859 | INFO     | app.core.pipeline:stop:213 - 【流水线 20f2a5fe-cf85-420d-9186-563c08ccea88】正在停止...
2025-09-09 16:30:36.215 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 20f2a5fe-cf85-420d-9186-563c08ccea88】已停止。
2025-09-09 16:30:36.431 | INFO     | app.core.pipeline:_inference_thread:413 - 【T2:推理 20f2a5fe-cf85-420d-9186-563c08ccea88】已停止。
2025-09-09 16:30:36.450 | INFO     | app.core.pipeline:_postprocessor_thread:514 - 【T3:后处理 20f2a5fe-cf85-420d-9186-563c08ccea88】已停止。
2025-09-09 16:30:36.762 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:30:36.763 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 20f2a5fe-cf85-420d-9186-563c08ccea88】已安全停止。
2025-09-09 16:30:36.764 | INFO     | app.service.face_service:_pipeline_worker_thread:260 - ✅【线程 20f2a5fe-cf85-420d-9186-563c08ccea88】处理工作已结束。
2025-09-09 16:30:36.765 | INFO     | app.service.face_service:stop_stream_by_task_id:347 - ✅ 视频流已成功停止: TaskID=9876543210, StreamID=20f2a5fe-cf85-420d-9186-563c08ccea88
2025-09-09 16:30:43.725 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:30:43.726 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:30:43.726 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:30:43.779 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:30:43.789 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:30:43.790 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:30:43.847 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:30:58.488 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:30:58.488 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:30:58.489 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:30:58.489 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:30:58.496 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:30:58.498 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:30:58.498 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:30:58.505 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:30:58.506 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:30:58.506 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:30:58.507 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:30:58.508 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:31:00.846 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:31:00.847 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:31:00.847 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:31:00.895 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:31:00.920 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:31:00.921 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:31:00.962 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:31:09.791 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:31:09.792 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:31:09.792 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:31:09.793 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:31:09.794 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:31:09.794 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:31:11.944 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:31:12.974 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:31:12.993 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:31:12.993 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:31:12.994 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:31:12.995 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:31:12.998 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:31:12.998 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:31:12.998 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:31:13.001 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:31:13.001 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:31:13.001 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:31:13.002 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:31:13.002 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:31:15.689 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:31:15.689 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:31:15.690 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:31:15.690 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:31:15.690 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:31:15.691 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:31:15.692 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:31:15.692 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:31:16.567 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:31:16.568 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:31:16.568 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:31:16.568 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:31:16.569 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:31:16.569 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:31:16.569 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:31:17.437 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:31:17.437 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:31:17.438 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:31:17.438 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:31:19.333 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:31:19.334 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:31:19.440 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:31:19.441 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:31:19.441 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:31:19.442 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:31:19.443 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:31:19.443 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:31:19.443 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:31:19.444 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:31:19.448 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:31:19.451 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:31:19.452 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:31:19.452 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:31:19.452 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:31:19.452 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:31:47.111 | INFO     | app.core.pipeline:__init__:186 - 【流水线 f3de2747-bda6-4498-86a6-3e992d8fd2eb】正在初始化...
2025-09-09 16:31:47.113 | INFO     | app.service.face_service:start_stream:290 - 🚀 视频流线程已启动: ID=f3de2747-bda6-4498-86a6-3e992d8fd2eb, TaskID=1, Source=0
2025-09-09 16:31:47.122 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:31:47.127 | INFO     | app.core.pipeline:start:202 - 【流水线 f3de2747-bda6-4498-86a6-3e992d8fd2eb】正在启动...
2025-09-09 16:31:48.066 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 f3de2747-bda6-4498-86a6-3e992d8fd2eb】启动。
2025-09-09 16:31:48.067 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 f3de2747-bda6-4498-86a6-3e992d8fd2eb】启动。
2025-09-09 16:31:48.068 | INFO     | app.core.pipeline:_postprocessor_thread:419 - 【T3:后处理 f3de2747-bda6-4498-86a6-3e992d8fd2eb】启动。
2025-09-09 16:32:07.112 | INFO     | app.service.face_service:get_stream_feed_by_task_id:424 - 客户端从流 TaskID=1 断开: Cancelled by cancel scope 2b4f01c2200
2025-09-09 16:32:59.582 | INFO     | app.core.pipeline:stop:213 - 【流水线 f3de2747-bda6-4498-86a6-3e992d8fd2eb】正在停止...
2025-09-09 16:32:59.606 | INFO     | app.core.pipeline:_inference_thread:413 - 【T2:推理 f3de2747-bda6-4498-86a6-3e992d8fd2eb】已停止。
2025-09-09 16:32:59.608 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 f3de2747-bda6-4498-86a6-3e992d8fd2eb】已停止。
2025-09-09 16:32:59.615 | INFO     | app.core.pipeline:_postprocessor_thread:514 - 【T3:后处理 f3de2747-bda6-4498-86a6-3e992d8fd2eb】已停止。
2025-09-09 16:32:59.894 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:32:59.895 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 f3de2747-bda6-4498-86a6-3e992d8fd2eb】已安全停止。
2025-09-09 16:32:59.896 | INFO     | app.service.face_service:_pipeline_worker_thread:260 - ✅【线程 f3de2747-bda6-4498-86a6-3e992d8fd2eb】处理工作已结束。
2025-09-09 16:32:59.899 | INFO     | app.service.face_service:stop_stream_by_task_id:347 - ✅ 视频流已成功停止: TaskID=1, StreamID=f3de2747-bda6-4498-86a6-3e992d8fd2eb
2025-09-09 16:32:59.904 | INFO     | app.service.face_service:get_stream_feed_by_task_id:420 - 视频流 TaskID=1 已结束
2025-09-09 16:33:23.781 | INFO     | app.core.pipeline:__init__:186 - 【流水线 bffb14e9-ba5f-4cad-8ee5-ac4615e06daf】正在初始化...
2025-09-09 16:33:23.782 | INFO     | app.service.face_service:start_stream:290 - 🚀 视频流线程已启动: ID=bffb14e9-ba5f-4cad-8ee5-ac4615e06daf, TaskID=1, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-09-09 16:33:23.794 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:33:23.800 | INFO     | app.core.pipeline:start:202 - 【流水线 bffb14e9-ba5f-4cad-8ee5-ac4615e06daf】正在启动...
2025-09-09 16:33:24.077 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 bffb14e9-ba5f-4cad-8ee5-ac4615e06daf】启动。
2025-09-09 16:33:24.078 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 bffb14e9-ba5f-4cad-8ee5-ac4615e06daf】启动。
2025-09-09 16:33:24.079 | INFO     | app.core.pipeline:_postprocessor_thread:419 - 【T3:后处理 bffb14e9-ba5f-4cad-8ee5-ac4615e06daf】启动。
2025-09-09 16:33:25.315 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:33:28.419 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:33:31.490 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:33:34.619 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:33:37.669 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:33:40.717 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:33:43.802 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:33:46.865 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:33:50.476 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:33:53.593 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:33:56.689 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:33:59.776 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:34:02.933 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:34:06.069 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:34:09.278 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:34:12.580 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:34:15.672 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:18.772 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:34:21.902 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:34:25.027 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:34:28.148 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:34:31.220 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:34.290 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:34:37.721 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:40.755 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:43.839 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:34:46.922 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:34:50.094 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:53.146 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 16:34:56.211 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 2 条检测结果
2025-09-09 16:34:59.370 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 16:35:02.418 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 16:35:05.599 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:35:07.000 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:35:07.001 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:35:07.002 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:35:07.108 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:35:07.245 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:35:07.247 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:35:07.692 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:39:51.621 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:39:51.622 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:39:51.622 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:39:51.623 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:39:51.623 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:39:51.624 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:39:55.322 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:39:56.795 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:39:56.811 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:39:56.811 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:39:56.811 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:39:56.812 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:39:56.818 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:39:56.818 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:39:56.819 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:39:56.821 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:39:56.821 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:39:56.822 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:39:56.822 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:39:56.822 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:00.171 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:00.171 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:00.171 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:40:00.172 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:40:00.172 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:40:00.172 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:40:00.173 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:40:00.174 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:01.023 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:01.025 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:01.025 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:40:01.026 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:40:01.026 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:40:01.027 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:40:01.027 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:02.046 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:02.046 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:02.047 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:40:02.048 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:40:05.870 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:40:05.870 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:40:06.004 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:40:06.004 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:40:06.005 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:40:06.006 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:40:06.006 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:40:06.007 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:40:06.007 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:40:06.007 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:40:06.014 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:40:06.021 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:40:06.021 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:40:06.022 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:40:06.022 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:40:06.022 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:40:17.126 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:40:17.127 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:40:17.127 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:40:17.127 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:40:17.142 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:40:17.143 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:40:17.143 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:40:17.147 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:40:17.148 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:40:17.148 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:40:17.149 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:40:17.149 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:19.740 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:19.741 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:19.743 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:40:19.744 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:40:19.745 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:40:19.746 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:40:19.747 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:40:19.748 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:22.570 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:22.571 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:22.571 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:40:22.572 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:40:22.572 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:40:22.573 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:40:22.573 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:40:24.623 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:40:24.624 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:40:24.625 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:40:24.626 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:40:28.333 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:40:28.334 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:40:28.452 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:40:28.453 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:40:28.453 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:40:28.455 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:40:28.457 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:40:28.458 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:40:28.458 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:40:28.459 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:40:28.500 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:40:28.541 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:40:28.541 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:40:28.543 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:40:28.544 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:40:28.544 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:40:56.654 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=07b26823-ffd9-4584-bbfd-71bad359777c, TaskID=1234567890, Source=0
2025-09-09 16:40:56.659 | INFO     | app.core.pipeline:__init__:186 - 【流水线 07b26823-ffd9-4584-bbfd-71bad359777c】正在初始化...
2025-09-09 16:40:56.666 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:40:56.671 | INFO     | app.core.pipeline:start:202 - 【流水线 07b26823-ffd9-4584-bbfd-71bad359777c】正在启动...
2025-09-09 16:41:00.544 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 07b26823-ffd9-4584-bbfd-71bad359777c】启动。
2025-09-09 16:41:00.547 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 07b26823-ffd9-4584-bbfd-71bad359777c】启动。
2025-09-09 16:41:00.548 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 07b26823-ffd9-4584-bbfd-71bad359777c】启动。
2025-09-09 16:41:00.548 | INFO     | app.core.pipeline:stop:213 - 【流水线 07b26823-ffd9-4584-bbfd-71bad359777c】正在停止...
2025-09-09 16:41:01.177 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 07b26823-ffd9-4584-bbfd-71bad359777c】已停止。
2025-09-09 16:41:01.558 | INFO     | app.core.pipeline:_postprocessor_thread:524 - 【T3:后处理 07b26823-ffd9-4584-bbfd-71bad359777c】已停止。
2025-09-09 16:41:02.166 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:41:02.166 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:41:02.166 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:41:02.237 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:41:02.267 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:41:02.268 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:41:02.322 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:41:04.022 | INFO     | app.core.pipeline:_inference_thread:423 - 【T2:推理 07b26823-ffd9-4584-bbfd-71bad359777c】已停止。
2025-09-09 16:41:04.398 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:41:04.399 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 07b26823-ffd9-4584-bbfd-71bad359777c】已安全停止。
2025-09-09 16:41:04.399 | INFO     | app.service.face_service:_pipeline_worker_thread:280 - ✅【线程 07b26823-ffd9-4584-bbfd-71bad359777c】处理工作已结束。
2025-09-09 16:41:04.405 | INFO     | app.service.face_service:stop_stream_by_task_id:367 - ✅ 视频流已成功停止: TaskID=1234567890, StreamID=07b26823-ffd9-4584-bbfd-71bad359777c
2025-09-09 16:41:09.891 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:41:09.891 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:41:09.892 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:41:09.951 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:41:09.964 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:41:09.964 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:41:10.011 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:41:22.674 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:41:22.676 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:41:22.676 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:41:22.677 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:41:22.678 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:41:22.678 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:41:25.527 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:41:26.699 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:41:26.717 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:41:26.717 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:41:26.718 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:41:26.718 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:41:26.721 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:41:26.721 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:41:26.721 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:41:26.725 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:41:26.726 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:41:26.726 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:41:26.726 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:41:26.727 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:41:29.611 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:41:29.612 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:41:29.612 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:41:29.613 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:41:29.613 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:41:29.613 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:41:29.614 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:41:29.614 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:41:30.575 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:41:30.576 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:41:30.576 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:41:30.577 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:41:30.577 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:41:30.578 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:41:30.578 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:41:31.558 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:41:31.558 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:41:31.559 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:41:31.560 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:41:33.478 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:41:33.479 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:41:33.594 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:41:33.595 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:41:33.595 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:41:33.596 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:41:33.597 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:41:33.597 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:41:33.597 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:41:33.598 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:41:33.603 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:41:33.605 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:41:33.606 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:41:33.606 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:41:33.606 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:41:33.606 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:42:14.763 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=ffccf42f-215d-4a8f-a4b8-79a716150a7e, TaskID=1, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-09-09 16:42:14.764 | INFO     | app.core.pipeline:__init__:186 - 【流水线 ffccf42f-215d-4a8f-a4b8-79a716150a7e】正在初始化...
2025-09-09 16:42:14.770 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:42:14.774 | INFO     | app.core.pipeline:start:202 - 【流水线 ffccf42f-215d-4a8f-a4b8-79a716150a7e】正在启动...
2025-09-09 16:42:14.986 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 ffccf42f-215d-4a8f-a4b8-79a716150a7e】启动。
2025-09-09 16:42:14.987 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 ffccf42f-215d-4a8f-a4b8-79a716150a7e】启动。
2025-09-09 16:42:14.988 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 ffccf42f-215d-4a8f-a4b8-79a716150a7e】启动。
2025-09-09 16:42:15.979 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:42:19.089 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:42:22.191 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:42:25.288 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:42:28.345 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:42:31.442 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:42:34.533 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:42:37.602 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:42:40.657 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:42:43.761 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:42:46.855 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:42:49.903 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:42:53.007 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:42:56.071 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:42:59.158 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:43:02.267 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:43:02.437 | INFO     | app.core.pipeline:stop:213 - 【流水线 ffccf42f-215d-4a8f-a4b8-79a716150a7e】正在停止...
2025-09-09 16:43:02.463 | INFO     | app.core.pipeline:_postprocessor_thread:524 - 【T3:后处理 ffccf42f-215d-4a8f-a4b8-79a716150a7e】已停止。
2025-09-09 16:43:02.467 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 ffccf42f-215d-4a8f-a4b8-79a716150a7e】已停止。
2025-09-09 16:43:02.491 | INFO     | app.core.pipeline:_inference_thread:423 - 【T2:推理 ffccf42f-215d-4a8f-a4b8-79a716150a7e】已停止。
2025-09-09 16:43:02.516 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:43:02.517 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 ffccf42f-215d-4a8f-a4b8-79a716150a7e】已安全停止。
2025-09-09 16:43:02.517 | INFO     | app.service.face_service:_pipeline_worker_thread:280 - ✅【线程 ffccf42f-215d-4a8f-a4b8-79a716150a7e】处理工作已结束。
2025-09-09 16:43:02.519 | INFO     | app.service.face_service:stop_stream_by_task_id:367 - ✅ 视频流已成功停止: TaskID=1, StreamID=ffccf42f-215d-4a8f-a4b8-79a716150a7e
2025-09-09 16:43:02.523 | INFO     | app.service.face_service:get_stream_feed_by_task_id:440 - 视频流 TaskID=1 已结束
2025-09-09 16:43:02.525 | INFO     | app.service.face_service:get_stream_feed_by_task_id:440 - 视频流 TaskID=1 已结束
2025-09-09 16:43:31.286 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:43:31.287 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:43:31.287 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:43:31.331 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:43:31.363 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:43:31.364 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:43:31.401 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:45:14.934 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:45:14.936 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:45:14.936 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:45:14.939 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:45:14.941 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:45:14.941 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:45:20.918 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:45:23.294 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:45:23.339 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:45:23.340 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:45:23.340 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:45:23.342 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:45:23.377 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:45:23.377 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:45:23.378 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:45:23.385 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:45:23.386 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:45:23.387 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:45:23.388 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:45:23.389 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:45:31.486 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:45:31.490 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:45:31.494 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:45:31.498 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:45:31.500 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:45:31.505 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:45:31.508 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:45:31.514 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:45:38.370 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:45:38.370 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:45:38.371 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:45:38.371 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:45:38.373 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:45:38.377 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:45:38.378 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:45:40.658 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:45:40.658 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:45:40.659 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:45:40.660 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:45:45.687 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:45:45.688 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:45:45.819 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:45:45.820 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:45:45.821 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:45:45.822 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:45:45.825 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:45:45.827 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:45:45.827 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:45:45.828 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:45:45.884 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:45:45.946 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:45:45.947 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:45:45.947 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:45:45.949 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:45:45.951 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:46:04.882 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=661d643b-80e9-4468-b4c3-25654e6517f5, TaskID=1, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-09-09 16:46:04.885 | INFO     | app.core.pipeline:__init__:186 - 【流水线 661d643b-80e9-4468-b4c3-25654e6517f5】正在初始化...
2025-09-09 16:46:04.892 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:46:04.896 | INFO     | app.core.pipeline:start:202 - 【流水线 661d643b-80e9-4468-b4c3-25654e6517f5】正在启动...
2025-09-09 16:46:05.141 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 661d643b-80e9-4468-b4c3-25654e6517f5】启动。
2025-09-09 16:46:05.142 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】启动。
2025-09-09 16:46:05.144 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 661d643b-80e9-4468-b4c3-25654e6517f5】启动。
2025-09-09 16:46:07.439 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:46:10.509 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:46:13.587 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 7 条检测结果
2025-09-09 16:46:16.680 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:46:19.801 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:46:22.899 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:46:25.958 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:46:29.020 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:46:32.121 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 9 条检测结果
2025-09-09 16:46:35.173 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 5 条检测结果
2025-09-09 16:46:38.292 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:46:41.360 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 3 条检测结果
2025-09-09 16:46:42.831 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:46:42.832 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:46:42.832 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:46:42.893 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:46:42.931 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1 断开: 
2025-09-09 16:46:42.958 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:46:42.959 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:46:42.961 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:46:42.964 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:46:42.998 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:46:43.015 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:46:43.016 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:46:43.020 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 661d643b-80e9-4468-b4c3-25654e6517f5】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:47:21.659 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:47:21.660 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:47:21.660 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:47:21.661 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:47:21.673 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:47:21.673 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:47:21.673 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:47:21.680 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:47:21.680 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:47:21.680 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:47:21.681 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:47:21.682 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:47:25.542 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:47:25.542 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:47:25.543 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:47:25.544 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:47:25.545 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:47:25.545 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:47:25.547 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:47:25.548 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:47:27.252 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:47:27.252 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:47:27.252 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:47:27.253 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:47:27.254 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:47:27.255 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:47:27.255 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:47:28.936 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:47:28.936 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:47:28.937 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:47:28.938 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:47:32.254 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:47:32.255 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:47:32.378 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:47:32.378 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:47:32.379 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:47:32.380 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:47:32.382 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:47:32.383 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:47:32.384 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:47:32.385 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:47:32.436 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:47:32.483 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:47:32.484 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:47:32.484 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:47:32.485 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:47:32.487 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:47:32.792 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=9ae0edc8-88c3-4a61-98bb-7dbe05423305, TaskID=1111111111, Source=0
2025-09-09 16:47:32.796 | INFO     | app.core.pipeline:__init__:186 - 【流水线 9ae0edc8-88c3-4a61-98bb-7dbe05423305】正在初始化...
2025-09-09 16:47:32.804 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:47:32.813 | INFO     | app.core.pipeline:start:202 - 【流水线 9ae0edc8-88c3-4a61-98bb-7dbe05423305】正在启动...
2025-09-09 16:47:35.834 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 25f940237c0
2025-09-09 16:47:35.836 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 25f94020c70
2025-09-09 16:47:35.838 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 25f94022ef0
2025-09-09 16:47:37.116 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 9ae0edc8-88c3-4a61-98bb-7dbe05423305】启动。
2025-09-09 16:47:37.118 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 9ae0edc8-88c3-4a61-98bb-7dbe05423305】启动。
2025-09-09 16:47:37.121 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 9ae0edc8-88c3-4a61-98bb-7dbe05423305】启动。
2025-09-09 16:48:21.798 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:48:21.799 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:48:21.799 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:21.897 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:48:21.941 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:48:21.943 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:21.944 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 9ae0edc8-88c3-4a61-98bb-7dbe05423305】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:48:21.993 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 9ae0edc8-88c3-4a61-98bb-7dbe05423305】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:48:22.015 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:48:22.017 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 9ae0edc8-88c3-4a61-98bb-7dbe05423305】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:48:42.452 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:48:42.453 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:48:42.454 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:48:42.454 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:48:42.456 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:48:42.456 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:48:42.456 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:48:42.457 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:48:42.458 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:48:42.459 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:48:42.459 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:48:42.462 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:48:42.462 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:48:42.462 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:48:42.466 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:42.467 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:42.468 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:42.469 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:42.469 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:42.469 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:42.470 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:42.471 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:42.472 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:42.473 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:46.628 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:46.631 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:46.631 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:48:46.633 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:46.635 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:46.637 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:46.638 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:46.639 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:46.735 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:46.736 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:46.737 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:48:46.738 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:46.739 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:46.740 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:46.742 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:46.743 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:48.935 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:48.936 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:48.937 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:48.936 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:48.937 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:48.940 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:48.938 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:48:48.940 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:48:48.941 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:48.942 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:48:48.943 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:48.943 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:48:48.943 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:48.943 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:48:50.975 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:50.975 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:48:50.976 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:50.976 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:48:50.977 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:48:50.977 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:48:50.978 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:48:50.978 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:48:54.596 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:48:54.597 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:48:54.598 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:48:54.600 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:48:54.714 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:48:54.714 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:48:54.714 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:48:54.714 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:48:54.715 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:48:54.715 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:48:54.716 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:48:54.717 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:48:54.718 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:48:54.719 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:48:54.719 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:48:54.720 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:48:54.719 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:48:54.721 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:48:54.721 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:48:54.722 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:48:54.769 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:48:54.769 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:48:54.816 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:48:54.816 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:48:54.816 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:48:54.817 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:48:54.816 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:48:54.816 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:48:54.818 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:48:54.819 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:48:54.817 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:48:54.818 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:48:54.822 | INFO     | app.main:lifespan:80 - 应用程序正在关闭... 开始执行清理任务。
2025-09-09 16:48:54.824 | INFO     | app.main:lifespan:89 - ✅ 视频流清理任务已取消。
2025-09-09 16:48:54.825 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-09 16:48:55.622 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-09 16:48:55.623 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-09 16:48:55.623 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-09 16:48:55.624 | INFO     | app.service.face_service:stop_all_streams:483 - 没有活动的视频流需要停止
2025-09-09 16:48:55.624 | INFO     | app.main:lifespan:103 - ✅ 所有视频流已停止。
2025-09-09 16:48:55.624 | INFO     | app.core.model_manager:cleanup:313 - 清理模型池资源
2025-09-09 16:48:55.624 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:48:55.677 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:48:55.678 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:48:55.727 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:48:55.728 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:48:55.883 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:48:55.885 | INFO     | app.core.model_manager:cleanup:327 - 模型池已清空
2025-09-09 16:48:55.886 | INFO     | app.main:lifespan:110 - ✅ 模型资源已释放。
2025-09-09 16:48:55.886 | INFO     | app.core.degirum_cleanup:force_cleanup:155 - 执行强制Degirum资源清理
2025-09-09 16:48:55.887 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:55.961 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:48:56.181 | INFO     | app.core.degirum_cleanup:force_cleanup:164 - Degirum资源强制清理完成
2025-09-09 16:48:56.183 | INFO     | app.main:lifespan:117 - ✅ Degirum资源已清理。
2025-09-09 16:48:56.184 | INFO     | app.main:lifespan:121 - ✅ 所有清理任务完成。
2025-09-09 16:48:56.186 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:48:56.187 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:56.251 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:48:58.108 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:48:58.108 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:48:58.109 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:58.178 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:48:58.197 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:48:58.198 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:48:58.307 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:49:18.389 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:49:18.391 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:49:18.392 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:49:18.392 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:49:18.398 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:49:18.399 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:49:18.400 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:49:18.409 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:49:18.411 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:49:18.413 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:49:18.414 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:49:18.415 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:49:22.136 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:49:22.137 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:49:22.139 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:49:22.139 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:49:22.140 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:49:22.140 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:49:22.142 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:49:22.143 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:49:23.836 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:49:23.839 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:49:23.839 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:49:23.840 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:49:23.840 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:49:23.842 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:49:23.843 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:49:25.269 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:49:25.269 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:49:25.269 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:49:25.269 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:49:27.997 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:49:27.997 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:49:28.134 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:49:28.135 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:49:28.136 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:49:28.137 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:49:28.138 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:49:28.138 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:49:28.139 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:49:28.141 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:49:28.148 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:49:28.156 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:49:28.157 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:49:28.158 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:49:28.158 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:49:28.158 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:49:54.017 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=bd33181d-1395-4e2a-86a2-2e9fc71a581a, TaskID=9876543210, Source=0
2025-09-09 16:49:54.021 | INFO     | app.core.pipeline:__init__:186 - 【流水线 bd33181d-1395-4e2a-86a2-2e9fc71a581a】正在初始化...
2025-09-09 16:49:54.029 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:49:54.034 | INFO     | app.core.pipeline:start:202 - 【流水线 bd33181d-1395-4e2a-86a2-2e9fc71a581a】正在启动...
2025-09-09 16:49:58.209 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 bd33181d-1395-4e2a-86a2-2e9fc71a581a】启动。
2025-09-09 16:49:58.211 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 bd33181d-1395-4e2a-86a2-2e9fc71a581a】启动。
2025-09-09 16:49:58.214 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 bd33181d-1395-4e2a-86a2-2e9fc71a581a】启动。
2025-09-09 16:49:59.047 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=9876543210 断开: Cancelled by cancel scope 2266d4dcbe0
2025-09-09 16:49:59.059 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=05f714e1-a51b-496c-b747-43648e8f6fcb, TaskID=1111111111, Source=0
2025-09-09 16:49:59.062 | INFO     | app.core.pipeline:__init__:186 - 【流水线 05f714e1-a51b-496c-b747-43648e8f6fcb】正在初始化...
2025-09-09 16:49:59.071 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:49:59.082 | INFO     | app.core.pipeline:start:202 - 【流水线 05f714e1-a51b-496c-b747-43648e8f6fcb】正在启动...
2025-09-09 16:50:02.099 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 22684c43d60
2025-09-09 16:50:02.100 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 22684c792d0
2025-09-09 16:50:02.101 | INFO     | app.service.face_service:get_stream_feed_by_task_id:452 - 客户端从流 TaskID=1111111111 断开: Cancelled by cancel scope 22684c78640
2025-09-09 16:50:02.807 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 05f714e1-a51b-496c-b747-43648e8f6fcb】启动。
2025-09-09 16:50:02.809 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】启动。
2025-09-09 16:50:02.810 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 05f714e1-a51b-496c-b747-43648e8f6fcb】启动。
2025-09-09 16:50:07.392 | ERROR    | app.core.pipeline:_reader_thread:283 - 【T1:读帧 bd33181d-1395-4e2a-86a2-2e9fc71a581a】连续10次读帧失败，流可能已断开。
2025-09-09 16:50:07.393 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 bd33181d-1395-4e2a-86a2-2e9fc71a581a】已停止。
2025-09-09 16:50:07.393 | INFO     | app.core.pipeline:_inference_thread:423 - 【T2:推理 bd33181d-1395-4e2a-86a2-2e9fc71a581a】已停止。
2025-09-09 16:50:07.394 | INFO     | app.core.pipeline:_postprocessor_thread:524 - 【T3:后处理 bd33181d-1395-4e2a-86a2-2e9fc71a581a】已停止。
2025-09-09 16:50:08.277 | ERROR    | app.service.face_service:_pipeline_worker_thread:253 - 【线程 bd33181d-1395-4e2a-86a2-2e9fc71a581a】检测到内部流水线线程异常终止，正在停止...
2025-09-09 16:50:08.279 | INFO     | app.core.pipeline:stop:213 - 【流水线 bd33181d-1395-4e2a-86a2-2e9fc71a581a】正在停止...
2025-09-09 16:50:08.335 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:50:08.337 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 bd33181d-1395-4e2a-86a2-2e9fc71a581a】已安全停止。
2025-09-09 16:50:08.338 | INFO     | app.service.face_service:_pipeline_worker_thread:280 - ✅【线程 bd33181d-1395-4e2a-86a2-2e9fc71a581a】处理工作已结束。
2025-09-09 16:50:49.793 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:50:49.794 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:50:49.794 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:50:49.870 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:50:50.017 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:50:50.018 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:50:50.021 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:50:50.022 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:50:50.056 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:50:50.079 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:50:50.096 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:50:50.134 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:50:50.135 | ERROR    | app.core.pipeline:_inference_thread:400 - 【T2:推理 05f714e1-a51b-496c-b747-43648e8f6fcb】模型推理失败: cannot schedule new futures after interpreter shutdown
2025-09-09 16:51:08.508 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:51:08.508 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:51:08.509 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:51:08.509 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:51:08.514 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:51:08.514 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:51:08.514 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:51:08.519 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:51:08.520 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:51:08.520 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:51:08.522 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:51:08.522 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:51:11.784 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:51:11.785 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:51:11.785 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:51:11.786 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:51:11.787 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:51:11.787 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:51:11.789 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:51:11.790 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:51:13.056 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:51:13.057 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:51:13.058 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:51:13.058 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:51:13.058 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:51:13.059 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:51:13.060 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:51:14.355 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:51:14.357 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:51:14.358 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:51:14.361 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:51:17.133 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:51:17.133 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:51:17.250 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:51:17.251 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:51:17.251 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:51:17.253 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:51:17.254 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:51:17.254 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:51:17.255 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:51:17.255 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:51:17.264 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:51:17.271 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:51:17.271 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:51:17.271 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:51:17.272 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:51:17.272 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:52:59.469 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:52:59.470 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:52:59.471 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:52:59.472 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:52:59.472 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:52:59.472 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:53:02.222 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:53:03.493 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:53:03.512 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:53:03.513 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:53:03.513 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:53:03.513 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:53:03.521 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:53:03.521 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:53:03.522 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:53:03.524 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:03.524 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:03.526 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:03.528 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:03.529 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:04.774 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:04.774 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:04.774 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:53:04.775 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:04.775 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:04.776 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:04.776 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:04.777 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:05.666 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:05.667 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:05.667 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:05.667 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:05.667 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:05.668 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:05.668 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:06.583 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:06.584 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:06.584 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:53:06.585 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:53:08.655 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:53:08.655 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:53:08.767 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:53:08.768 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:53:08.768 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:53:08.769 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:53:08.770 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:53:08.770 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:53:08.770 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:53:08.771 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:53:08.802 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:53:08.846 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:53:08.847 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:53:08.847 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:53:08.847 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:53:08.847 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:53:08.848 | INFO     | app.main:lifespan:80 - 应用程序正在关闭... 开始执行清理任务。
2025-09-09 16:53:08.849 | INFO     | app.main:lifespan:89 - ✅ 视频流清理任务已取消。
2025-09-09 16:53:08.849 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-09 16:53:09.678 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-09 16:53:09.679 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-09 16:53:09.680 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-09 16:53:09.681 | INFO     | app.service.face_service:stop_all_streams:483 - 没有活动的视频流需要停止
2025-09-09 16:53:09.681 | INFO     | app.main:lifespan:103 - ✅ 所有视频流已停止。
2025-09-09 16:53:09.682 | INFO     | app.core.model_manager:cleanup:313 - 清理模型池资源
2025-09-09 16:53:09.684 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:09.734 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:09.734 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:09.777 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:09.778 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:09.874 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:09.875 | INFO     | app.core.model_manager:cleanup:327 - 模型池已清空
2025-09-09 16:53:09.875 | INFO     | app.main:lifespan:110 - ✅ 模型资源已释放。
2025-09-09 16:53:09.876 | INFO     | app.core.degirum_cleanup:force_cleanup:155 - 执行强制Degirum资源清理
2025-09-09 16:53:09.876 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:53:09.936 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:53:10.029 | INFO     | app.core.degirum_cleanup:force_cleanup:164 - Degirum资源强制清理完成
2025-09-09 16:53:10.029 | INFO     | app.main:lifespan:117 - ✅ Degirum资源已清理。
2025-09-09 16:53:10.029 | INFO     | app.main:lifespan:121 - ✅ 所有清理任务完成。
2025-09-09 16:53:10.031 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:53:10.031 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:53:10.062 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:53:29.969 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:53:29.970 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:53:29.970 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:53:29.971 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:53:29.971 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:53:29.971 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:53:31.910 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:53:32.615 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:53:32.632 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:53:32.632 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:53:32.632 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:53:32.632 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:53:32.635 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:53:32.635 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:53:32.635 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:53:32.639 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:32.639 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:32.639 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:32.641 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:32.641 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:33.611 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:33.612 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:33.612 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:53:33.612 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:33.613 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:33.613 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:33.614 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:33.614 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:34.426 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:34.427 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:34.427 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:53:34.428 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:53:34.428 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:53:34.429 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:53:34.429 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:53:35.264 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:53:35.264 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:53:35.265 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:53:35.265 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:53:37.061 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:53:37.062 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:53:37.189 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:53:37.189 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:53:37.190 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:53:37.191 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:53:37.191 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:53:37.192 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:53:37.192 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:53:37.192 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:53:37.196 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:53:37.199 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:53:37.200 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:53:37.200 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:53:37.200 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:53:37.201 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:53:37.201 | INFO     | app.main:lifespan:80 - 应用程序正在关闭... 开始执行清理任务。
2025-09-09 16:53:37.201 | INFO     | app.main:lifespan:89 - ✅ 视频流清理任务已取消。
2025-09-09 16:53:37.202 | INFO     | app.cfg.mqtt_manager:_worker_loop:115 - MQTT工作线程已停止
2025-09-09 16:53:38.110 | INFO     | app.cfg.mqtt_manager:stop:89 - ✅ MQTT管理器已停止
2025-09-09 16:53:38.110 | INFO     | app.core.result_processor:_worker_loop:118 - 结果持久化处理器工作线程已停止
2025-09-09 16:53:38.110 | INFO     | app.core.result_processor:stop:84 - ✅ 结果持久化处理器已停止
2025-09-09 16:53:38.111 | INFO     | app.service.face_service:stop_all_streams:483 - 没有活动的视频流需要停止
2025-09-09 16:53:38.111 | INFO     | app.main:lifespan:103 - ✅ 所有视频流已停止。
2025-09-09 16:53:38.111 | INFO     | app.core.model_manager:cleanup:313 - 清理模型池资源
2025-09-09 16:53:38.111 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:38.131 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:38.132 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:38.161 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:38.161 | INFO     | app.inference.devices.cuda.engine:cleanup:198 - 清理CUDA推理引擎资源
2025-09-09 16:53:38.228 | INFO     | app.inference.devices.cuda.engine:cleanup:208 - CUDA推理引擎资源清理完成
2025-09-09 16:53:38.228 | INFO     | app.core.model_manager:cleanup:327 - 模型池已清空
2025-09-09 16:53:38.228 | INFO     | app.main:lifespan:110 - ✅ 模型资源已释放。
2025-09-09 16:53:38.228 | INFO     | app.core.degirum_cleanup:force_cleanup:155 - 执行强制Degirum资源清理
2025-09-09 16:53:38.229 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:53:38.254 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:53:38.330 | INFO     | app.core.degirum_cleanup:force_cleanup:164 - Degirum资源强制清理完成
2025-09-09 16:53:38.331 | INFO     | app.main:lifespan:117 - ✅ Degirum资源已清理。
2025-09-09 16:53:38.331 | INFO     | app.main:lifespan:121 - ✅ 所有清理任务完成。
2025-09-09 16:53:38.332 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:53:38.333 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:53:38.353 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:54:26.233 | INFO     | __main__:init_app_state:25 - 应用配置加载完成
2025-09-09 16:54:26.234 | INFO     | __main__:start_server:83 - 启动服务器: FastAPI人脸识别服务 v0.1.0
2025-09-09 16:54:26.234 | INFO     | __main__:start_server:84 - 监听地址: http://0.0.0.0:12010
2025-09-09 16:54:26.235 | INFO     | __main__:start_server:88 - 本机访问: http://127.0.0.1:12010
2025-09-09 16:54:26.235 | INFO     | __main__:start_server:89 - 局域网访问: http://172.16.4.155:12010
2025-09-09 16:54:26.235 | INFO     | __main__:start_server:91 - 热重载: 关闭
2025-09-09 16:54:27.886 | INFO     | app.core.model_manager:_setup_environment:94 - 设置INSIGHTFACE_HOME: D:\ABT\0-Project\face_rec\data\.insightface
2025-09-09 16:54:28.597 | INFO     | app.core.degirum_cleanup:__init__:33 - Degirum资源清理管理器已初始化
2025-09-09 16:54:28.613 | INFO     | app.main:lifespan:37 - 应用程序启动... 开始执行启动任务。
2025-09-09 16:54:28.613 | INFO     | app.core.degirum_cleanup:register_cleanup:48 - Degirum资源清理函数已注册
2025-09-09 16:54:28.613 | INFO     | app.main:lifespan:41 - Degirum资源清理已注册。
2025-09-09 16:54:28.613 | INFO     | app.main:lifespan:43 - 应用启动，开始初始化数据库...
2025-09-09 16:54:28.615 | INFO     | app.main:lifespan:45 - 数据库初始化完成。
2025-09-09 16:54:28.616 | INFO     | app.core.model_manager:_load_new_inference_models:113 - 开始加载3个推理引擎实例到池中
2025-09-09 16:54:28.616 | INFO     | app.core.model_manager:_load_new_inference_models:114 - 使用设备类型: cuda
2025-09-09 16:54:28.619 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:54:28.619 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:54:28.620 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:54:28.620 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:54:28.620 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:54:31.474 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:54:31.475 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:54:31.475 | INFO     | app.core.model_manager:_load_new_inference_models:119 - 第一个推理引擎加载成功，继续加载剩余引擎
2025-09-09 16:54:31.475 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:54:31.476 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:54:31.476 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:54:31.477 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:54:31.477 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:54:32.313 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:54:32.313 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:54:32.314 | INFO     | app.inference.factory:create_engine:60 - 创建 cuda 推理引擎
2025-09-09 16:54:32.314 | INFO     | app.inference.factory:create_engine_with_fallback:136 - 成功创建 cuda 推理引擎
2025-09-09 16:54:32.314 | INFO     | app.inference.devices.cuda.engine:initialize:64 - 初始化CUDA推理引擎: buffalo_l
2025-09-09 16:54:32.315 | INFO     | app.inference.devices.cuda.engine:initialize:74 - CUDA推理引擎初始化成功
2025-09-09 16:54:32.315 | INFO     | app.inference.devices.cuda.engine:load_models:92 - 加载InsightFace模型: buffalo_l
2025-09-09 16:54:33.103 | INFO     | app.inference.devices.cuda.engine:load_models:112 - InsightFace模型加载成功
2025-09-09 16:54:33.104 | INFO     | app.core.model_manager:_create_inference_engine:199 - 推理引擎创建成功: cuda
2025-09-09 16:54:33.104 | INFO     | app.core.model_manager:_load_new_inference_models:134 - 成功加载3个推理引擎到池中
2025-09-09 16:54:33.105 | INFO     | app.core.model_manager:_startup_test:214 - 开始启动自检
2025-09-09 16:54:35.041 | INFO     | app.core.model_manager:_startup_test_new_inference:242 - 自检成功：检测到1张人脸
2025-09-09 16:54:35.042 | INFO     | app.main:lifespan:49 - ✅ 模型池加载完成。
2025-09-09 16:54:35.172 | INFO     | app.cfg.mqtt_manager:_worker_loop:93 - MQTT工作线程已启动
2025-09-09 16:54:35.173 | INFO     | app.cfg.mqtt_manager:start:63 - ✅ MQTT管理器已启动
2025-09-09 16:54:35.173 | INFO     | app.main:lifespan:55 - ✅ MQTT管理器已启动。
2025-09-09 16:54:35.174 | INFO     | app.core.result_processor:__init__:51 - 结果持久化处理器初始化完成，保存间隔：0.6秒，帧间隔：每10帧
2025-09-09 16:54:35.176 | INFO     | app.core.result_processor:_worker_loop:88 - 结果持久化处理器工作线程已启动
2025-09-09 16:54:35.176 | INFO     | app.core.result_processor:start:66 - ✅ 结果持久化处理器已启动
2025-09-09 16:54:35.177 | INFO     | app.main:lifespan:62 - ✅ 结果持久化服务已启动。
2025-09-09 16:54:35.177 | INFO     | app.service.face_service:__init__:32 - 正在初始化 FaceService (多线程 + 模型池)...
2025-09-09 16:54:35.186 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:54:35.197 | INFO     | app.service.face_service:initialize:48 - FaceService 正在初始化...
2025-09-09 16:54:35.198 | INFO     | app.service.face_service:initialize:49 - ✅ FaceService 初始化完毕。
2025-09-09 16:54:35.198 | INFO     | app.main:lifespan:70 - ✅ FaceService 初始化完成。
2025-09-09 16:54:35.199 | INFO     | app.main:lifespan:75 - ✅ 启动了周期性清理过期视频流的后台任务。
2025-09-09 16:54:35.199 | INFO     | app.main:lifespan:77 - 🎉 所有启动任务完成，应用程序准备就绪。
2025-09-09 16:54:51.713 | INFO     | app.service.face_service:start_stream:310 - 🚀 视频流线程已启动: ID=b1d42e6e-a01b-4e57-87f3-f9e74ecd7277, TaskID=1234567890, Source=http://demo-videos.qnsdk.com/only-video-1080p-60fps.m4s
2025-09-09 16:54:51.717 | INFO     | app.core.pipeline:__init__:186 - 【流水线 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】正在初始化...
2025-09-09 16:54:51.722 | INFO     | app.service.face_dao:_initialize_table:62 - 成功连接到已存在的 LanceDB 表: 'faces_v2'
2025-09-09 16:54:51.728 | INFO     | app.core.pipeline:start:202 - 【流水线 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】正在启动...
2025-09-09 16:54:51.972 | INFO     | app.core.pipeline:_reader_thread:269 - 【T1:读帧 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】启动。
2025-09-09 16:54:51.975 | INFO     | app.core.pipeline:_inference_thread:331 - 【T2:推理 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】启动。
2025-09-09 16:54:51.977 | INFO     | app.core.pipeline:_postprocessor_thread:429 - 【T3:后处理 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】启动。
2025-09-09 16:54:54.196 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:54:57.291 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:54:59.294 | WARNING  | app.service.face_service:get_stream_feed_by_task_id:424 - 请求不存在的视频流: TaskID=1
2025-09-09 16:54:59.296 | WARNING  | app.main:generic_exception_handler:145 - 流媒体请求异常: http://172.16.4.155:12010/api/face/streams/feed/1 - Caught handled exception, but response already started.
2025-09-09 16:55:00.371 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:55:03.427 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:55:06.532 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 8 条检测结果
2025-09-09 16:55:09.577 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:55:12.669 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 6 条检测结果
2025-09-09 16:55:15.944 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 4 条检测结果
2025-09-09 16:55:19.052 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:55:22.095 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:55:25.765 | INFO     | app.core.result_processor:_save_batch_buffer:253 - 成功批量保存 1 条检测结果
2025-09-09 16:55:26.372 | INFO     | app.core.pipeline:stop:213 - 【流水线 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】正在停止...
2025-09-09 16:55:26.387 | INFO     | app.core.pipeline:_reader_thread:326 - 【T1:读帧 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】已停止。
2025-09-09 16:55:26.396 | INFO     | app.core.pipeline:_inference_thread:423 - 【T2:推理 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】已停止。
2025-09-09 16:55:26.423 | INFO     | app.core.pipeline:_postprocessor_thread:524 - 【T3:后处理 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】已停止。
2025-09-09 16:55:26.441 | INFO     | app.service.face_dao:dispose:159 - LanceDB DAO 无需显式资源释放。
2025-09-09 16:55:26.442 | INFO     | app.core.pipeline:stop:245 - ✅【流水线 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】已安全停止。
2025-09-09 16:55:26.442 | INFO     | app.service.face_service:_pipeline_worker_thread:280 - ✅【线程 b1d42e6e-a01b-4e57-87f3-f9e74ecd7277】处理工作已结束。
2025-09-09 16:55:26.443 | INFO     | app.service.face_service:stop_stream_by_task_id:367 - ✅ 视频流已成功停止: TaskID=1234567890, StreamID=b1d42e6e-a01b-4e57-87f3-f9e74ecd7277
2025-09-09 16:55:26.446 | INFO     | app.service.face_service:get_stream_feed_by_task_id:447 - 视频流 TaskID=1234567890 已结束
2025-09-09 16:55:26.447 | INFO     | app.service.face_service:get_stream_feed_by_task_id:447 - 视频流 TaskID=1234567890 已结束
2025-09-09 16:57:03.688 | INFO     | app.core.degirum_cleanup:_signal_handler:148 - 收到信号 2，开始清理Degirum资源
2025-09-09 16:57:03.690 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:57:03.691 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:57:03.746 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
2025-09-09 16:57:03.777 | INFO     | app.core.degirum_cleanup:_cleanup_on_exit:141 - 程序退出，开始清理Degirum资源
2025-09-09 16:57:03.778 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:107 - 开始清理Degirum工作进程
2025-09-09 16:57:03.808 | INFO     | app.core.degirum_cleanup:cleanup_all_degirum_workers:116 - 未发现需要清理的Degirum工作进程
